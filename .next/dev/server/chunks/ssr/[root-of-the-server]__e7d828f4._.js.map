{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/lib/supabase.ts"],"sourcesContent":["// Supabase Configuration\n// Replace Firebase with Supabase\n\nimport { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || '';\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || '';\n\nif (!supabaseUrl || !supabaseAnonKey) {\n    console.warn('Supabase credentials not found. Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in .env.local');\n}\n\n// Prevent crash if credentials are missing\nconst createMockClient = () => {\n    const mockBuilder = {\n        select: () => mockBuilder,\n        insert: () => mockBuilder,\n        update: () => mockBuilder,\n        delete: () => mockBuilder,\n        eq: () => mockBuilder,\n        in: () => mockBuilder,\n        order: () => mockBuilder,\n        limit: () => mockBuilder,\n        single: () => Promise.resolve({ data: null, error: null }),\n        maybeSingle: () => Promise.resolve({ data: null, error: null }),\n        then: (resolve: any) => resolve({ data: [], error: null, count: 0 }),\n    };\n\n    return {\n        from: () => mockBuilder,\n        auth: {\n            signUp: () => Promise.resolve({ data: {}, error: null }),\n            signInWithPassword: () => Promise.resolve({ data: {}, error: null }),\n            signOut: () => Promise.resolve({ error: null }),\n            getUser: () => Promise.resolve({ data: { user: null }, error: null }),\n            onAuthStateChange: () => ({ data: { subscription: { unsubscribe: () => { } } } }),\n            resetPasswordForEmail: () => Promise.resolve({ data: {}, error: null }),\n        }\n    } as any;\n};\n\nexport const supabase = (supabaseUrl && supabaseAnonKey)\n    ? createClient(supabaseUrl, supabaseAnonKey)\n    : createMockClient();\n\nexport default supabase;\n"],"names":[],"mappings":"AAAA,yBAAyB;AACzB,iCAAiC;;;;;;;AAEjC;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,kBAAkB,wPAA6C;AAErE;;AAIA,2CAA2C;AAC3C,MAAM,mBAAmB;IACrB,MAAM,cAAc;QAChB,QAAQ,IAAM;QACd,QAAQ,IAAM;QACd,QAAQ,IAAM;QACd,QAAQ,IAAM;QACd,IAAI,IAAM;QACV,IAAI,IAAM;QACV,OAAO,IAAM;QACb,OAAO,IAAM;QACb,QAAQ,IAAM,QAAQ,OAAO,CAAC;gBAAE,MAAM;gBAAM,OAAO;YAAK;QACxD,aAAa,IAAM,QAAQ,OAAO,CAAC;gBAAE,MAAM;gBAAM,OAAO;YAAK;QAC7D,MAAM,CAAC,UAAiB,QAAQ;gBAAE,MAAM,EAAE;gBAAE,OAAO;gBAAM,OAAO;YAAE;IACtE;IAEA,OAAO;QACH,MAAM,IAAM;QACZ,MAAM;YACF,QAAQ,IAAM,QAAQ,OAAO,CAAC;oBAAE,MAAM,CAAC;oBAAG,OAAO;gBAAK;YACtD,oBAAoB,IAAM,QAAQ,OAAO,CAAC;oBAAE,MAAM,CAAC;oBAAG,OAAO;gBAAK;YAClE,SAAS,IAAM,QAAQ,OAAO,CAAC;oBAAE,OAAO;gBAAK;YAC7C,SAAS,IAAM,QAAQ,OAAO,CAAC;oBAAE,MAAM;wBAAE,MAAM;oBAAK;oBAAG,OAAO;gBAAK;YACnE,mBAAmB,IAAM,CAAC;oBAAE,MAAM;wBAAE,cAAc;4BAAE,aAAa,KAAQ;wBAAE;oBAAE;gBAAE,CAAC;YAChF,uBAAuB,IAAM,QAAQ,OAAO,CAAC;oBAAE,MAAM,CAAC;oBAAG,OAAO;gBAAK;QACzE;IACJ;AACJ;AAEO,MAAM,WAAW,uCAClB,IAAA,wNAAY,EAAC,aAAa,mBAC1B;uCAES"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/lib/auth.ts"],"sourcesContent":["import { supabase } from './supabase';\nimport { User, UserRole } from '@/types';\n\n/**\n * Sign up a new user with email and password\n */\nexport async function signUp(\n    email: string,\n    password: string,\n    name: string,\n    mobile: string,\n    role: UserRole,\n    company_name?: string\n): Promise<User> {\n    try {\n        // Create auth user with Supabase\n        const { data: authData, error: authError } = await supabase.auth.signUp({\n            email,\n            password,\n        });\n\n        if (authError) throw authError;\n        if (!authData.user) throw new Error('No user returned from signup');\n\n        // Generate unique customer ID (1SV- + 6 random alphanumeric characters)\n        const customerId = '1SV-' + Math.random().toString(36).substring(2, 8).toUpperCase();\n\n        // Create user profile object\n        const newUser: Omit<User, 'created_at' | 'updated_at'> = {\n            id: authData.user.id,\n            email,\n            mobile,\n            name,\n            company_name: (role === 'corporate_employee' || role === 'corporate_admin') ? company_name : undefined,\n            role,\n            customer_id: customerId,\n        };\n\n        // Retry logic for creating user profile to handle race conditions\n        let retries = 3;\n        while (retries > 0) {\n            try {\n                // Wait for auth user to be propagated\n                await new Promise(resolve => setTimeout(resolve, 1000));\n\n                const { error: dbError } = await supabase\n                    .from('users')\n                    .insert({\n                        id: authData.user.id,\n                        email: newUser.email,\n                        mobile: newUser.mobile,\n                        name: newUser.name,\n                        company_name: newUser.company_name,\n                        role: newUser.role,\n                        customer_id: newUser.customer_id,\n                    });\n\n                if (dbError) {\n                    // If foreign key violation, throw to catch block to retry\n                    if (dbError.code === '23503') throw dbError;\n\n                    // If unique violation (409), check if profile already exists\n                    if (dbError.code === '23505') { // Postgres unique violation code\n                        console.log('User profile already exists, checking for orphan...');\n\n                        // Check if a profile exists with this email but different ID (orphaned)\n                        const { data: existingProfile, error: fetchError } = await supabase\n                            .from('users')\n                            .select('*')\n                            .eq('email', email)\n                            .maybeSingle();\n\n                        if (!fetchError && existingProfile) {\n                            // If ID matches, it's a duplicate signup attempt, just return it\n                            if (existingProfile.id === authData.user.id) {\n                                return {\n                                    ...existingProfile,\n                                    created_at: new Date(existingProfile.created_at),\n                                    updated_at: new Date(existingProfile.updated_at),\n                                };\n                            }\n\n                            // If ID doesn't match, it's an orphaned profile. Update it with new Auth ID.\n                            console.log('Found orphaned profile. Linking to new Auth ID...');\n                            const { error: updateError } = await supabase\n                                .from('users')\n                                .update({\n                                    id: authData.user.id,\n                                    updated_at: new Date().toISOString()\n                                })\n                                .eq('email', email);\n\n                            if (updateError) {\n                                console.error('Failed to link orphaned profile:', updateError);\n                                throw updateError;\n                            }\n\n                            // Return the updated profile\n                            return {\n                                ...existingProfile,\n                                id: authData.user.id, // Use new ID\n                                created_at: new Date(existingProfile.created_at),\n                                updated_at: new Date(),\n                            };\n                        }\n                    }\n\n                    // Other errors, throw immediately\n                    throw dbError;\n                }\n\n                // Success\n                break;\n            } catch (error: any) {\n                retries--;\n                if (retries === 0) {\n                    console.error('Failed to create user profile after retries:', error);\n                    throw new Error('Failed to create user profile. Please try again.');\n                }\n                console.log(`Retrying user profile creation... (${retries} attempts left)`);\n            }\n        }\n\n        return {\n            ...newUser,\n            created_at: new Date(),\n            updated_at: new Date(),\n        };\n    } catch (error: any) {\n        console.error('Signup error:', error);\n        throw new Error(error.message || 'Failed to sign up');\n    }\n}\n\n/**\n * Send password reset email\n */\nexport async function resetPassword(email: string): Promise<void> {\n    try {\n        const { error } = await supabase.auth.resetPasswordForEmail(email, {\n            redirectTo: typeof window !== 'undefined' ? `${window.location.origin}/update-password` : 'http://localhost:3000/update-password',\n        });\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Reset password error:', error);\n        throw new Error(error.message || 'Failed to send reset password email');\n    }\n}\n\n/**\n * Sign in existing user with email and password\n */\nexport async function signIn(email: string, password: string): Promise<User> {\n    try {\n        const { data: authData, error: authError } = await supabase.auth.signInWithPassword({\n            email,\n            password,\n        });\n\n        if (authError) throw authError;\n        if (!authData.user) throw new Error('No user returned from sign in');\n\n        // Fetch user data from database\n        const { data: userData, error: dbError } = await supabase\n            .from('users')\n            .select('*')\n            .eq('id', authData.user.id)\n            .maybeSingle();\n\n        if (dbError) throw dbError;\n        if (!userData) throw new Error('User profile not found. Please contact support.');\n\n        return {\n            id: userData.id,\n            email: userData.email,\n            mobile: userData.mobile,\n            name: userData.name,\n            company_name: userData.company_name,\n            role: userData.role,\n            created_at: new Date(userData.created_at),\n            updated_at: new Date(userData.updated_at),\n            rm_id: userData.rm_id,\n            customer_id: userData.customer_id,\n        };\n    } catch (error: any) {\n        console.error('Sign in error:', error);\n        throw new Error(error.message || 'Failed to sign in');\n    }\n}\n\n/**\n * Sign out current user\n */\nexport async function signOut(): Promise<void> {\n    try {\n        const { error } = await supabase.auth.signOut();\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Sign out error:', error);\n        throw new Error(error.message || 'Failed to sign out');\n    }\n}\n\n/**\n * Get current authenticated user's data from database\n */\nexport async function getCurrentUser(): Promise<User | null> {\n    try {\n        const { data: { user: authUser } } = await supabase.auth.getUser();\n\n        if (!authUser) return null;\n\n        const { data: userData, error } = await supabase\n            .from('users')\n            .select('*')\n            .eq('id', authUser.id)\n            .maybeSingle();\n\n        if (error) {\n            console.error('Error fetching user data:', error);\n            return null;\n        }\n\n        if (!userData) {\n            console.warn('User authenticated but no profile found');\n            return null;\n        }\n\n        return {\n            id: userData.id,\n            email: userData.email,\n            mobile: userData.mobile,\n            name: userData.name,\n            company_name: userData.company_name,\n            role: userData.role,\n            created_at: new Date(userData.created_at),\n            updated_at: new Date(userData.updated_at),\n            rm_id: userData.rm_id,\n            customer_id: userData.customer_id,\n        };\n    } catch (error) {\n        console.error('Error getting current user:', error);\n        return null;\n    }\n}\n\n/**\n * Get Supabase auth state change listener\n */\nexport function onAuthStateChange(callback: (user: User | null) => void) {\n    return supabase.auth.onAuthStateChange(async (event: string, session: any) => {\n        if (session?.user) {\n            const user = await getCurrentUser();\n            callback(user);\n        } else {\n            callback(null);\n        }\n    });\n}\n\n/**\n * Check if user has specific role\n */\nexport function hasRole(user: User | null, roles: UserRole[]): boolean {\n    return user ? roles.includes(user.role) : false;\n}\n\n/**\n * Check if user is admin\n */\nexport function isAdmin(user: User | null): boolean {\n    return hasRole(user, ['admin']);\n}\n\n/**\n * Check if user is customer (individual or corporate)\n */\nexport function isCustomer(user: User | null): boolean {\n    return hasRole(user, ['individual', 'corporate_employee', 'corporate_admin']);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 332, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/lib/utils.ts"],"sourcesContent":["import { PolicyStatus } from '@/types';\n\n/**\n * Calculate policy status based on end/expiry date\n * @param endDate - Policy end/expiry date\n * @param thresholdDays - Number of days before expiry to mark as \"Expiring Soon\" (default: 15)\n * @returns PolicyStatus - 'Active', 'Expiring Soon', or 'Expired'\n */\nexport function calculatePolicyStatus(\n    endDate: Date | string | null | undefined,\n    thresholdDays: number = 15\n): PolicyStatus {\n    // Handle null, undefined, or invalid dates\n    if (!endDate) return 'Expired';\n\n    const date = typeof endDate === 'string' ? new Date(endDate) : endDate;\n\n    // Check if date is valid\n    if (isNaN(date.getTime())) return 'Expired';\n\n    const today = new Date();\n    const diffTime = date.getTime() - today.getTime();\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n    if (diffDays < 0) return 'Expired';\n    if (diffDays <= thresholdDays) return 'Expiring Soon';\n    return 'Active';\n}\n\n/**\n * Get Financial Year for a given date (April-March)\n * @param date - Date to get FY for\n * @returns string - FY in format \"FY 2024-25\"\n */\nexport function getFY(date: Date): string {\n    const month = date.getMonth(); // 0-indexed (0 = January)\n    const year = date.getFullYear();\n\n    if (month >= 3) {\n        // April (3) onwards\n        return `FY ${year}-${(year + 1).toString().slice(-2)}`;\n    } else {\n        return `FY ${year - 1}-${year.toString().slice(-2)}`;\n    }\n}\n\n/**\n * Check if a date falls within a specific FY\n * @param date - Date to check\n * @param fy - FY string (e.g., \"FY 2024-25\")\n * @returns boolean\n */\nexport function isDateInFY(date: Date, fy: string): boolean {\n    return getFY(date) === fy;\n}\n\n/**\n * Get start and end dates for a Financial Year\n * @param fy - FY string (e.g., \"FY 2024-25\")\n * @returns { start: Date, end: Date }\n */\nexport function getFYDates(fy: string): { start: Date; end: Date } {\n    const years = fy.match(/\\d{4}-\\d{2}/)?.[0].split('-');\n    if (!years || years.length !== 2) {\n        throw new Error('Invalid FY format');\n    }\n\n    const startYear = parseInt(years[0]);\n    const endYear = parseInt('20' + years[1]);\n\n    return {\n        start: new Date(startYear, 3, 1), // April 1st\n        end: new Date(endYear, 2, 31, 23, 59, 59), // March 31st\n    };\n}\n\n/**\n * Get current Financial Year\n * @returns string - Current FY in format \"FY 2024-25\"\n */\nexport function getCurrentFY(): string {\n    return getFY(new Date());\n}\n\n/**\n * Format currency amount\n * @param amount - Amount in number\n * @param currency - Currency symbol (default: '₹')\n * @returns string - Formatted currency\n */\nexport function formatCurrency(amount: number, currency: string = '₹'): string {\n    return `${currency}${amount.toLocaleString('en-IN', {\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0,\n    })}`;\n}\n\n/**\n * Format date to readable string\n * @param date - Date to format\n * @returns string - Formatted date (e.g., \"23 Nov 2024\")\n */\nexport function formatDate(date: Date): string {\n    return date.toLocaleDateString('en-IN', {\n        day: '2-digit',\n        month: 'short',\n        year: 'numeric',\n    });\n}\n\n/**\n * Calculate days until a date\n * @param endDate - Target date\n * @returns number - Days remaining (negative if past), or 0 if invalid date\n */\nexport function daysUntil(endDate: Date | string | null | undefined): number {\n    if (!endDate) return 0;\n\n    const date = typeof endDate === 'string' ? new Date(endDate) : endDate;\n    if (isNaN(date.getTime())) return 0;\n\n    const today = new Date();\n    const diffTime = date.getTime() - today.getTime();\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n}\n\n/**\n * Class names utility for conditional styling\n */\nexport function cn(...classes: (string | boolean | undefined | null)[]): string {\n    return classes.filter(Boolean).join(' ');\n}\n\n/**\n * Truncate text to specified length\n */\nexport function truncate(text: string, length: number): string {\n    if (text.length <= length) return text;\n    return text.slice(0, length) + '...';\n}\n\n/**\n * Safely format a date for HTML date input (YYYY-MM-DD)\n * @param date - Date value (Date object, string, or null/undefined)\n * @returns string - Formatted date string or empty string if invalid\n */\nexport function formatDateForInput(date: Date | string | null | undefined): string {\n    if (!date) return '';\n\n    try {\n        const dateObj = typeof date === 'string' ? new Date(date) : date;\n        if (isNaN(dateObj.getTime())) return '';\n\n        return dateObj.toISOString().split('T')[0];\n    } catch {\n        return '';\n    }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAQO,SAAS,sBACZ,OAAyC,EACzC,gBAAwB,EAAE;IAE1B,2CAA2C;IAC3C,IAAI,CAAC,SAAS,OAAO;IAErB,MAAM,OAAO,OAAO,YAAY,WAAW,IAAI,KAAK,WAAW;IAE/D,yBAAyB;IACzB,IAAI,MAAM,KAAK,OAAO,KAAK,OAAO;IAElC,MAAM,QAAQ,IAAI;IAClB,MAAM,WAAW,KAAK,OAAO,KAAK,MAAM,OAAO;IAC/C,MAAM,WAAW,KAAK,IAAI,CAAC,WAAW,CAAC,OAAO,KAAK,KAAK,EAAE;IAE1D,IAAI,WAAW,GAAG,OAAO;IACzB,IAAI,YAAY,eAAe,OAAO;IACtC,OAAO;AACX;AAOO,SAAS,MAAM,IAAU;IAC5B,MAAM,QAAQ,KAAK,QAAQ,IAAI,0BAA0B;IACzD,MAAM,OAAO,KAAK,WAAW;IAE7B,IAAI,SAAS,GAAG;QACZ,oBAAoB;QACpB,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC,EAAE,CAAC,OAAO,CAAC,EAAE,QAAQ,GAAG,KAAK,CAAC,CAAC,IAAI;IAC1D,OAAO;QACH,OAAO,CAAC,GAAG,EAAE,OAAO,EAAE,CAAC,EAAE,KAAK,QAAQ,GAAG,KAAK,CAAC,CAAC,IAAI;IACxD;AACJ;AAQO,SAAS,WAAW,IAAU,EAAE,EAAU;IAC7C,OAAO,MAAM,UAAU;AAC3B;AAOO,SAAS,WAAW,EAAU;IACjC,MAAM,QAAQ,GAAG,KAAK,CAAC,gBAAgB,CAAC,EAAE,CAAC,MAAM;IACjD,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG;QAC9B,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,YAAY,SAAS,KAAK,CAAC,EAAE;IACnC,MAAM,UAAU,SAAS,OAAO,KAAK,CAAC,EAAE;IAExC,OAAO;QACH,OAAO,IAAI,KAAK,WAAW,GAAG;QAC9B,KAAK,IAAI,KAAK,SAAS,GAAG,IAAI,IAAI,IAAI;IAC1C;AACJ;AAMO,SAAS;IACZ,OAAO,MAAM,IAAI;AACrB;AAQO,SAAS,eAAe,MAAc,EAAE,WAAmB,GAAG;IACjE,OAAO,GAAG,WAAW,OAAO,cAAc,CAAC,SAAS;QAChD,uBAAuB;QACvB,uBAAuB;IAC3B,IAAI;AACR;AAOO,SAAS,WAAW,IAAU;IACjC,OAAO,KAAK,kBAAkB,CAAC,SAAS;QACpC,KAAK;QACL,OAAO;QACP,MAAM;IACV;AACJ;AAOO,SAAS,UAAU,OAAyC;IAC/D,IAAI,CAAC,SAAS,OAAO;IAErB,MAAM,OAAO,OAAO,YAAY,WAAW,IAAI,KAAK,WAAW;IAC/D,IAAI,MAAM,KAAK,OAAO,KAAK,OAAO;IAElC,MAAM,QAAQ,IAAI;IAClB,MAAM,WAAW,KAAK,OAAO,KAAK,MAAM,OAAO;IAC/C,OAAO,KAAK,IAAI,CAAC,WAAW,CAAC,OAAO,KAAK,KAAK,EAAE;AACpD;AAKO,SAAS,GAAG,GAAG,OAAgD;IAClE,OAAO,QAAQ,MAAM,CAAC,SAAS,IAAI,CAAC;AACxC;AAKO,SAAS,SAAS,IAAY,EAAE,MAAc;IACjD,IAAI,KAAK,MAAM,IAAI,QAAQ,OAAO;IAClC,OAAO,KAAK,KAAK,CAAC,GAAG,UAAU;AACnC;AAOO,SAAS,mBAAmB,IAAsC;IACrE,IAAI,CAAC,MAAM,OAAO;IAElB,IAAI;QACA,MAAM,UAAU,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;QAC5D,IAAI,MAAM,QAAQ,OAAO,KAAK,OAAO;QAErC,OAAO,QAAQ,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IAC9C,EAAE,OAAM;QACJ,OAAO;IACX;AACJ"}},
    {"offset": {"line": 439, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/layout/InsuranceTipsCarousel.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { ChevronLeft, ChevronRight, Lightbulb, Shield, Heart, Car, Plane, Building2, Users } from 'lucide-react';\n\nconst insuranceTips = [\n    {\n        icon: Car,\n        color: 'from-blue-500 to-blue-600',\n        bgColor: 'bg-blue-50',\n        iconColor: 'text-blue-600',\n        title: 'Motor Insurance Tip',\n        tip: 'Always compare NCB (No Claim Bonus) before renewal. You can save up to 50% on premiums!'\n    },\n    {\n        icon: Heart,\n        color: 'from-green-500 to-green-600',\n        bgColor: 'bg-green-50',\n        iconColor: 'text-green-600',\n        title: 'Health Insurance Tip',\n        tip: 'Opt for family floater plans for better coverage at lower premiums. Sum insured of ₹10L+ recommended.'\n    },\n    {\n        icon: Shield,\n        color: 'from-purple-500 to-purple-600',\n        bgColor: 'bg-purple-50',\n        iconColor: 'text-purple-600',\n        title: 'Coverage Advisory',\n        tip: 'Read policy exclusions carefully! Pre-existing diseases often have 2-4 year waiting periods.'\n    },\n    {\n        icon: Plane,\n        color: 'from-orange-500 to-orange-600',\n        bgColor: 'bg-orange-50',\n        iconColor: 'text-orange-600',\n        title: 'Travel Insurance Tip',\n        tip: 'Buy travel insurance at least 7 days before departure for maximum coverage including trip cancellation.'\n    },\n    {\n        icon: Users,\n        color: 'from-pink-500 to-pink-600',\n        bgColor: 'bg-pink-50',\n        iconColor: 'text-pink-600',\n        title: 'Life Insurance Tip',\n        tip: 'Term insurance gives maximum coverage at lowest cost. Buy early for better premiums!'\n    },\n    {\n        icon: Building2,\n        color: 'from-indigo-500 to-indigo-600',\n        bgColor: 'bg-indigo-50',\n        iconColor: 'text-indigo-600',\n        title: 'Claim Smart',\n        tip: 'Inform insurer within 24 hours of incident. Keep all bills & reports for smooth claim settlement.'\n    },\n    {\n        icon: Lightbulb,\n        color: 'from-yellow-500 to-yellow-600',\n        bgColor: 'bg-yellow-50',\n        iconColor: 'text-yellow-600',\n        title: 'Document Smart',\n        tip: 'Keep digital copies of all policies in cloud storage. Quick access during emergencies saves time!'\n    },\n    {\n        icon: Shield,\n        color: 'from-teal-500 to-teal-600',\n        bgColor: 'bg-teal-50',\n        iconColor: 'text-teal-600',\n        title: 'Renewal Reminder',\n        tip: 'Set policy renewal alerts 30 days early. Avoid late fees & coverage gaps with timely renewals.'\n    },\n    {\n        icon: Heart,\n        color: 'from-red-500 to-red-600',\n        bgColor: 'bg-red-50',\n        iconColor: 'text-red-600',\n        title: 'Add-on Benefits',\n        tip: 'Zero depreciation, roadside assistance & consumables cover are valuable add-ons for motors.'\n    },\n    {\n        icon: Lightbulb,\n        color: 'from-cyan-500 to-cyan-600',\n        bgColor: 'bg-cyan-50',\n        iconColor: 'text-cyan-600',\n        title: 'Pro Tip',\n        tip: 'Compare quotes from 3+ insurers before buying. Your RM can help you find the best deal!'\n    }\n];\n\nexport default function InsuranceTipsCarousel() {\n    const [currentIndex, setCurrentIndex] = useState(0);\n\n    const nextTip = () => {\n        setCurrentIndex((prev) => (prev + 1) % insuranceTips.length);\n    };\n\n    const prevTip = () => {\n        setCurrentIndex((prev) => (prev - 1 + insuranceTips.length) % insuranceTips.length);\n    };\n\n    const currentTip = insuranceTips[currentIndex];\n    const Icon = currentTip.icon;\n\n    return (\n        <div className=\"px-4 py-3 pb-6\">\n            <div className={`relative ${currentTip.bgColor} rounded-xl p-5 border border-gray-100 overflow-hidden group min-h-[180px] flex flex-col`}>\n                {/* Background gradient */}\n                <div className={`absolute top-0 right-0 w-32 h-32 bg-gradient-to-br ${currentTip.color} opacity-10 rounded-full -mr-10 -mt-10`} />\n\n                {/* Content */}\n                <div className=\"relative flex-1 flex flex-col\">\n                    {/* Icon and Progress */}\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <div className={`p-2.5 bg-white rounded-lg shadow-sm`}>\n                            <Icon className={`w-6 h-6 ${currentTip.iconColor}`} />\n                        </div>\n                        <div className=\"flex items-center gap-1.5\">\n                            {insuranceTips.map((_, idx) => (\n                                <div\n                                    key={idx}\n                                    className={`h-1.5 rounded-full transition-all ${idx === currentIndex ? 'w-5 bg-gray-400' : 'w-1.5 bg-gray-300'\n                                        }`}\n                                />\n                            ))}\n                        </div>\n                    </div>\n\n                    {/* Title */}\n                    <h4 className={`text-sm font-bold ${currentTip.iconColor} mb-3`}>\n                        {currentTip.title}\n                    </h4>\n\n                    {/* Tip Text */}\n                    <p className=\"text-sm text-gray-700 leading-relaxed mb-4 flex-1\">\n                        {currentTip.tip}\n                    </p>\n\n                    {/* Navigation */}\n                    <div className=\"flex justify-between items-center mt-auto\">\n                        <button\n                            onClick={prevTip}\n                            className=\"p-1.5 hover:bg-white rounded-full transition-colors\"\n                            aria-label=\"Previous tip\"\n                        >\n                            <ChevronLeft className=\"w-5 h-5 text-gray-600\" />\n                        </button>\n                        <span className=\"text-xs text-gray-500 font-medium\">\n                            {currentIndex + 1} / {insuranceTips.length}\n                        </span>\n                        <button\n                            onClick={nextTip}\n                            className=\"p-1.5 hover:bg-white rounded-full transition-colors\"\n                            aria-label=\"Next tip\"\n                        >\n                            <ChevronRight className=\"w-5 h-5 text-gray-600\" />\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 693, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/layout/Sidebar.tsx"],"sourcesContent":["'use client';\n\nimport Link from 'next/link';\nimport { usePathname, useRouter } from 'next/navigation';\nimport { useState, useEffect } from 'react';\nimport {\n    LayoutDashboard,\n    FileText,\n    History,\n    FolderOpen,\n    Users,\n    AlertCircle,\n    Shield,\n    LogOut,\n    ChevronDown,\n    ChevronRight,\n    PieChart,\n    Files,\n    MessageSquare,\n    Calculator,\n    UserCircle\n} from 'lucide-react';\nimport { User } from '@/types';\nimport { cn } from '@/lib/utils';\nimport { signOut } from '@/lib/auth';\nimport InsuranceTipsCarousel from './InsuranceTipsCarousel';\n\ninterface SidebarProps {\n    user: User;\n    onClose?: () => void;\n}\n\ntype NavItem = {\n    label: string;\n    href: string;\n    icon: any;\n};\n\ntype NavGroup = {\n    label: string;\n    items: NavItem[];\n    icon?: any;\n};\n\nexport default function Sidebar({ user, onClose }: SidebarProps) {\n    const pathname = usePathname();\n    const router = useRouter();\n    const [openGroups, setOpenGroups] = useState<string[]>(['Overview', 'Policies', 'Claims', 'Documents', 'Community', 'Admin']);\n    const [isUploadingAvatar, setIsUploadingAvatar] = useState(false);\n\n    const toggleGroup = (label: string) => {\n        setOpenGroups(prev =>\n            prev.includes(label)\n                ? prev.filter(g => g !== label)\n                : [...prev, label]\n        );\n    };\n\n    const navGroups: NavGroup[] = [\n        {\n            label: 'Overview',\n            items: [\n                { href: '/dashboard', icon: LayoutDashboard, label: 'Dashboard' }\n            ]\n        },\n        {\n            label: 'Policies',\n            items: [\n                { href: '/policies', icon: FileText, label: 'All Policies' }\n            ]\n        },\n        {\n            label: 'Claims',\n            items: [\n                { href: '/claims', icon: AlertCircle, label: 'Claims' }\n            ]\n        },\n        {\n            label: 'Quick Actions',\n            items: [\n                { href: '/quotes', icon: Calculator, label: 'Get Quote' },\n                { href: '/claims', icon: Shield, label: 'File Claim' }\n            ]\n        },\n        {\n            label: 'Documents',\n            items: [\n                { href: '/documents', icon: FolderOpen, label: 'Documents' },\n                { href: '/history', icon: History, label: 'History' }\n            ]\n        }\n    ];\n\n    // Add Admin group if user is admin\n    if (user.role === 'admin') {\n        navGroups.push({\n            label: 'Admin',\n            items: [\n                { href: '/admin/dashboard', icon: Shield, label: 'Admin Dashboard' },\n                { href: '/admin/reports', icon: FileText, label: 'Reports & Exports' }\n            ]\n        });\n    }\n\n    return (\n        <aside className=\"w-72 h-full bg-white border-r border-gray-100 flex flex-col overflow-y-auto\">\n            {/* Logo */}\n            <div className=\"flex items-center flex-shrink-0 px-6 py-6 border-b border-gray-50\">\n                <div className=\"w-8 h-8 bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg flex items-center justify-center shadow-lg shadow-primary-500/30\">\n                    <Shield className=\"w-5 h-5 text-white\" />\n                </div>\n                <span className=\"ml-3 text-lg font-bold text-gray-900 tracking-tight\">\n                    PolicyPilot\n                </span>\n            </div>\n\n            {/* User Profile Section (Top) */}\n            <div className=\"px-4 py-4 border-b border-gray-100\">\n                <div className=\"flex flex-col items-center text-center space-y-3\">\n                    {/* Profile Picture */}\n                    <div className=\"relative group\">\n                        <div className=\"w-16 h-16 rounded-full bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center text-white font-bold text-xl shadow-lg overflow-hidden\">\n                            {user.avatar_url ? (\n                                <img src={user.avatar_url} alt={user.name} className=\"w-full h-full object-cover\" />\n                            ) : (\n                                user.name.charAt(0).toUpperCase()\n                            )}\n                        </div>\n\n                        {/* Loading Overlay */}\n                        {isUploadingAvatar && (\n                            <div className=\"absolute inset-0 flex items-center justify-center bg-black/60 rounded-full\">\n                                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"></div>\n                            </div>\n                        )}\n\n                        {/* Edit Overlay */}\n                        {!isUploadingAvatar && (\n                            <label\n                                htmlFor=\"avatar-upload\"\n                                className=\"absolute inset-0 flex items-center justify-center bg-black/40 rounded-full opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer\"\n                            >\n                                <div className=\"bg-white/20 p-1.5 rounded-full backdrop-blur-sm\">\n                                    <UserCircle className=\"w-5 h-5 text-white\" />\n                                </div>\n                            </label>\n                        )}\n                        <input\n                            id=\"avatar-upload\"\n                            type=\"file\"\n                            accept=\"image/*\"\n                            className=\"hidden\"\n                            disabled={isUploadingAvatar}\n                            onChange={async (e) => {\n                                const file = e.target.files?.[0];\n                                if (!file || isUploadingAvatar) return;\n\n                                setIsUploadingAvatar(true);\n                                console.log('[Avatar Upload] Starting upload for file:', file.name);\n\n                                try {\n                                    const { uploadAvatar } = await import('@/lib/db');\n                                    console.log('[Avatar Upload] Calling uploadAvatar function...');\n\n                                    const url = await uploadAvatar(user.id, file);\n                                    console.log('[Avatar Upload] Upload result:', url);\n\n                                    if (url) {\n                                        console.log('[Avatar Upload] Success! Updating UI...');\n                                        // Update user object with new avatar URL\n                                        user.avatar_url = url;\n                                        // Use router.refresh() instead of full page reload\n                                        router.refresh();\n                                        setIsUploadingAvatar(false);\n                                    } else {\n                                        console.error('[Avatar Upload] Upload returned null');\n                                        setIsUploadingAvatar(false);\n                                        alert('Failed to upload image. Please check console for details.');\n                                    }\n                                } catch (error) {\n                                    console.error('[Avatar Upload] Error:', error);\n                                    setIsUploadingAvatar(false);\n                                    alert(`Failed to upload image: ${error instanceof Error ? error.message : 'Unknown error'}`);\n                                } finally {\n                                    // Reset file input\n                                    e.target.value = '';\n                                }\n                            }}\n                        />\n                    </div>\n\n                    {/* User Name */}\n                    <div className=\"w-full\">\n                        <p className=\"text-base font-bold text-gray-900 truncate\">\n                            {user.name}\n                        </p>\n                        {/* Company Name - for corporate users */}\n                        {user.company_name && (\n                            <p className=\"text-sm text-gray-700 mt-0.5 font-medium truncate\">\n                                {user.company_name}\n                            </p>\n                        )}\n                        {/* Customer ID */}\n                        <p className=\"text-xs text-gray-500 mt-0.5 font-medium\">\n                            ID: {user.customer_id || 'N/A'}\n                        </p>\n                    </div>\n\n                    {/* Action Buttons - Side by Side */}\n                    <div className=\"flex gap-2 w-full\">\n                        <Link\n                            href=\"/profile\"\n                            className=\"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-xs font-medium text-gray-700 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors\"\n                        >\n                            <UserCircle className=\"w-3.5 h-3.5\" />\n                            Profile\n                        </Link>\n                        <button\n                            onClick={async () => {\n                                try {\n                                    await signOut();\n                                    router.push('/');\n                                    router.refresh();\n                                } catch (error) {\n                                    console.error('Error signing out:', error);\n                                }\n                            }}\n                            className=\"flex-1 flex items-center justify-center gap-1.5 px-3 py-2 text-xs font-medium text-red-600 bg-red-50 hover:bg-red-100 rounded-lg transition-colors\"\n                        >\n                            <LogOut className=\"w-3.5 h-3.5\" />\n                            Sign Out\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n            {/* Navigation */}\n            <nav className=\"flex-1 px-3 py-4 space-y-4 overflow-y-auto scrollbar-hide\">\n                {navGroups.map((group) => (\n                    <div key={group.label}>\n                        <button\n                            onClick={() => toggleGroup(group.label)}\n                            className=\"flex items-center justify-between w-full px-2 mb-1 text-[10px] font-bold text-gray-400 uppercase tracking-wider hover:text-gray-600 transition-colors\"\n                        >\n                            <span>{group.label}</span>\n                            {openGroups.includes(group.label) ? (\n                                <ChevronDown className=\"w-3 h-3\" />\n                            ) : (\n                                <ChevronRight className=\"w-3 h-3\" />\n                            )}\n                        </button>\n\n                        {openGroups.includes(group.label) && (\n                            <div className=\"space-y-0.5\">\n                                {group.items.map((item) => {\n                                    const isActive = pathname === item.href;\n                                    const Icon = item.icon;\n\n                                    return (\n                                        <Link\n                                            key={item.href}\n                                            href={item.href}\n                                            className={cn(\n                                                'flex items-center px-3 py-1.5 text-sm font-medium rounded-md transition-all duration-200 group',\n                                                isActive\n                                                    ? 'bg-primary-50 text-primary-700'\n                                                    : 'text-gray-600 hover:bg-gray-50 hover:text-gray-900'\n                                            )}\n                                        >\n                                            <Icon className={cn(\n                                                \"w-4 h-4 mr-3 transition-colors\",\n                                                isActive ? \"text-primary-600\" : \"text-gray-400 group-hover:text-gray-600\"\n                                            )} />\n                                            {item.label}\n                                        </Link>\n                                    );\n                                })}\n                            </div>\n                        )}\n                    </div>\n                ))}\n            </nav>\n\n            {/* Insurance Tips Carousel */}\n            <div className=\"mt-auto\">\n                <InsuranceTipsCarousel />\n            </div>\n        </aside>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1161, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/layout/NotificationsMenu.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Bell, Check, Info, AlertTriangle, CheckCircle, XCircle } from 'lucide-react';\nimport { getUserNotifications, markNotificationAsRead, markAllNotificationsAsRead } from '@/lib/db';\nimport { formatDistanceToNow } from 'date-fns';\n\ninterface Notification {\n    id: string;\n    title: string;\n    message: string;\n    type: 'info' | 'warning' | 'success' | 'error';\n    is_read: boolean;\n    created_at: string;\n}\n\ninterface NotificationsMenuProps {\n    userId: string;\n}\n\nexport default function NotificationsMenu({ userId }: NotificationsMenuProps) {\n    // Temporarily disabled as per user request due to errors\n    return null;\n}\n"],"names":[],"mappings":";;;;AAkBe,SAAS,kBAAkB,EAAE,MAAM,EAA0B;IACxE,yDAAyD;IACzD,OAAO;AACX"}},
    {"offset": {"line": 1173, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/lib/db.ts"],"sourcesContent":["import { supabase } from './supabase';\nimport {\n    MotorPolicy,\n    HealthPolicy,\n    CommercialPolicy,\n    Claim,\n    QuoteRequest,\n    Referral,\n    User,\n    UserAuditLog,\n    AuditLog,\n    AppSetting,\n    Banner,\n    Garage,\n    UserPreferences,\n    RMInfo,\n} from '@/types';\n\n// Helper to convert database rows to app types\nfunction convertDates(data: any): any {\n    const converted = { ...data };\n    Object.keys(converted).forEach((key) => {\n        if (converted[key] && typeof converted[key] === 'string') {\n            // Try to parse as date\n            const dateValue = new Date(converted[key]);\n            if (!isNaN(dateValue.getTime()) && key.includes('date') || key.includes('_at')) {\n                converted[key] = dateValue;\n            }\n        }\n    });\n    return converted;\n}\n\n/**\n * Check for duplicate policy number\n */\nasync function checkDuplicatePolicy(table: string, userId: string, policyNumber: string): Promise<void> {\n    const { data, error } = await supabase\n        .from(table)\n        .select('id')\n        .eq('user_id', userId)\n        .eq('policy_number', policyNumber)\n        .maybeSingle();\n\n    if (data) {\n        throw new Error('This policy number already exists in your account');\n    }\n}\n\n/**\n * Get all motor policies for a user\n */\nexport async function getUserMotorPolicies(userId: string): Promise<MotorPolicy[]> {\n    try {\n        const { data, error } = await supabase\n            .from('motor_policies')\n            .select('*')\n            .eq('user_id', userId)\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => ({\n            ...convertDates(row),\n            id: row.id,\n            user_id: row.user_id,\n        })) as MotorPolicy[];\n    } catch (error: any) {\n        console.error('Error fetching motor policies:', error.message, error.details, error.hint);\n        return [];\n    }\n}\n\n/**\n * Get all GMC policies for a user\n */\nexport async function getUserHealthPolicies(userId: string): Promise<HealthPolicy[]> {\n    try {\n        const { data, error } = await supabase\n            .from('health_policies')\n            .select('*')\n            .eq('user_id', userId)\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as HealthPolicy[];\n    } catch (error: any) {\n        console.error('Error fetching health policies:', error.message, error.details, error.hint);\n        return [];\n    }\n}\n\n/**\n * Get all commercial policies for a user\n */\nexport async function getUserCommercialPolicies(\n    userId: string,\n    lobType?: 'GPA' | 'Fire' | 'Other'\n): Promise<CommercialPolicy[]> {\n    try {\n        let query = supabase\n            .from('commercial_policies')\n            .select('*')\n            .eq('user_id', userId);\n\n        if (lobType) {\n            query = query.eq('lob_type', lobType);\n        }\n\n        const { data, error } = await query.order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as CommercialPolicy[];\n    } catch (error: any) {\n        console.error('Error fetching commercial policies:', error.message, error.details, error.hint);\n        return [];\n    }\n}\n\n/**\n * Get all claims for a user\n */\nexport async function getUserClaims(userId: string): Promise<Claim[]> {\n    try {\n        const { data, error } = await supabase\n            .from('claims')\n            .select('*')\n            .eq('user_id', userId)\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as Claim[];\n    } catch (error: any) {\n        console.error('Error fetching claims:', error.message, error.details, error.hint);\n        return [];\n    }\n}\n\n/**\n * Get all quote requests for a user\n */\nexport async function getUserQuoteRequests(userId: string): Promise<QuoteRequest[]> {\n    try {\n        const { data, error } = await supabase\n            .from('quote_requests')\n            .select('*')\n            .eq('user_id', userId)\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as QuoteRequest[];\n    } catch (error: any) {\n        console.error('Error fetching quote requests:', error);\n        return [];\n    }\n}\n\n/**\n * Add a motor policy\n */\nexport async function addMotorPolicy(policy: Omit<MotorPolicy, 'id' | 'created_at' | 'updated_at'>): Promise<string> {\n    try {\n        await checkDuplicatePolicy('motor_policies', policy.user_id, policy.policy_number);\n\n        const { data, error } = await supabase\n            .from('motor_policies')\n            .insert({\n                user_id: policy.user_id,\n                policy_number: policy.policy_number,\n                vehicle_number: policy.vehicle_number,\n                vehicle_type: policy.vehicle_type,\n                manufacturer: policy.manufacturer,\n                model: policy.model,\n                fuel_type: policy.fuel_type,\n                manufacturing_year: policy.manufacturing_year,\n                number_plate_type: policy.number_plate_type,\n                insurer_name: policy.insurer_name,\n                premium_amount: policy.premium_amount,\n                policy_start_date: policy.policy_start_date,\n                policy_end_date: policy.policy_end_date,\n                rc_docs: policy.rc_docs || [],\n                previous_policy_docs: policy.previous_policy_docs || [],\n                dl_docs: policy.dl_docs || [],\n            })\n            .select()\n            .single();\n\n        if (error) throw error;\n        return data.id;\n    } catch (error: any) {\n        console.error('Error adding motor policy:', error);\n        throw new Error(error.message || 'Failed to add motor policy');\n    }\n}\n\n/**\n * Add a GMC policy\n */\nexport async function addHealthPolicy(policy: Omit<HealthPolicy, 'id' | 'created_at' | 'updated_at'>): Promise<string> {\n    try {\n        await checkDuplicatePolicy('health_policies', policy.user_id, policy.policy_number);\n\n        const { data, error } = await supabase\n            .from('health_policies')\n            .insert({\n                user_id: policy.user_id,\n                company_name: policy.company_name,\n                policy_number: policy.policy_number,\n                insurer_name: policy.insurer_name,\n                sum_insured: policy.sum_insured,\n                premium_amount: policy.premium_amount,\n                expiry_date: policy.expiry_date,\n                policy_docs: policy.policy_docs || [],\n                no_of_lives: policy.no_of_lives,\n            })\n            .select()\n            .single();\n\n        if (error) throw error;\n        return data.id;\n    } catch (error: any) {\n        console.error('Error adding health policy:', error);\n        throw new Error(error.message || 'Failed to add health policy');\n    }\n}\n\n/**\n * Add a commercial policy\n */\nexport async function addCommercialPolicy(policy: Omit<CommercialPolicy, 'id' | 'created_at' | 'updated_at'>): Promise<string> {\n    try {\n        await checkDuplicatePolicy('commercial_policies', policy.user_id, policy.policy_number);\n\n        const { data, error } = await supabase\n            .from('commercial_policies')\n            .insert({\n                user_id: policy.user_id,\n                lob_type: policy.lob_type,\n                company_name: policy.company_name,\n                policy_holder_name: policy.policy_holder_name,\n                policy_number: policy.policy_number,\n                insurer_name: policy.insurer_name,\n                premium_amount: policy.premium_amount,\n                sum_insured: policy.sum_insured,\n                expiry_date: policy.expiry_date,\n                policy_docs: policy.policy_docs || [],\n            })\n            .select()\n            .single();\n\n        if (error) throw error;\n        return data.id;\n    } catch (error: any) {\n        console.error('Error adding commercial policy:', error);\n        throw new Error(error.message || 'Failed to add commercial policy');\n    }\n}\n\n/**\n * Update a motor policy\n */\nexport async function updateMotorPolicy(id: string, updates: Partial<MotorPolicy>): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('motor_policies')\n            .update(updates)\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error updating motor policy:', error);\n        throw new Error(error.message || 'Failed to update motor policy');\n    }\n}\n\n/**\n * Delete a motor policy\n */\nexport async function deleteMotorPolicy(id: string): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('motor_policies')\n            .delete()\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error deleting motor policy:', error);\n        throw new Error(error.message || 'Failed to delete motor policy');\n    }\n}\n\n/**\n * Update a GMC policy\n */\nexport async function updateHealthPolicy(id: string, updates: Partial<HealthPolicy>): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('health_policies')\n            .update(updates)\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error updating health policy:', error);\n        throw new Error(error.message || 'Failed to update health policy');\n    }\n}\n\n/**\n * Delete a GMC policy\n */\nexport async function deleteHealthPolicy(id: string): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('health_policies')\n            .delete()\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error deleting health policy:', error);\n        throw new Error(error.message || 'Failed to delete health policy');\n    }\n}\n\n/**\n * Update a commercial policy\n */\nexport async function updateCommercialPolicy(id: string, updates: Partial<CommercialPolicy>): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('commercial_policies')\n            .update(updates)\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error updating commercial policy:', error);\n        throw new Error(error.message || 'Failed to update commercial policy');\n    }\n}\n\n/**\n * Delete a commercial policy\n */\nexport async function deleteCommercialPolicy(id: string): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('commercial_policies')\n            .delete()\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error deleting commercial policy:', error);\n        throw new Error(error.message || 'Failed to delete commercial policy');\n    }\n}\n\n/**\n * Add a claim\n */\nexport async function addClaim(claim: Omit<Claim, 'id' | 'created_at' | 'updated_at'>): Promise<string> {\n    try {\n        const { data, error } = await supabase\n            .from('claims')\n            .insert({\n                user_id: claim.user_id,\n                policy_id: claim.policy_id,\n                lob_type: claim.lob_type,\n                claim_type: claim.claim_type,\n                incident_date: claim.incident_date,\n                description: claim.description,\n                supporting_docs: claim.supporting_docs || [],\n                status: claim.status,\n            })\n            .select()\n            .single();\n\n        if (error) throw error;\n        return data.id;\n    } catch (error: any) {\n        console.error('Error adding claim:', error);\n        throw new Error(error.message || 'Failed to add claim');\n    }\n}\n\n/**\n * Update a claim\n */\nexport async function updateClaim(id: string, updates: Partial<Claim>): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('claims')\n            .update(updates)\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error updating claim:', error);\n        throw new Error(error.message || 'Failed to update claim');\n    }\n}\n\n/**\n * Add a quote request\n */\nexport async function addQuoteRequest(quote: Omit<QuoteRequest, 'id' | 'created_at'>): Promise<string> {\n    try {\n        const { data, error } = await supabase\n            .from('quote_requests')\n            .insert({\n                user_id: quote.user_id,\n                lob_type: quote.lob_type,\n                details: quote.details,\n                uploaded_quote: quote.uploaded_quote,\n                has_better_quote: quote.has_better_quote,\n                status: quote.status,\n            })\n            .select()\n            .single();\n\n        if (error) throw error;\n        return data.id;\n    } catch (error: any) {\n        console.error('Error adding quote request:', error);\n        throw new Error(error.message || 'Failed to add quote request');\n    }\n}\n\n/**\n * Update a quote request\n */\nexport async function updateQuoteRequest(id: string, updates: Partial<QuoteRequest>): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('quote_requests')\n            .update(updates)\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error updating quote request:', error);\n        throw new Error(error.message || 'Failed to update quote request');\n    }\n}\n\n/**\n * Get all referrals for a user\n */\nexport async function getUserReferrals(userId: string): Promise<Referral[]> {\n    try {\n        const { data, error } = await supabase\n            .from('referrals')\n            .select('*')\n            .eq('user_id', userId)\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as Referral[];\n    } catch (error: any) {\n        console.error('Error fetching referrals:', error.message, error.details, error.hint);\n        return [];\n    }\n}\n\n/**\n * Add a referral\n */\nexport async function addReferral(referral: Omit<Referral, 'id' | 'created_at'>): Promise<string> {\n    try {\n        const { data, error } = await supabase\n            .from('referrals')\n            .insert({\n                user_id: referral.user_id,\n                friend_name: referral.friend_name,\n                friend_mobile: referral.friend_mobile,\n                friend_email: referral.friend_email,\n                notes: referral.notes,\n            })\n            .select()\n            .single();\n\n        if (error) throw error;\n        return data.id;\n    } catch (error: any) {\n        console.error('Error adding referral:', error);\n        throw new Error(error.message || 'Failed to add referral');\n    }\n}\n\n/**\n * Log user field change for audit\n */\nexport async function logUserChange(\n    userId: string,\n    field: 'email' | 'mobile',\n    oldValue: string,\n    newValue: string\n): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('user_audit_log')\n            .insert({\n                user_id: userId,\n                field_changed: field,\n                old_value: oldValue,\n                new_value: newValue,\n            });\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error logging user change:', error);\n    }\n}\n\n// --- Admin: User Management ---\n\n/**\n * Get all users (Admin only)\n */\nexport async function getAllUsers(): Promise<User[]> {\n    try {\n        const { data, error } = await supabase\n            .from('users')\n            .select('*')\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as User[];\n    } catch (error: any) {\n        console.error('Error fetching all users:', error);\n        return [];\n    }\n}\n\n/**\n * Get user details by ID (Admin)\n */\nexport async function getUserById(userId: string): Promise<User | null> {\n    try {\n        const { data, error } = await supabase\n            .from('users')\n            .select('*')\n            .eq('id', userId)\n            .single();\n\n        if (error) throw error;\n        return convertDates(data) as User;\n    } catch (error: any) {\n        console.error('Error fetching user details:', error);\n        return null;\n    }\n}\n\n\n\n/**\n * Update user status (Disable/Enable) - Mock implementation as 'status' field might not exist yet\n * In a real scenario, we would update a 'status' or 'is_active' column.\n * For now, we'll assume there's an 'is_active' column or similar in the 'users' table or just log it.\n */\nexport async function updateUserStatus(userId: string, status: 'active' | 'disabled'): Promise<void> {\n    try {\n        // TODO: Ensure 'status' column exists in users table.\n        // For now, we will just log this action as if it happened.\n        console.log(`Updating user ${userId} status to ${status}`);\n\n        // const { error } = await supabase\n        //     .from('users')\n        //     .update({ status })\n        //     .eq('id', userId);\n        // if (error) throw error;\n    } catch (error: any) {\n        console.error('Error updating user status:', error);\n        throw error;\n    }\n}\n\n\n\n// ... (keeping imports)\n\n/**\n * Get audit logs for a user (Admin)\n */\nexport async function getUserAuditLogs(userId: string): Promise<AuditLog[]> {\n    try {\n        const { data, error } = await supabase\n            .from('user_audit_log')\n            .select('*')\n            .eq('user_id', userId)\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as AuditLog[];\n    } catch (error: any) {\n        console.error('Error fetching audit logs:', error.message || error);\n        return [];\n    }\n}\n\n// --- Admin: Policy Management ---\n\n/**\n * Get all motor policies (Admin)\n */\nexport async function getAllMotorPolicies(): Promise<MotorPolicy[]> {\n    try {\n        const { data, error } = await supabase\n            .from('motor_policies')\n            .select('*, users(name, email)')\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => ({\n            ...convertDates(row),\n            user_name: row.users?.name,\n            user_email: row.users?.email\n        })) as MotorPolicy[];\n    } catch (error: any) {\n        console.error('Error fetching all motor policies:', error);\n        return [];\n    }\n}\n\n/**\n * Get all GMC policies (Admin)\n */\nexport async function getAllHealthPolicies(): Promise<HealthPolicy[]> {\n    try {\n        const { data, error } = await supabase\n            .from('health_policies')\n            .select('*, users(name, email)')\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => ({\n            ...convertDates(row),\n            user_name: row.users?.name,\n            user_email: row.users?.email\n        })) as HealthPolicy[];\n    } catch (error: any) {\n        console.error('Error fetching all health policies:', error);\n        return [];\n    }\n}\n\n/**\n * Get all commercial policies (Admin)\n */\nexport async function getAllCommercialPolicies(): Promise<CommercialPolicy[]> {\n    try {\n        const { data, error } = await supabase\n            .from('commercial_policies')\n            .select('*, users(name, email)')\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => ({\n            ...convertDates(row),\n            user_name: row.users?.name,\n            user_email: row.users?.email\n        })) as CommercialPolicy[];\n    } catch (error: any) {\n        console.error('Error fetching all commercial policies:', error);\n        return [];\n    }\n}\n\n// --- Admin: Operations ---\n\n/**\n * Get all claims (Admin)\n */\nexport async function getAllClaims(): Promise<Claim[]> {\n    try {\n        const { data, error } = await supabase\n            .from('claims')\n            .select('*, users(name, email)')\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => ({\n            ...convertDates(row),\n            user_name: row.users?.name,\n            user_email: row.users?.email\n        })) as Claim[];\n    } catch (error: any) {\n        console.error('Error fetching all claims:', error);\n        return [];\n    }\n}\n\n/**\n * Get all quote requests (Admin)\n */\nexport async function getAllQuoteRequests(): Promise<QuoteRequest[]> {\n    try {\n        const { data, error } = await supabase\n            .from('quote_requests')\n            .select('*, users(name, email)')\n            .order('created_at', { ascending: false });\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => ({\n            ...convertDates(row),\n            user_name: row.users?.name,\n            user_email: row.users?.email\n        })) as QuoteRequest[];\n    } catch (error: any) {\n        console.error('Error fetching all quote requests:', error);\n        return [];\n    }\n}\n\n// --- Admin: System Configuration ---\n\n/**\n * Get all app settings\n */\nexport async function getAppSettings(): Promise<AppSetting[]> {\n    try {\n        const { data, error } = await supabase\n            .from('app_settings')\n            .select('*')\n            .order('key');\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as AppSetting[];\n    } catch (error: any) {\n        console.error('Error fetching app settings:', error);\n        return [];\n    }\n}\n\n/**\n * Update an app setting\n */\nexport async function updateAppSetting(key: string, value: any): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('app_settings')\n            .upsert({ key, value, updated_at: new Date() });\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error updating app setting:', error);\n        throw error;\n    }\n}\n\n/**\n * Get all banners\n */\nexport async function getAllBanners(): Promise<Banner[]> {\n    try {\n        const { data, error } = await supabase\n            .from('banners')\n            .select('*')\n            .order('display_order');\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as Banner[];\n    } catch (error: any) {\n        console.error('Error fetching banners:', error);\n        return [];\n    }\n}\n\n/**\n * Add a banner\n */\nexport async function addBanner(banner: Omit<Banner, 'id' | 'created_at' | 'updated_at'>): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('banners')\n            .insert(banner);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error adding banner:', error);\n        throw error;\n    }\n}\n\n/**\n * Delete a banner\n */\nexport async function deleteBanner(id: string): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('banners')\n            .delete()\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error deleting banner:', error);\n        throw error;\n    }\n}\n\n/**\n * Get all garages\n */\nexport async function getAllGarages(): Promise<Garage[]> {\n    try {\n        const { data, error } = await supabase\n            .from('garages')\n            .select('*')\n            .order('name');\n\n        if (error) throw error;\n\n        return (data || []).map((row: any) => convertDates(row)) as Garage[];\n    } catch (error: any) {\n        console.error('Error fetching garages:', error);\n        return [];\n    }\n}\n\n/**\n * Add a garage\n */\nexport async function addGarage(garage: Omit<Garage, 'id' | 'created_at' | 'updated_at'>): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('garages')\n            .insert(garage);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error adding garage:', error);\n        throw error;\n    }\n}\n\n/**\n * Delete a garage\n */\n/**\n * Delete a garage\n */\nexport async function deleteGarage(id: string): Promise<void> {\n    try {\n        const { error } = await supabase\n            .from('garages')\n            .delete()\n            .eq('id', id);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error deleting garage:', error);\n        throw error;\n    }\n}\n\n// ============================================\n// PROFILE MANAGEMENT FUNCTIONS\n// ============================================\n\n/**\n * Update user profile information\n */\nexport async function updateUserProfile(\n    userId: string,\n    updates: {\n        name?: string;\n        mobile?: string;\n        company_name?: string;\n        address?: string;\n        avatar_url?: string;\n    }\n): Promise<User> {\n    try {\n        const { data, error } = await supabase\n            .from('users')\n            .update(updates)\n            .eq('id', userId)\n            .select()\n            .single();\n\n        if (error) throw error;\n        return convertDates(data) as User;\n    } catch (error: any) {\n        console.error('Error updating user profile:', error);\n        throw error;\n    }\n}\n\n/**\n * Get Relationship Manager (RM) details for a user\n */\nexport async function getUserRM(userId: string): Promise<RMInfo | null> {\n    try {\n        // First get the user's rm_id\n        const { data: user, error: userError } = await supabase\n            .from('users')\n            .select('rm_id')\n            .eq('id', userId)\n            .single();\n\n        if (userError) {\n            // If user not found or error, return default RM for demo\n            console.log('Error fetching user for RM, returning default:', userError);\n            return {\n                name: 'Amit Sharma',\n                email: 'amit.sharma@onesingleview.com',\n                mobile: '+91 98765 43210'\n            };\n        }\n\n        if (!user?.rm_id) {\n            // Return default RM if none assigned\n            return {\n                name: 'Amit Sharma',\n                email: 'amit.sharma@onesingleview.com',\n                mobile: '+91 98765 43210'\n            };\n        }\n\n        // Then get the RM's details\n        const { data: rm, error: rmError } = await supabase\n            .from('users')\n            .select('name, email, mobile')\n            .eq('id', user.rm_id)\n            .single();\n\n        if (rmError) throw rmError;\n        return rm as RMInfo;\n    } catch (error: any) {\n        console.error('Error fetching user RM:', error);\n        // Return default RM on error to ensure UI shows something\n        return {\n            name: 'Amit Sharma',\n            email: 'amit.sharma@onesingleview.com',\n            mobile: '+91 98765 43210'\n        };\n    }\n}\n\n/**\n * Get user preferences, creating defaults if none exist\n */\nexport async function getUserPreferences(userId: string): Promise<UserPreferences> {\n    try {\n        const { data, error } = await supabase\n            .from('user_preferences')\n            .select('*')\n            .eq('user_id', userId)\n            .single();\n\n        if (error && error.code === 'PGRST116') {\n            // No preferences yet, create default\n            return await createDefaultPreferences(userId);\n        }\n\n        if (error) throw error;\n        return convertDates(data) as UserPreferences;\n    } catch (error: any) {\n        console.error('Error fetching user preferences:', error);\n        throw error;\n    }\n}\n\n/**\n * Create default preferences for a user\n */\nasync function createDefaultPreferences(userId: string): Promise<UserPreferences> {\n    try {\n        const defaultPrefs = {\n            user_id: userId,\n            email_notifications: true,\n            sms_notifications: false,\n            policy_expiry_alerts: true,\n            claim_updates: true,\n        };\n\n        const { data, error } = await supabase\n            .from('user_preferences')\n            .insert(defaultPrefs)\n            .select()\n            .single();\n\n        if (error) throw error;\n        return convertDates(data) as UserPreferences;\n    } catch (error: any) {\n        console.error('Error creating default preferences:', error);\n        throw error;\n    }\n}\n\n/**\n * Update user preferences\n */\nexport async function updateUserPreferences(\n    userId: string,\n    preferences: Partial<Omit<UserPreferences, 'id' | 'user_id' | 'created_at' | 'updated_at'>>\n): Promise<UserPreferences> {\n    try {\n        const { data, error } = await supabase\n            .from('user_preferences')\n            .upsert({\n                user_id: userId,\n                ...preferences,\n                updated_at: new Date().toISOString(),\n            })\n            .select()\n            .single();\n\n        if (error) throw error;\n        return convertDates(data) as UserPreferences;\n    } catch (error: any) {\n        console.error('Error updating user preferences:', error);\n        throw error;\n    }\n}\n\n// Life Policies\nexport async function getUserLifePolicies(userId: string) {\n    const { data, error } = await supabase\n        .from('life_policies')\n        .select('*')\n        .eq('user_id', userId)\n        .order('policy_end_date', { ascending: true });\n\n    if (error) throw error;\n    return (data || []).map((row: any) => convertDates(row));\n}\n\nexport async function addLifePolicy(policy: any) {\n    await checkDuplicatePolicy('life_policies', policy.user_id, policy.policy_number);\n    const { data, error } = await supabase\n        .from('life_policies')\n        .insert([policy])\n        .select()\n        .single();\n\n    if (error) throw error;\n    return data;\n}\n\n// Travel Policies\nexport async function getUserTravelPolicies(userId: string) {\n    const { data, error } = await supabase\n        .from('travel_policies')\n        .select('*')\n        .eq('user_id', userId)\n        .order('policy_end_date', { ascending: true });\n\n    if (error) throw error;\n    return (data || []).map((row: any) => convertDates(row));\n}\n\nexport async function addTravelPolicy(policy: any) {\n    await checkDuplicatePolicy('travel_policies', policy.user_id, policy.policy_number);\n    const { data, error } = await supabase\n        .from('travel_policies')\n        .insert([policy])\n        .select()\n        .single();\n\n    if (error) throw error;\n    return data;\n}\n\n/**\n * Get company's GMC policy by company name\n * Used by corporate employees to find their company's group health policy\n */\nexport async function getCompanyGMCPolicy(companyName: string) {\n    const { data, error } = await supabase\n        .from('health_policies')\n        .select('*')\n        .eq('company_name', companyName)\n        .maybeSingle();\n\n    if (error) throw error;\n    return data ? convertDates(data) : null;\n}\n\n// Cyber Policies\nexport async function getUserCyberPolicies(userId: string) {\n    const { data, error } = await supabase\n        .from('cyber_policies')\n        .select('*')\n        .eq('user_id', userId)\n        .order('policy_end_date', { ascending: true });\n\n    if (error) throw error;\n    return (data || []).map((row: any) => convertDates(row));\n}\n\nexport async function addCyberPolicy(policy: any) {\n    await checkDuplicatePolicy('cyber_policies', policy.user_id, policy.policy_number);\n    const { data, error } = await supabase\n        .from('cyber_policies')\n        .insert([policy])\n        .select()\n        .single();\n\n    if (error) throw error;\n    return data;\n}\n\n// Notifications\nexport async function getUserNotifications(userId: string) {\n    const { data, error } = await supabase\n        .from('notifications')\n        .select('*')\n        .eq('user_id', userId)\n        .order('created_at', { ascending: false })\n        .limit(20);\n\n    if (error) throw error;\n    return (data || []).map((row: any) => convertDates(row));\n}\n\nexport async function markNotificationAsRead(notificationId: string) {\n    const { error } = await supabase\n        .from('notifications')\n        .update({ is_read: true })\n        .eq('id', notificationId);\n\n    if (error) throw error;\n}\n\nexport async function markAllNotificationsAsRead(userId: string) {\n    const { error } = await supabase\n        .from('notifications')\n        .update({ is_read: true })\n        .eq('user_id', userId)\n        .eq('is_read', false);\n\n    if (error) throw error;\n}\n/**\n * Upload user avatar\n */\nexport async function uploadAvatar(userId: string, file: File): Promise<string | null> {\n    try {\n        const fileExt = file.name.split('.').pop();\n        const fileName = `${userId}-${Math.random()}.${fileExt}`;\n        const filePath = `${fileName}`;\n\n        // Upload file\n        const { error: uploadError } = await supabase.storage\n            .from('avatars')\n            .upload(filePath, file);\n\n        if (uploadError) {\n            throw uploadError;\n        }\n\n        // Get public URL\n        const { data } = supabase.storage\n            .from('avatars')\n            .getPublicUrl(filePath);\n\n        // Update user profile\n        const { error: updateError } = await supabase\n            .from('users')\n            .update({ avatar_url: data.publicUrl })\n            .eq('id', userId);\n\n        if (updateError) {\n            throw updateError;\n        }\n\n        return data.publicUrl;\n    } catch (error: any) {\n        console.error('Error uploading avatar:', error.message);\n        return null;\n    }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1993, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/layout/Header.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { Search, Bell, Mail, Phone, Menu } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport NotificationsMenu from './NotificationsMenu';\nimport { getUserRM } from '@/lib/db';\nimport { RMInfo } from '@/types';\n\ninterface HeaderProps {\n    user: {\n        id: string;\n        name: string;\n        email: string;\n        role: string;\n    };\n    onMenuClick?: () => void;\n}\n\nexport default function Header({ user, onMenuClick }: HeaderProps) {\n    const router = useRouter();\n    const [searchQuery, setSearchQuery] = useState('');\n    const [rmInfo, setRmInfo] = useState<RMInfo | null>(null);\n\n    useEffect(() => {\n        const loadRM = async () => {\n            if (user?.id) {\n                try {\n                    const rm = await getUserRM(user.id);\n                    setRmInfo(rm);\n                } catch (error) {\n                    console.error('Error loading RM info:', error);\n                }\n            }\n        };\n        loadRM();\n    }, [user?.id]);\n\n    const handleSearch = (e: React.KeyboardEvent<HTMLInputElement>) => {\n        if (e.key === 'Enter') {\n            router.push(`/policies?search=${encodeURIComponent(searchQuery)}`);\n        }\n    };\n\n    return (\n        <header className=\"bg-white border-b border-gray-100 h-16 flex items-center justify-between px-4 md:px-8 sticky top-0 z-40 shadow-sm\">\n            {/* Mobile Menu Button */}\n            <button\n                onClick={onMenuClick}\n                className=\"lg:hidden p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            >\n                <Menu className=\"w-6 h-6 text-gray-600\" />\n            </button>\n\n            {/* Search Bar */}\n            <div className=\"flex-1 max-w-xl relative mx-4\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n                <input\n                    type=\"text\"\n                    placeholder=\"Search policies, claims, or documents...\"\n                    className=\"w-full pl-10 pr-4 py-2 bg-gray-50 border-none rounded-xl text-sm focus:ring-2 focus:ring-primary-100 focus:bg-white transition-all placeholder-gray-400 text-gray-600\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    onKeyDown={handleSearch}\n                />\n            </div>\n\n            {/* Right Actions */}\n            <div className=\"flex items-center gap-2 md:gap-4\">\n                {/* RM Info - Desktop (large screens) */}\n                {rmInfo && (\n                    <div className=\"hidden lg:flex items-center gap-3 px-4 py-2 bg-blue-50 rounded-full border border-blue-100\">\n                        {/* RM Icon */}\n                        <div className=\"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0\">\n                            <span className=\"text-sm font-bold text-blue-600\">RM</span>\n                        </div>\n\n                        {/* RM Name Section */}\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-[10px] font-bold text-blue-600 uppercase tracking-wide leading-tight\">Relationship Manager</span>\n                            <span className=\"text-sm font-semibold text-gray-900 leading-tight\">{rmInfo.name}</span>\n                        </div>\n\n                        {/* Phone Number with Pipes */}\n                        <div className=\"flex items-center gap-2 px-3 border-l border-r border-blue-200\">\n                            <Phone className=\"w-4 h-4 text-gray-600\" />\n                            <a\n                                href={`tel:${rmInfo.mobile}`}\n                                className=\"text-sm font-semibold text-gray-900 hover:text-blue-600 transition-colors\"\n                                title=\"Click to call\"\n                            >\n                                {rmInfo.mobile}\n                            </a>\n                        </div>\n\n                        {/* Action Icons */}\n                        <div className=\"flex items-center gap-2\">\n                            <a\n                                href={`https://wa.me/${rmInfo.mobile.replace(/[^0-9]/g, '')}`}\n                                target=\"_blank\"\n                                rel=\"noopener noreferrer\"\n                                className=\"p-2 bg-green-50 hover:bg-green-100 rounded-full transition-colors\"\n                                title=\"Chat on WhatsApp\"\n                            >\n                                <svg className=\"w-4 h-4 text-green-600\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                                    <path d=\"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z\" />\n                                </svg>\n                            </a>\n                            <a\n                                href={`mailto:${rmInfo.email}`}\n                                className=\"p-2 bg-blue-50 hover:bg-blue-100 rounded-full transition-colors\"\n                                title=\"Send Email\"\n                            >\n                                <Mail className=\"w-4 h-4 text-blue-600\" />\n                            </a>\n                        </div>\n                    </div>\n                )}\n\n                {/* RM Info - Mobile & Tablet */}\n                {rmInfo && (\n                    <div className=\"flex lg:hidden items-center gap-2 px-3 py-1.5 bg-blue-50 rounded-full border border-blue-100\">\n                        <div className=\"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center\">\n                            <span className=\"text-xs font-bold text-blue-600\">RM</span>\n                        </div>\n                        <div className=\"flex flex-col\">\n                            <span className=\"text-[9px] font-bold text-blue-600 uppercase leading-tight\">R.M.</span>\n                            <span className=\"text-xs font-semibold text-gray-900 leading-tight truncate max-w-[100px]\">{rmInfo.name}</span>\n                        </div>\n                        <a href={`tel:${rmInfo.mobile}`} className=\"p-1.5 bg-indigo-50 hover:bg-indigo-100 rounded-full\">\n                            <Phone className=\"w-3.5 h-3.5 text-indigo-600\" />\n                        </a>\n                    </div>\n                )}\n\n                <NotificationsMenu userId={user.id} />\n            </div>\n        </header>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2301, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/app/%28customer%29/layout.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { User } from '@/types';\nimport { getCurrentUser, onAuthStateChange } from '@/lib/auth';\nimport Sidebar from '@/components/layout/Sidebar';\nimport Header from '@/components/layout/Header';\n\nexport default function CustomerLayout({\n    children,\n}: {\n    children: React.ReactNode;\n}) {\n    const router = useRouter();\n    const [user, setUser] = useState<User | null>(null);\n    const [loading, setLoading] = useState(true);\n    const [isMobileSidebarOpen, setIsMobileSidebarOpen] = useState(false);\n\n    useEffect(() => {\n        const checkAuth = async () => {\n            try {\n                const currentUser = await getCurrentUser();\n                if (!currentUser) {\n                    router.push('/login');\n                    return;\n                }\n                setUser(currentUser);\n            } catch (error) {\n                console.error('Auth check failed:', error);\n                router.push('/login');\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        checkAuth();\n\n        const { data: { subscription } } = onAuthStateChange((updatedUser) => {\n            setUser(updatedUser);\n            if (!updatedUser) {\n                router.push('/login');\n            }\n        });\n\n        return () => {\n            subscription.unsubscribe();\n        };\n    }, [router]);\n\n    if (loading) {\n        return (\n            <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n                <div className=\"text-center\">\n                    <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4\"></div>\n                    <p className=\"text-gray-600\">Loading...</p>\n                </div>\n            </div>\n        );\n    }\n\n    if (!user) return null;\n\n    return (\n        <div className=\"min-h-screen bg-gray-soft font-sans text-slate-900\">\n            {/* Sidebar with mobile overlay */}\n            <div className={`fixed inset-0 bg-black/50 z-40 lg:hidden transition-opacity ${isMobileSidebarOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}\n                onClick={() => setIsMobileSidebarOpen(false)}\n            />\n            <div className={`fixed inset-y-0 left-0 z-50 transform transition-transform lg:translate-x-0 ${isMobileSidebarOpen ? 'translate-x-0' : '-translate-x-full'}`}>\n                <Sidebar user={user} onClose={() => setIsMobileSidebarOpen(false)} />\n            </div>\n\n            <div className=\"lg:pl-72 transition-all duration-300\">\n                <Header user={user} onMenuClick={() => setIsMobileSidebarOpen(true)} />\n                <main className=\"py-4 px-4 sm:py-6 sm:px-6 lg:py-8 lg:px-8\">\n                    <div className=\"max-w-7xl mx-auto\">\n                        {children}\n                    </div>\n                </main>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AACA;AACA;AAPA;;;;;;;AASe,SAAS,eAAe,EACnC,QAAQ,EAGX;IACG,MAAM,SAAS,IAAA,gKAAS;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,kOAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kOAAQ,EAAC;IACvC,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,kOAAQ,EAAC;IAE/D,IAAA,mOAAS,EAAC;QACN,MAAM,YAAY;YACd,IAAI;gBACA,MAAM,cAAc,MAAM,IAAA,8IAAc;gBACxC,IAAI,CAAC,aAAa;oBACd,OAAO,IAAI,CAAC;oBACZ;gBACJ;gBACA,QAAQ;YACZ,EAAE,OAAO,OAAO;gBACZ,QAAQ,KAAK,CAAC,sBAAsB;gBACpC,OAAO,IAAI,CAAC;YAChB,SAAU;gBACN,WAAW;YACf;QACJ;QAEA;QAEA,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,IAAA,iJAAiB,EAAC,CAAC;YAClD,QAAQ;YACR,IAAI,CAAC,aAAa;gBACd,OAAO,IAAI,CAAC;YAChB;QACJ;QAEA,OAAO;YACH,aAAa,WAAW;QAC5B;IACJ,GAAG;QAAC;KAAO;IAEX,IAAI,SAAS;QACT,qBACI,+PAAC;YAAI,WAAU;sBACX,cAAA,+PAAC;gBAAI,WAAU;;kCACX,+PAAC;wBAAI,WAAU;;;;;;kCACf,+PAAC;wBAAE,WAAU;kCAAgB;;;;;;;;;;;;;;;;;IAI7C;IAEA,IAAI,CAAC,MAAM,OAAO;IAElB,qBACI,+PAAC;QAAI,WAAU;;0BAEX,+PAAC;gBAAI,WAAW,CAAC,4DAA4D,EAAE,sBAAsB,gBAAgB,iCAAiC;gBAClJ,SAAS,IAAM,uBAAuB;;;;;;0BAE1C,+PAAC;gBAAI,WAAW,CAAC,4EAA4E,EAAE,sBAAsB,kBAAkB,qBAAqB;0BACxJ,cAAA,+PAAC,4JAAO;oBAAC,MAAM;oBAAM,SAAS,IAAM,uBAAuB;;;;;;;;;;;0BAG/D,+PAAC;gBAAI,WAAU;;kCACX,+PAAC,2JAAM;wBAAC,MAAM;wBAAM,aAAa,IAAM,uBAAuB;;;;;;kCAC9D,+PAAC;wBAAK,WAAU;kCACZ,cAAA,+PAAC;4BAAI,WAAU;sCACV;;;;;;;;;;;;;;;;;;;;;;;AAMzB"}}]
}