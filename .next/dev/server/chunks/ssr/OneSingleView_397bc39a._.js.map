{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/hooks/useAuth.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { User } from '@/types';\nimport { getCurrentUser, onAuthStateChange } from '@/lib/auth';\n\nexport function useAuth() {\n    const [user, setUser] = useState<User | null>(null);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        let mounted = true;\n\n        const initAuth = async () => {\n            try {\n                const currentUser = await getCurrentUser();\n                if (mounted) {\n                    setUser(currentUser);\n                    setLoading(false);\n                }\n            } catch (error) {\n                console.error('Error initializing auth:', error);\n                if (mounted) setLoading(false);\n            }\n        };\n\n        initAuth();\n\n        const { data: { subscription } } = onAuthStateChange((user) => {\n            if (mounted) {\n                setUser(user);\n                setLoading(false);\n            }\n        });\n\n        return () => {\n            mounted = false;\n            subscription.unsubscribe();\n        };\n    }, []);\n\n    return { user, loading };\n}\n"],"names":[],"mappings":";;;;AAEA;AAEA;AAJA;;;AAMO,SAAS;IACZ,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,kOAAQ,EAAc;IAC9C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kOAAQ,EAAC;IAEvC,IAAA,mOAAS,EAAC;QACN,IAAI,UAAU;QAEd,MAAM,WAAW;YACb,IAAI;gBACA,MAAM,cAAc,MAAM,IAAA,8IAAc;gBACxC,IAAI,SAAS;oBACT,QAAQ;oBACR,WAAW;gBACf;YACJ,EAAE,OAAO,OAAO;gBACZ,QAAQ,KAAK,CAAC,4BAA4B;gBAC1C,IAAI,SAAS,WAAW;YAC5B;QACJ;QAEA;QAEA,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,IAAA,iJAAiB,EAAC,CAAC;YAClD,IAAI,SAAS;gBACT,QAAQ;gBACR,WAAW;YACf;QACJ;QAEA,OAAO;YACH,UAAU;YACV,aAAa,WAAW;QAC5B;IACJ,GAAG,EAAE;IAEL,OAAO;QAAE;QAAM;IAAQ;AAC3B"}},
    {"offset": {"line": 51, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/forms/FormInput.tsx"],"sourcesContent":["import React from 'react';\n\ninterface FormInputProps {\n    label: string;\n    name: string;\n    type?: 'text' | 'email' | 'tel' | 'number' | 'date' | 'select' | 'textarea';\n    value: string | number;\n    onChange: (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => void;\n    onBlur?: (e: React.FocusEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => void;\n    error?: string;\n    placeholder?: string;\n    required?: boolean;\n    disabled?: boolean;\n    min?: string | number;\n    max?: string | number;\n    step?: string | number;\n    options?: { value: string | number; label: string }[];\n    rows?: number;\n    className?: string;\n}\n\nexport default function FormInput({\n    label,\n    name,\n    type = 'text',\n    value,\n    onChange,\n    onBlur,\n    error,\n    placeholder,\n    required = false,\n    disabled = false,\n    min,\n    max,\n    step,\n    options = [],\n    rows = 4,\n    className = '',\n}: FormInputProps) {\n    const baseInputClass = `\n    w-full px-4 py-2 border rounded-lg\n    focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent\n    disabled:bg-gray-100 disabled:cursor-not-allowed\n    transition-colors\n    ${error ? 'border-red-500 focus:ring-red-500' : 'border-gray-300'}\n    ${className}\n  `;\n\n    const renderInput = () => {\n        if (type === 'select') {\n            return (\n                <select\n                    id={name}\n                    name={name}\n                    value={value}\n                    onChange={onChange}\n                    onBlur={onBlur}\n                    disabled={disabled}\n                    required={required}\n                    className={baseInputClass}\n                >\n                    <option value=\"\">Select {label}</option>\n                    {options.map((option) => (\n                        <option key={option.value} value={option.value}>\n                            {option.label}\n                        </option>\n                    ))}\n                </select>\n            );\n        }\n\n        if (type === 'textarea') {\n            return (\n                <textarea\n                    id={name}\n                    name={name}\n                    value={value}\n                    onChange={onChange}\n                    onBlur={onBlur}\n                    placeholder={placeholder}\n                    disabled={disabled}\n                    required={required}\n                    rows={rows}\n                    className={baseInputClass}\n                />\n            );\n        }\n\n        return (\n            <input\n                id={name}\n                name={name}\n                type={type}\n                value={value}\n                onChange={onChange}\n                onBlur={onBlur}\n                placeholder={placeholder}\n                disabled={disabled}\n                required={required}\n                min={min}\n                max={max}\n                step={step}\n                className={baseInputClass}\n            />\n        );\n    };\n\n    return (\n        <div className=\"space-y-1\">\n            <label htmlFor={name} className=\"block text-sm font-medium text-gray-700\">\n                {label}\n                {required && <span className=\"text-red-500 ml-1\">*</span>}\n            </label>\n            {renderInput()}\n            {error && (\n                <p className=\"text-sm text-red-600 flex items-center gap-1\">\n                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n                    </svg>\n                    {error}\n                </p>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;;AAqBe,SAAS,UAAU,EAC9B,KAAK,EACL,IAAI,EACJ,OAAO,MAAM,EACb,KAAK,EACL,QAAQ,EACR,MAAM,EACN,KAAK,EACL,WAAW,EACX,WAAW,KAAK,EAChB,WAAW,KAAK,EAChB,GAAG,EACH,GAAG,EACH,IAAI,EACJ,UAAU,EAAE,EACZ,OAAO,CAAC,EACR,YAAY,EAAE,EACD;IACb,MAAM,iBAAiB,CAAC;;;;;IAKxB,EAAE,QAAQ,sCAAsC,kBAAkB;IAClE,EAAE,UAAU;EACd,CAAC;IAEC,MAAM,cAAc;QAChB,IAAI,SAAS,UAAU;YACnB,qBACI,+PAAC;gBACG,IAAI;gBACJ,MAAM;gBACN,OAAO;gBACP,UAAU;gBACV,QAAQ;gBACR,UAAU;gBACV,UAAU;gBACV,WAAW;;kCAEX,+PAAC;wBAAO,OAAM;;4BAAG;4BAAQ;;;;;;;oBACxB,QAAQ,GAAG,CAAC,CAAC,uBACV,+PAAC;4BAA0B,OAAO,OAAO,KAAK;sCACzC,OAAO,KAAK;2BADJ,OAAO,KAAK;;;;;;;;;;;QAMzC;QAEA,IAAI,SAAS,YAAY;YACrB,qBACI,+PAAC;gBACG,IAAI;gBACJ,MAAM;gBACN,OAAO;gBACP,UAAU;gBACV,QAAQ;gBACR,aAAa;gBACb,UAAU;gBACV,UAAU;gBACV,MAAM;gBACN,WAAW;;;;;;QAGvB;QAEA,qBACI,+PAAC;YACG,IAAI;YACJ,MAAM;YACN,MAAM;YACN,OAAO;YACP,UAAU;YACV,QAAQ;YACR,aAAa;YACb,UAAU;YACV,UAAU;YACV,KAAK;YACL,KAAK;YACL,MAAM;YACN,WAAW;;;;;;IAGvB;IAEA,qBACI,+PAAC;QAAI,WAAU;;0BACX,+PAAC;gBAAM,SAAS;gBAAM,WAAU;;oBAC3B;oBACA,0BAAY,+PAAC;wBAAK,WAAU;kCAAoB;;;;;;;;;;;;YAEpD;YACA,uBACG,+PAAC;gBAAE,WAAU;;kCACT,+PAAC;wBAAI,WAAU;wBAAU,MAAK;wBAAe,SAAQ;kCACjD,cAAA,+PAAC;4BAAK,UAAS;4BAAU,GAAE;4BAAoH,UAAS;;;;;;;;;;;oBAE3J;;;;;;;;;;;;;AAKrB"}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/lib/storage.ts"],"sourcesContent":["import { supabase } from './supabase';\n\nexport type BucketName = 'policy-documents' | 'claim-documents' | 'rc-copies' | 'quote-documents';\n\n/**\n * Upload file to Supabase Storage\n * @param file - File to upload\n * @param bucket - Storage bucket name\n * @returns Promise<string> - Public URL of uploaded file\n */\nexport async function uploadFile(file: File, bucket: BucketName): Promise<string> {\n    try {\n        // Generate unique filename to prevent duplicates\n        const timestamp = Date.now();\n        const randomStr = Math.random().toString(36).substring(2, 8);\n        const fileExt = file.name.split('.').pop();\n        const fileName = `${timestamp}_${randomStr}.${fileExt}`;\n\n        const { data, error } = await supabase.storage\n            .from(bucket)\n            .upload(fileName, file, {\n                cacheControl: '3600',\n                upsert: true, // Allow overwriting if file exists\n            });\n\n        if (error) throw error;\n\n        // Get public URL\n        const { data: { publicUrl } } = supabase.storage\n            .from(bucket)\n            .getPublicUrl(data.path);\n\n        return publicUrl;\n    } catch (error: any) {\n        console.error('Error uploading file:', error);\n        throw new Error(error.message || 'Failed to upload file');\n    }\n}\n\n/**\n * Upload multiple files to Supabase Storage\n * @param files - Array of files to upload\n * @param bucket - Storage bucket name\n * @returns Promise<string[]> - Array of public URLs\n */\nexport async function uploadMultipleFiles(\n    files: File[],\n    bucket: BucketName\n): Promise<string[]> {\n    try {\n        const uploadPromises = files.map((file) => {\n            return uploadFile(file, bucket);\n        });\n\n        return await Promise.all(uploadPromises);\n    } catch (error: any) {\n        console.error('Error uploading multiple files:', error);\n        throw new Error(error.message || 'Failed to upload files');\n    }\n}\n\n/**\n * Delete a file from Supabase Storage\n * @param path - Full path to file in storage\n */\nexport async function deleteFile(path: string): Promise<void> {\n    try {\n        const { error } = await supabase.storage\n            .from('policy-documents')\n            .remove([path]);\n\n        if (error) throw error;\n    } catch (error: any) {\n        console.error('Error deleting file:', error);\n        throw new Error(error.message || 'Failed to delete file');\n    }\n}\n\n/**\n * Generate storage path for policy documents\n */\nexport function getPolicyStoragePath(\n    userId: string,\n    policyType: 'motor' | 'gmc' | 'commercial' | 'claims',\n    docType: string\n): string {\n    return `${policyType}_policies/${userId}/${docType}`;\n}\n\n/**\n * Create storage bucket if it doesn't exist (run once on setup)\n */\nexport async function initializeStorage(): Promise<void> {\n    try {\n        // Check if bucket exists\n        const { data: buckets } = await supabase.storage.listBuckets();\n\n        const bucketExists = buckets?.some((bucket: any) => bucket.name === 'policy-documents');\n\n        if (!bucketExists) {\n            // Create bucket\n            const { error } = await supabase.storage.createBucket('policy-documents', {\n                public: true,\n                fileSizeLimit: 52428800, // 50MB\n                allowedMimeTypes: ['application/pdf', 'image/*'],\n            });\n\n            if (error) {\n                console.error('Error creating storage bucket:', error);\n            } else {\n                console.log('Storage bucket created successfully');\n            }\n        }\n    } catch (error) {\n        console.error('Error initializing storage:', error);\n    }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAUO,eAAe,WAAW,IAAU,EAAE,MAAkB;IAC3D,IAAI;QACA,iDAAiD;QACjD,MAAM,YAAY,KAAK,GAAG;QAC1B,MAAM,YAAY,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,SAAS,CAAC,GAAG;QAC1D,MAAM,UAAU,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG;QACxC,MAAM,WAAW,GAAG,UAAU,CAAC,EAAE,UAAU,CAAC,EAAE,SAAS;QAEvD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,4IAAQ,CAAC,OAAO,CACzC,IAAI,CAAC,QACL,MAAM,CAAC,UAAU,MAAM;YACpB,cAAc;YACd,QAAQ;QACZ;QAEJ,IAAI,OAAO,MAAM;QAEjB,iBAAiB;QACjB,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE,GAAG,4IAAQ,CAAC,OAAO,CAC3C,IAAI,CAAC,QACL,YAAY,CAAC,KAAK,IAAI;QAE3B,OAAO;IACX,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,yBAAyB;QACvC,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACrC;AACJ;AAQO,eAAe,oBAClB,KAAa,EACb,MAAkB;IAElB,IAAI;QACA,MAAM,iBAAiB,MAAM,GAAG,CAAC,CAAC;YAC9B,OAAO,WAAW,MAAM;QAC5B;QAEA,OAAO,MAAM,QAAQ,GAAG,CAAC;IAC7B,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,mCAAmC;QACjD,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACrC;AACJ;AAMO,eAAe,WAAW,IAAY;IACzC,IAAI;QACA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,4IAAQ,CAAC,OAAO,CACnC,IAAI,CAAC,oBACL,MAAM,CAAC;YAAC;SAAK;QAElB,IAAI,OAAO,MAAM;IACrB,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,wBAAwB;QACtC,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACrC;AACJ;AAKO,SAAS,qBACZ,MAAc,EACd,UAAqD,EACrD,OAAe;IAEf,OAAO,GAAG,WAAW,UAAU,EAAE,OAAO,CAAC,EAAE,SAAS;AACxD;AAKO,eAAe;IAClB,IAAI;QACA,yBAAyB;QACzB,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,4IAAQ,CAAC,OAAO,CAAC,WAAW;QAE5D,MAAM,eAAe,SAAS,KAAK,CAAC,SAAgB,OAAO,IAAI,KAAK;QAEpE,IAAI,CAAC,cAAc;YACf,gBAAgB;YAChB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,4IAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,oBAAoB;gBACtE,QAAQ;gBACR,eAAe;gBACf,kBAAkB;oBAAC;oBAAmB;iBAAU;YACpD;YAEA,IAAI,OAAO;gBACP,QAAQ,KAAK,CAAC,kCAAkC;YACpD,OAAO;gBACH,QAAQ,GAAG,CAAC;YAChB;QACJ;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,+BAA+B;IACjD;AACJ"}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/forms/FileUpload.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useRef } from 'react';\nimport { Upload, X, File, CheckCircle } from 'lucide-react';\nimport { uploadFile, BucketName } from '@/lib/storage';\n\ninterface FileUploadProps {\n    label: string;\n    name: string;\n    accept?: string;\n    bucket: BucketName;\n    onUploadComplete: (url: string, fileName: string) => void;\n    existingFile?: { url: string; name: string };\n    required?: boolean;\n    maxSizeMB?: number;\n}\n\nexport default function FileUpload({\n    label,\n    name,\n    accept = '.pdf,.jpg,.jpeg,.png',\n    bucket,\n    onUploadComplete,\n    existingFile,\n    required = false,\n    maxSizeMB = 5,\n}: FileUploadProps) {\n    const [file, setFile] = useState<File | null>(null);\n    const [preview, setPreview] = useState<string | null>(existingFile?.url || null);\n    const [fileName, setFileName] = useState<string>(existingFile?.name || '');\n    const [uploading, setUploading] = useState(false);\n    const [progress, setProgress] = useState(0);\n    const [error, setError] = useState<string>('');\n    const fileInputRef = useRef<HTMLInputElement>(null);\n\n    const handleFileSelect = async (selectedFile: File) => {\n        setError('');\n\n        // Validate file size\n        if (selectedFile.size > maxSizeMB * 1024 * 1024) {\n            setError(`File size must be less than ${maxSizeMB}MB`);\n            return;\n        }\n\n        setFile(selectedFile);\n        setFileName(selectedFile.name);\n\n        // Show preview for images\n        if (selectedFile.type.startsWith('image/')) {\n            const reader = new FileReader();\n            reader.onload = (e) => {\n                setPreview(e.target?.result as string);\n            };\n            reader.readAsDataURL(selectedFile);\n        } else {\n            setPreview(null);\n        }\n\n        // Auto-upload\n        await uploadFileToStorage(selectedFile);\n    };\n\n    const uploadFileToStorage = async (fileToUpload: File) => {\n        setUploading(true);\n        setProgress(0);\n\n        try {\n            // Simulate progress\n            const progressInterval = setInterval(() => {\n                setProgress((prev) => Math.min(prev + 10, 90));\n            }, 200);\n\n            const fileUrl = await uploadFile(fileToUpload, bucket);\n\n            clearInterval(progressInterval);\n            setProgress(100);\n            setUploading(false);\n\n            onUploadComplete(fileUrl, fileToUpload.name);\n        } catch (err) {\n            console.error('Upload error:', err);\n            setError('Failed to upload file. Please try again.');\n            setUploading(false);\n            setFile(null);\n            setPreview(null);\n        }\n    };\n\n    const handleDrop = (e: React.DragEvent) => {\n        e.preventDefault();\n        const droppedFile = e.dataTransfer.files[0];\n        if (droppedFile) {\n            handleFileSelect(droppedFile);\n        }\n    };\n\n    const handleDragOver = (e: React.DragEvent) => {\n        e.preventDefault();\n    };\n\n    const handleRemove = () => {\n        setFile(null);\n        setPreview(null);\n        setFileName('');\n        setProgress(0);\n        setError('');\n        if (fileInputRef.current) {\n            fileInputRef.current.value = '';\n        }\n    };\n\n    return (\n        <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-gray-700\">\n                {label}\n                {required && <span className=\"text-red-500 ml-1\">*</span>}\n            </label>\n\n            {!file && !existingFile ? (\n                <div\n                    onDrop={handleDrop}\n                    onDragOver={handleDragOver}\n                    onClick={() => fileInputRef.current?.click()}\n                    className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-primary-500 transition-colors\"\n                >\n                    <Upload className=\"w-8 h-8 text-gray-400 mx-auto mb-2\" />\n                    <p className=\"text-sm text-gray-600 mb-1\">\n                        Click to upload or drag and drop\n                    </p>\n                    <p className=\"text-xs text-gray-500\">\n                        {accept.toUpperCase()} (Max {maxSizeMB}MB)\n                    </p>\n                    <input\n                        ref={fileInputRef}\n                        type=\"file\"\n                        accept={accept}\n                        onChange={(e) => e.target.files?.[0] && handleFileSelect(e.target.files[0])}\n                        className=\"hidden\"\n                    />\n                </div>\n            ) : (\n                <div className=\"border border-gray-300 rounded-lg p-4\">\n                    <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center space-x-3 flex-1\">\n                            {preview ? (\n                                <img src={preview} alt=\"Preview\" className=\"w-16 h-16 object-cover rounded\" />\n                            ) : (\n                                <File className=\"w-8 h-8 text-gray-400\" />\n                            )}\n                            <div className=\"flex-1 min-w-0 max-w-[280px]\">\n                                <p className=\"text-sm font-medium text-gray-900 truncate break-all\" title={fileName}>{fileName}</p>\n                                {uploading && (\n                                    <div className=\"mt-2\">\n                                        <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                                            <div\n                                                className=\"bg-primary-600 h-2 rounded-full transition-all\"\n                                                style={{ width: `${progress}%` }}\n                                            />\n                                        </div>\n                                        <p className=\"text-xs text-gray-500 mt-1\">Uploading... {progress}%</p>\n                                    </div>\n                                )}\n                                {!uploading && progress === 100 && (\n                                    <p className=\"text-xs text-green-600 flex items-center gap-1 mt-1\">\n                                        <CheckCircle className=\"w-3 h-3\" />\n                                        Uploaded successfully\n                                    </p>\n                                )}\n                            </div>\n                        </div>\n                        {!uploading && (\n                            <button\n                                type=\"button\"\n                                onClick={handleRemove}\n                                className=\"text-red-600 hover:text-red-800 p-1 ml-4 hover:bg-red-50 rounded-full transition-colors\"\n                            >\n                                <X className=\"w-5 h-5\" />\n                            </button>\n                        )}\n                    </div>\n                </div>\n            )}\n\n            {error && (\n                <p className=\"text-sm text-red-600 flex items-center gap-1\">\n                    <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n                    </svg>\n                    {error}\n                </p>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 618, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/lib/constants.ts"],"sourcesContent":["// Insurance Companies List\nexport const INSURANCE_COMPANIES = [\n    'HDFC ERGO',\n    'GO DIGIT',\n    'ICICI LOMBARD',\n    'TATA AIG',\n    'SHRIRAM GIC',\n    'ACKO GIC',\n    'CHOLA MS',\n    'INDUSIND GIC',\n    'BAJAJ GIC',\n    'IFFCO GIC',\n    'liberty gic',\n    'Royal sundaram',\n    'magma',\n    'kotak gic',\n    'sbi gic',\n    'national insurance',\n    'oriental',\n    'united India gic',\n    'new india gic',\n    'OTHERS'\n] as const;\n\n// Car Manufacturers List\nexport const CAR_MANUFACTURERS = [\n    'Maruti Suzuki',\n    'Hyundai',\n    'Tata',\n    'Honda',\n    'Toyota',\n    'Mahindra',\n    'Kia',\n    'Volkswagen',\n    'Renault',\n    'Nissan',\n    'Ford',\n    'Skoda',\n    'MG',\n    'Jeep',\n    'BMW',\n    'Mercedes-Benz',\n    'Audi',\n    'Volvo',\n    'Others'\n] as const;\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;;;;AACpB,MAAM,sBAAsB;IAC/B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACH;AAGM,MAAM,oBAAoB;IAC7B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACH"}},
    {"offset": {"line": 672, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/lib/validation.ts"],"sourcesContent":["// Form validation utilities\n\nexport const validateVehicleNumber = (vehicleNumber: string): boolean => {\n    // Indian vehicle number format: AA00AA0000 or AA00A0000\n    const regex = /^[A-Z]{2}[0-9]{1,2}[A-Z]{1,2}[0-9]{4}$/;\n    return regex.test(vehicleNumber.replace(/\\s+/g, ''));\n};\n\nexport const validatePolicyNumber = (policyNumber: string): boolean => {\n    // Basic validation: at least 5 characters\n    return policyNumber.trim().length >= 5;\n};\n\nexport const validatePremiumAmount = (amount: number, min = 0, max = 10000000): boolean => {\n    return amount >= min && amount <= max && !isNaN(amount);\n};\n\nexport const validateDateRange = (startDate: Date, endDate: Date): boolean => {\n    return startDate < endDate;\n};\n\nexport const validatePhoneNumber = (phone: string): boolean => {\n    // Indian phone number: 10 digits, optionally starting with +91\n    const regex = /^(\\+91)?[6-9]\\d{9}$/;\n    return regex.test(phone.replace(/[\\s-]/g, ''));\n};\n\nexport const validateEmail = (email: string): boolean => {\n    const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return regex.test(email);\n};\n\nexport const validateGSTNumber = (gst: string): boolean => {\n    // GST format: 22 characters\n    const regex = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;\n    return regex.test(gst);\n};\n\nexport const validatePAN = (pan: string): boolean => {\n    // PAN format: AAAAA0000A\n    const regex = /^[A-Z]{5}[0-9]{4}[A-Z]$/;\n    return regex.test(pan);\n};\n\nexport const formatCurrency = (amount: number): string => {\n    return new Intl.NumberFormat('en-IN', {\n        style: 'currency',\n        currency: 'INR',\n        maximumFractionDigits: 0,\n    }).format(amount);\n};\n\nexport const formatDate = (date: Date | string): string => {\n    const d = typeof date === 'string' ? new Date(date) : date;\n    return d.toLocaleDateString('en-IN', {\n        day: '2-digit',\n        month: '2-digit',\n        year: 'numeric',\n    });\n};\n\nexport const parseDate = (dateString: string): Date => {\n    return new Date(dateString);\n};\n\n// Get today's date in YYYY-MM-DD format for input defaults\nexport const getTodayString = (): string => {\n    return new Date().toISOString().split('T')[0];\n};\n\n// Get date one year from today\nexport const getOneYearFromNow = (): string => {\n    const date = new Date();\n    date.setFullYear(date.getFullYear() + 1);\n    return date.toISOString().split('T')[0];\n};\n\n// Validate required field\nexport const validateRequired = (value: any): boolean => {\n    if (typeof value === 'string') {\n        return value.trim().length > 0;\n    }\n    return value !== null && value !== undefined && value !== '';\n};\n\n// Error messages\nexport const getErrorMessage = (fieldName: string, validationType: string): string => {\n    const messages: Record<string, string> = {\n        required: `${fieldName} is required`,\n        vehicleNumber: 'Invalid vehicle number format (e.g., KA01AB1234)',\n        policyNumber: 'Policy number must be at least 5 characters',\n        premium: 'Invalid premium amount',\n        dateRange: 'End date must be after start date',\n        phone: 'Invalid phone number (10 digits)',\n        email: 'Invalid email address',\n        gst: 'Invalid GST number format',\n        pan: 'Invalid PAN format',\n    };\n    return messages[validationType] || `Invalid ${fieldName}`;\n};\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAErB,MAAM,wBAAwB,CAAC;IAClC,wDAAwD;IACxD,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,cAAc,OAAO,CAAC,QAAQ;AACpD;AAEO,MAAM,uBAAuB,CAAC;IACjC,0CAA0C;IAC1C,OAAO,aAAa,IAAI,GAAG,MAAM,IAAI;AACzC;AAEO,MAAM,wBAAwB,CAAC,QAAgB,MAAM,CAAC,EAAE,MAAM,QAAQ;IACzE,OAAO,UAAU,OAAO,UAAU,OAAO,CAAC,MAAM;AACpD;AAEO,MAAM,oBAAoB,CAAC,WAAiB;IAC/C,OAAO,YAAY;AACvB;AAEO,MAAM,sBAAsB,CAAC;IAChC,+DAA+D;IAC/D,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC,MAAM,OAAO,CAAC,UAAU;AAC9C;AAEO,MAAM,gBAAgB,CAAC;IAC1B,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC;AACtB;AAEO,MAAM,oBAAoB,CAAC;IAC9B,4BAA4B;IAC5B,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC;AACtB;AAEO,MAAM,cAAc,CAAC;IACxB,yBAAyB;IACzB,MAAM,QAAQ;IACd,OAAO,MAAM,IAAI,CAAC;AACtB;AAEO,MAAM,iBAAiB,CAAC;IAC3B,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QAClC,OAAO;QACP,UAAU;QACV,uBAAuB;IAC3B,GAAG,MAAM,CAAC;AACd;AAEO,MAAM,aAAa,CAAC;IACvB,MAAM,IAAI,OAAO,SAAS,WAAW,IAAI,KAAK,QAAQ;IACtD,OAAO,EAAE,kBAAkB,CAAC,SAAS;QACjC,KAAK;QACL,OAAO;QACP,MAAM;IACV;AACJ;AAEO,MAAM,YAAY,CAAC;IACtB,OAAO,IAAI,KAAK;AACpB;AAGO,MAAM,iBAAiB;IAC1B,OAAO,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;AACjD;AAGO,MAAM,oBAAoB;IAC7B,MAAM,OAAO,IAAI;IACjB,KAAK,WAAW,CAAC,KAAK,WAAW,KAAK;IACtC,OAAO,KAAK,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;AAC3C;AAGO,MAAM,mBAAmB,CAAC;IAC7B,IAAI,OAAO,UAAU,UAAU;QAC3B,OAAO,MAAM,IAAI,GAAG,MAAM,GAAG;IACjC;IACA,OAAO,UAAU,QAAQ,UAAU,aAAa,UAAU;AAC9D;AAGO,MAAM,kBAAkB,CAAC,WAAmB;IAC/C,MAAM,WAAmC;QACrC,UAAU,GAAG,UAAU,YAAY,CAAC;QACpC,eAAe;QACf,cAAc;QACd,SAAS;QACT,WAAW;QACX,OAAO;QACP,OAAO;QACP,KAAK;QACL,KAAK;IACT;IACA,OAAO,QAAQ,CAAC,eAAe,IAAI,CAAC,QAAQ,EAAE,WAAW;AAC7D"}},
    {"offset": {"line": 789, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/forms/MotorPolicyForm.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { X, Save, Loader2 } from 'lucide-react';\nimport { MotorPolicy, MotorPolicyFormData } from '@/types';\nimport FormInput from './FormInput';\nimport FileUpload from './FileUpload';\nimport { addMotorPolicy, updateMotorPolicy } from '@/lib/db';\nimport { INSURANCE_COMPANIES, CAR_MANUFACTURERS } from '@/lib/constants';\nimport { formatDateForInput } from '@/lib/utils';\nimport {\n    validateVehicleNumber,\n    validatePolicyNumber,\n    validatePremiumAmount,\n    validateDateRange,\n    getTodayString,\n    getOneYearFromNow\n} from '@/lib/validation';\n\ninterface MotorPolicyFormProps {\n    userId: string;\n    initialData?: MotorPolicy;\n    onClose: () => void;\n    onSuccess: () => void;\n}\n\nexport default function MotorPolicyForm({ userId, initialData, onClose, onSuccess }: MotorPolicyFormProps) {\n    const [loading, setLoading] = useState(false);\n    const [errors, setErrors] = useState<Record<string, string>>({});\n\n    const [formData, setFormData] = useState<MotorPolicyFormData>({\n        vehicle_number: initialData?.vehicle_number || '',\n        policy_number: initialData?.policy_number || '',\n        vehicle_type: initialData?.vehicle_type || 'Car',\n        manufacturer: initialData?.manufacturer || '',\n        model: initialData?.model || '',\n        fuel_type: initialData?.fuel_type || 'Petrol',\n        manufacturing_year: initialData?.manufacturing_year || new Date().getFullYear(),\n        number_plate_type: initialData?.number_plate_type || 'White',\n        ownership_type: initialData?.ownership_type || 'Individual',\n        policy_type: initialData?.policy_type || 'Comprehensive',\n        insurer_name: initialData?.insurer_name || '',\n        premium_amount: initialData?.premium_amount || 0,\n        policy_start_date: initialData?.policy_start_date ? new Date(initialData.policy_start_date) : new Date(),\n        policy_end_date: initialData?.policy_end_date ? new Date(initialData.policy_end_date) : new Date(new Date().setFullYear(new Date().getFullYear() + 1)),\n        rc_docs: initialData?.rc_docs || [],\n        previous_policy_docs: initialData?.previous_policy_docs || [],\n        dl_docs: initialData?.dl_docs || [],\n    });\n\n    // Auto-calculate end date when start date changes (1 day before same date next year)\n    useEffect(() => {\n        if (formData.policy_start_date && !initialData) {\n            const startDate = new Date(formData.policy_start_date);\n            const endDate = new Date(startDate);\n            endDate.setFullYear(endDate.getFullYear() + 1);\n            endDate.setDate(endDate.getDate() - 1); // 1 day before\n            setFormData(prev => ({\n                ...prev,\n                policy_end_date: endDate\n            }));\n        }\n    }, [formData.policy_start_date, initialData]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n        const { name, value, type } = e.target;\n\n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'number' ? Number(value) : value\n        }));\n\n        // Clear error when user types\n        if (errors[name]) {\n            setErrors(prev => {\n                const newErrors = { ...prev };\n                delete newErrors[name];\n                return newErrors;\n            });\n        }\n    };\n\n    const handleDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: new Date(value)\n        }));\n    };\n\n    const validateForm = (): boolean => {\n        const newErrors: Record<string, string> = {};\n\n        if (!validateVehicleNumber(formData.vehicle_number || '')) {\n            newErrors.vehicle_number = 'Invalid vehicle number format (e.g., KA01AB1234)';\n        }\n\n        if (!validatePolicyNumber(formData.policy_number || '')) {\n            newErrors.policy_number = 'Policy number is required';\n        }\n\n        if (!validatePremiumAmount(formData.premium_amount || 0)) {\n            newErrors.premium_amount = 'Invalid premium amount';\n        }\n\n        if (formData.policy_start_date && formData.policy_end_date) {\n            if (!validateDateRange(formData.policy_start_date, formData.policy_end_date)) {\n                newErrors.policy_end_date = 'End date must be after start date';\n            }\n        }\n\n        if (!formData.manufacturer) newErrors.manufacturer = 'Manufacturer is required';\n        if (!formData.model) newErrors.model = 'Model is required';\n        if (!formData.insurer_name) newErrors.insurer_name = 'Insurer name is required';\n\n        setErrors(newErrors);\n        return Object.keys(newErrors).length === 0;\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n\n        if (!validateForm()) return;\n\n        setLoading(true);\n        try {\n            const policyData = {\n                ...formData,\n                user_id: userId,\n                // Ensure dates are Date objects\n                policy_start_date: new Date(formData.policy_start_date!),\n                policy_end_date: new Date(formData.policy_end_date!),\n                rc_docs: formData.rc_docs || [],\n                previous_policy_docs: formData.previous_policy_docs || [],\n                dl_docs: formData.dl_docs || []\n            };\n\n            if (initialData?.id) {\n                await updateMotorPolicy(initialData.id, policyData);\n            } else {\n                await addMotorPolicy(policyData as any);\n            }\n\n            onSuccess();\n            onClose();\n        } catch (error) {\n            console.error('Error saving policy:', error);\n            setErrors(prev => ({ ...prev, submit: 'Failed to save policy. Please try again.' }));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleFileUpload = (field: 'rc_docs' | 'previous_policy_docs' | 'dl_docs') => (url: string) => {\n        setFormData(prev => ({\n            ...prev,\n            [field]: [...(prev[field] || []), url]\n        }));\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto\">\n            <div className=\"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n                <div className=\"flex items-center justify-between p-6 border-b sticky top-0 bg-white z-10\">\n                    <h2 className=\"text-xl font-bold text-gray-900\">\n                        {initialData ? 'Edit Motor Policy' : 'Add New Motor Policy'}\n                    </h2>\n                    <button onClick={onClose} className=\"text-gray-500 hover:text-gray-700\">\n                        <X className=\"w-6 h-6\" />\n                    </button>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-8\">\n                    {errors.submit && (\n                        <div className=\"bg-red-50 text-red-600 p-4 rounded-lg text-sm\">\n                            {errors.submit}\n                        </div>\n                    )}\n\n                    {/* Vehicle Details */}\n                    <section>\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Vehicle Details</h3>\n                        <div className=\"grid md:grid-cols-3 gap-6\">\n                            <FormInput\n                                label=\"Vehicle Number\"\n                                name=\"vehicle_number\"\n                                value={formData.vehicle_number || ''}\n                                onChange={handleChange}\n                                placeholder=\"KA01AB1234\"\n                                error={errors.vehicle_number}\n                                required\n                            />\n                            <FormInput\n                                label=\"Vehicle Type\"\n                                name=\"vehicle_type\"\n                                type=\"select\"\n                                value={formData.vehicle_type || 'Car'}\n                                onChange={handleChange}\n                                options={[\n                                    { value: 'Car', label: 'Car' },\n                                    { value: 'Bike', label: 'Bike' },\n                                    { value: 'Bus', label: 'Bus' },\n                                    { value: 'GCV', label: 'Goods Carrying Vehicle' },\n                                    { value: 'Misc', label: 'Miscellaneous' }\n                                ]}\n                                required\n                            />\n                            <FormInput\n                                label=\"Number Plate Type\"\n                                name=\"number_plate_type\"\n                                type=\"select\"\n                                value={formData.number_plate_type ?? ''}\n                                onChange={handleChange}\n                                required\n                                options={[\n                                    { value: 'White', label: 'White (Pvt)' },\n                                    { value: 'Yellow', label: 'Yellow (Commercial)' },\n                                    { value: 'EV', label: 'EV (Green)' },\n                                    { value: 'Others', label: 'Others' },\n                                ]}\n                            />\n                            <FormInput\n                                label=\"Ownership Type\"\n                                name=\"ownership_type\"\n                                type=\"select\"\n                                value={formData.ownership_type ?? 'Individual'}\n                                onChange={handleChange}\n                                required\n                                options={[\n                                    { value: 'Individual', label: 'Individual' },\n                                    { value: 'Company', label: 'Company' },\n                                ]}\n                            />\n                            <FormInput\n                                label=\"Policy Type\"\n                                name=\"policy_type\"\n                                type=\"select\"\n                                value={formData.policy_type ?? 'Comprehensive'}\n                                onChange={handleChange}\n                                required\n                                options={[\n                                    { value: 'Comprehensive', label: 'Comprehensive' },\n                                    { value: 'TP', label: 'TP (Third Party)' },\n                                ]}\n                            />\n                            <FormInput\n                                label=\"Manufacturer\"\n                                name=\"manufacturer\"\n                                type=\"select\"\n                                value={formData.manufacturer || ''}\n                                onChange={handleChange}\n                                options={CAR_MANUFACTURERS.map(m => ({ value: m, label: m }))}\n                                error={errors.manufacturer}\n                                required\n                            />\n                            <FormInput\n                                label=\"Model\"\n                                name=\"model\"\n                                value={formData.model || ''}\n                                onChange={handleChange}\n                                placeholder=\"e.g. Swift\"\n                                error={errors.model}\n                                required\n                            />\n                            <FormInput\n                                label=\"Fuel Type\"\n                                name=\"fuel_type\"\n                                type=\"select\"\n                                value={formData.fuel_type || 'Petrol'}\n                                onChange={handleChange}\n                                options={[\n                                    { value: 'Petrol', label: 'Petrol' },\n                                    { value: 'Diesel', label: 'Diesel' },\n                                    { value: 'CNG', label: 'CNG' },\n                                    { value: 'Electric', label: 'Electric' },\n                                    { value: 'Hybrid', label: 'Hybrid' }\n                                ]}\n                                required\n                            />\n                            <FormInput\n                                label=\"Manufacturing Year\"\n                                name=\"manufacturing_year\"\n                                type=\"number\"\n                                value={formData.manufacturing_year || new Date().getFullYear()}\n                                onChange={handleChange}\n                                min={1990}\n                                max={new Date().getFullYear()}\n                                required\n                            />\n                        </div>\n                    </section>\n\n                    {/* Policy Details */}\n                    <section>\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Policy Details</h3>\n                        <div className=\"grid md:grid-cols-3 gap-6\">\n                            <FormInput\n                                label=\"Policy Number\"\n                                name=\"policy_number\"\n                                value={formData.policy_number || ''}\n                                onChange={handleChange}\n                                placeholder=\"Enter policy number\"\n                                error={errors.policy_number}\n                                required\n                            />\n                            <FormInput\n                                label=\"Insurer Name\"\n                                name=\"insurer_name\"\n                                type=\"select\"\n                                value={formData.insurer_name || ''}\n                                onChange={handleChange}\n                                options={INSURANCE_COMPANIES.map(c => ({ value: c, label: c }))}\n                                error={errors.insurer_name}\n                                required\n                            />\n                            <FormInput\n                                label=\"Premium Amount (â‚¹)\"\n                                name=\"premium_amount\"\n                                type=\"number\"\n                                value={formData.premium_amount || ''}\n                                onChange={handleChange}\n                                error={errors.premium_amount}\n                                required\n                            />\n                            <FormInput\n                                label=\"Start Date\"\n                                name=\"policy_start_date\"\n                                type=\"date\"\n                                value={formatDateForInput(formData.policy_start_date)}\n                                onChange={handleDateChange as any}\n                                required\n                            />\n                            <FormInput\n                                label=\"End Date\"\n                                name=\"policy_end_date\"\n                                type=\"date\"\n                                value={formatDateForInput(formData.policy_end_date)}\n                                onChange={handleDateChange as any}\n                                required\n                            />\n                        </div>\n                    </section>\n\n                    {/* Documents */}\n                    <section>\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Documents</h3>\n                        <div className=\"grid md:grid-cols-3 gap-6\">\n                            <FileUpload\n                                label=\"RC Copy\"\n                                name=\"rc_docs\"\n                                bucket=\"rc-copies\"\n                                onUploadComplete={handleFileUpload('rc_docs')}\n                                existingFile={formData.rc_docs && formData.rc_docs.length > 0 ? { url: formData.rc_docs[0], name: 'RC Document' } : undefined}\n                            />\n                            <FileUpload\n                                label=\"Previous Policy\"\n                                name=\"previous_policy_docs\"\n                                bucket=\"policy-documents\"\n                                onUploadComplete={handleFileUpload('previous_policy_docs')}\n                                existingFile={formData.previous_policy_docs && formData.previous_policy_docs.length > 0 ? { url: formData.previous_policy_docs[0], name: 'Previous Policy' } : undefined}\n                            />\n                        </div>\n                    </section>\n\n                    <div className=\"flex justify-end space-x-4 pt-6 border-t\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50\"\n                            disabled={loading}\n                        >\n                            Cancel\n                        </button>\n                        <button\n                            type=\"submit\"\n                            className=\"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center\"\n                            disabled={loading}\n                        >\n                            {loading ? (\n                                <>\n                                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                                    Saving...\n                                </>\n                            ) : (\n                                <>\n                                    <Save className=\"w-4 h-4 mr-2\" />\n                                    Save Policy\n                                </>\n                            )}\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1431, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/forms/HealthPolicyForm.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { X, Save, Loader2 } from 'lucide-react';\nimport { HealthPolicy, HealthPolicyFormData } from '@/types';\nimport FormInput from './FormInput';\nimport FileUpload from './FileUpload';\nimport { addHealthPolicy, updateHealthPolicy } from '@/lib/db';\nimport { INSURANCE_COMPANIES } from '@/lib/constants';\nimport { formatDateForInput } from '@/lib/utils';\nimport {\n    validatePolicyNumber,\n    validatePremiumAmount,\n    validateDateRange\n} from '@/lib/validation';\n\ninterface HealthPolicyFormProps {\n    userId: string;\n    initialData?: HealthPolicy;\n    onClose: () => void;\n    onSuccess: () => void;\n}\n\nexport default function HealthPolicyForm({ userId, initialData, onClose, onSuccess }: HealthPolicyFormProps) {\n    const [loading, setLoading] = useState(false);\n    const [errors, setErrors] = useState<Record<string, string>>({});\n\n    const [formData, setFormData] = useState<HealthPolicyFormData>({\n        company_name: initialData?.company_name || '',\n        policy_number: initialData?.policy_number || '',\n        insurer_name: initialData?.insurer_name || '',\n        sum_insured: initialData?.sum_insured || 0,\n        premium_amount: initialData?.premium_amount || 0,\n        expiry_date: initialData?.expiry_date ? new Date(initialData.expiry_date) : new Date(new Date().setFullYear(new Date().getFullYear() + 1)),\n        policy_docs: initialData?.policy_docs || [],\n        no_of_lives: initialData?.no_of_lives || 0,\n    });\n\n    // Auto-calculate expiry date when it's a new policy (1 year from today - 1 day)\n    useEffect(() => {\n        if (!initialData) {\n            const today = new Date();\n            const expiryDate = new Date(today);\n            expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n            expiryDate.setDate(expiryDate.getDate() - 1); // 1 day before\n            setFormData(prev => ({\n                ...prev,\n                expiry_date: expiryDate\n            }));\n        }\n    }, [initialData]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n        const { name, value, type } = e.target;\n\n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'number' ? Number(value) : value\n        }));\n\n        if (errors[name]) {\n            setErrors(prev => {\n                const newErrors = { ...prev };\n                delete newErrors[name];\n                return newErrors;\n            });\n        }\n    };\n\n    const handleDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: new Date(value)\n        }));\n    };\n\n    const validateForm = (): boolean => {\n        const newErrors: Record<string, string> = {};\n\n        if (!validatePolicyNumber(formData.policy_number || '')) {\n            newErrors.policy_number = 'Policy number is required';\n        }\n\n        if (!validatePremiumAmount(formData.premium_amount || 0)) {\n            newErrors.premium_amount = 'Invalid premium amount';\n        }\n\n        if (!formData.insurer_name) newErrors.insurer_name = 'Insurer name is required';\n        if (!formData.company_name) newErrors.company_name = 'Company name is required';\n\n        setErrors(newErrors);\n        return Object.keys(newErrors).length === 0;\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n\n        if (!validateForm()) return;\n\n        setLoading(true);\n        try {\n            const policyData = {\n                ...formData,\n                user_id: userId,\n                expiry_date: new Date(formData.expiry_date!),\n                policy_number: formData.policy_number || '',\n                insurer_name: formData.insurer_name || '',\n                premium_amount: formData.premium_amount || 0,\n                policy_docs: formData.policy_docs || []\n            };\n\n            if (initialData?.id) {\n                await updateHealthPolicy(initialData.id, policyData);\n            } else {\n                await addHealthPolicy(policyData);\n            }\n\n            onSuccess();\n            onClose();\n        } catch (error) {\n            console.error('Error saving policy:', error);\n            setErrors(prev => ({ ...prev, submit: 'Failed to save policy. Please try again.' }));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleFileUpload = (url: string) => {\n        setFormData(prev => ({\n            ...prev,\n            policy_docs: [...(prev.policy_docs || []), url]\n        }));\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto\">\n            <div className=\"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n                <div className=\"flex items-center justify-between p-6 border-b sticky top-0 bg-white z-10\">\n                    <h2 className=\"text-xl font-bold text-gray-900\">\n                        {initialData ? 'Edit Health Insurance Policy' : 'Add New Health Insurance Policy'}\n                    </h2>\n                    <button onClick={onClose} className=\"text-gray-500 hover:text-gray-700\">\n                        <X className=\"w-6 h-6\" />\n                    </button>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-8\">\n                    {errors.submit && (\n                        <div className=\"bg-red-50 text-red-600 p-4 rounded-lg text-sm\">\n                            {errors.submit}\n                        </div>\n                    )}\n\n                    {/* Policy Details */}\n                    <section>\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Policy Details</h3>\n                        <div className=\"grid md:grid-cols-3 gap-6\">\n                            <FormInput\n                                label=\"Company Name\"\n                                name=\"company_name\"\n                                value={formData.company_name || ''}\n                                onChange={handleChange}\n                                placeholder=\"e.g. Acme Corp\"\n                                error={errors.company_name}\n                                required\n                            />\n                            <FormInput\n                                label=\"Policy Number\"\n                                name=\"policy_number\"\n                                value={formData.policy_number || ''}\n                                onChange={handleChange}\n                                placeholder=\"Enter policy number\"\n                                error={errors.policy_number}\n                                required\n                            />\n                            <FormInput\n                                label=\"Insurer Name\"\n                                name=\"insurer_name\"\n                                type=\"select\"\n                                value={formData.insurer_name || ''}\n                                onChange={handleChange}\n                                options={INSURANCE_COMPANIES.map(c => ({ value: c, label: c }))}\n                                error={errors.insurer_name}\n                                required\n                            />\n                            <FormInput\n                                label=\"Sum Insured (â‚¹)\"\n                                name=\"sum_insured\"\n                                type=\"number\"\n                                value={formData.sum_insured || ''}\n                                onChange={handleChange}\n                                placeholder=\"e.g. 500000\"\n                            />\n                            <FormInput\n                                label=\"Premium Amount (â‚¹)\"\n                                name=\"premium_amount\"\n                                type=\"number\"\n                                value={formData.premium_amount || ''}\n                                onChange={handleChange}\n                                error={errors.premium_amount}\n                                required\n                            />\n                            <FormInput\n                                label=\"Expiry Date\"\n                                name=\"expiry_date\"\n                                type=\"date\"\n                                value={formatDateForInput(formData.expiry_date)}\n                                onChange={handleDateChange as any}\n                                required\n                            />\n                            <FormInput\n                                label=\"Number of Lives\"\n                                name=\"no_of_lives\"\n                                type=\"number\"\n                                value={formData.no_of_lives || ''}\n                                onChange={handleChange}\n                                placeholder=\"e.g. 50\"\n                            />\n                        </div>\n                    </section>\n\n                    {/* Documents */}\n                    <section>\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Documents</h3>\n                        <div className=\"grid md:grid-cols-3 gap-6\">\n                            <FileUpload\n                                label=\"Policy Document\"\n                                name=\"policy_docs\"\n                                bucket=\"policy-documents\"\n                                onUploadComplete={handleFileUpload}\n                                existingFile={formData.policy_docs && formData.policy_docs.length > 0 ? { url: formData.policy_docs[0], name: 'Policy Document' } : undefined}\n                            />\n                        </div>\n                    </section>\n\n                    <div className=\"flex justify-end space-x-4 pt-6 border-t\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50\"\n                            disabled={loading}\n                        >\n                            Cancel\n                        </button>\n                        <button\n                            type=\"submit\"\n                            className=\"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center\"\n                            disabled={loading}\n                        >\n                            {loading ? (\n                                <>\n                                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                                    Saving...\n                                </>\n                            ) : (\n                                <>\n                                    <Save className=\"w-4 h-4 mr-2\" />\n                                    Save Policy\n                                </>\n                            )}\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAVA;;;;;;;;;;AAuBe,SAAS,iBAAiB,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,SAAS,EAAyB;IACvG,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kOAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,kOAAQ,EAAyB,CAAC;IAE9D,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,kOAAQ,EAAuB;QAC3D,cAAc,aAAa,gBAAgB;QAC3C,eAAe,aAAa,iBAAiB;QAC7C,cAAc,aAAa,gBAAgB;QAC3C,aAAa,aAAa,eAAe;QACzC,gBAAgB,aAAa,kBAAkB;QAC/C,aAAa,aAAa,cAAc,IAAI,KAAK,YAAY,WAAW,IAAI,IAAI,KAAK,IAAI,OAAO,WAAW,CAAC,IAAI,OAAO,WAAW,KAAK;QACvI,aAAa,aAAa,eAAe,EAAE;QAC3C,aAAa,aAAa,eAAe;IAC7C;IAEA,gFAAgF;IAChF,IAAA,mOAAS,EAAC;QACN,IAAI,CAAC,aAAa;YACd,MAAM,QAAQ,IAAI;YAClB,MAAM,aAAa,IAAI,KAAK;YAC5B,WAAW,WAAW,CAAC,WAAW,WAAW,KAAK;YAClD,WAAW,OAAO,CAAC,WAAW,OAAO,KAAK,IAAI,eAAe;YAC7D,YAAY,CAAA,OAAQ,CAAC;oBACjB,GAAG,IAAI;oBACP,aAAa;gBACjB,CAAC;QACL;IACJ,GAAG;QAAC;KAAY;IAEhB,MAAM,eAAe,CAAC;QAClB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,MAAM;QAEtC,YAAY,CAAA,OAAQ,CAAC;gBACjB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE,SAAS,WAAW,OAAO,SAAS;YAChD,CAAC;QAED,IAAI,MAAM,CAAC,KAAK,EAAE;YACd,UAAU,CAAA;gBACN,MAAM,YAAY;oBAAE,GAAG,IAAI;gBAAC;gBAC5B,OAAO,SAAS,CAAC,KAAK;gBACtB,OAAO;YACX;QACJ;IACJ;IAEA,MAAM,mBAAmB,CAAC;QACtB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAA,OAAQ,CAAC;gBACjB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE,IAAI,KAAK;YACrB,CAAC;IACL;IAEA,MAAM,eAAe;QACjB,MAAM,YAAoC,CAAC;QAE3C,IAAI,CAAC,IAAA,0JAAoB,EAAC,SAAS,aAAa,IAAI,KAAK;YACrD,UAAU,aAAa,GAAG;QAC9B;QAEA,IAAI,CAAC,IAAA,2JAAqB,EAAC,SAAS,cAAc,IAAI,IAAI;YACtD,UAAU,cAAc,GAAG;QAC/B;QAEA,IAAI,CAAC,SAAS,YAAY,EAAE,UAAU,YAAY,GAAG;QACrD,IAAI,CAAC,SAAS,YAAY,EAAE,UAAU,YAAY,GAAG;QAErD,UAAU;QACV,OAAO,OAAO,IAAI,CAAC,WAAW,MAAM,KAAK;IAC7C;IAEA,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAEhB,IAAI,CAAC,gBAAgB;QAErB,WAAW;QACX,IAAI;YACA,MAAM,aAAa;gBACf,GAAG,QAAQ;gBACX,SAAS;gBACT,aAAa,IAAI,KAAK,SAAS,WAAW;gBAC1C,eAAe,SAAS,aAAa,IAAI;gBACzC,cAAc,SAAS,YAAY,IAAI;gBACvC,gBAAgB,SAAS,cAAc,IAAI;gBAC3C,aAAa,SAAS,WAAW,IAAI,EAAE;YAC3C;YAEA,IAAI,aAAa,IAAI;gBACjB,MAAM,IAAA,gJAAkB,EAAC,YAAY,EAAE,EAAE;YAC7C,OAAO;gBACH,MAAM,IAAA,6IAAe,EAAC;YAC1B;YAEA;YACA;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,wBAAwB;YACtC,UAAU,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,QAAQ;gBAA2C,CAAC;QACtF,SAAU;YACN,WAAW;QACf;IACJ;IAEA,MAAM,mBAAmB,CAAC;QACtB,YAAY,CAAA,OAAQ,CAAC;gBACjB,GAAG,IAAI;gBACP,aAAa;uBAAK,KAAK,WAAW,IAAI,EAAE;oBAAG;iBAAI;YACnD,CAAC;IACL;IAEA,qBACI,+PAAC;QAAI,WAAU;kBACX,cAAA,+PAAC;YAAI,WAAU;;8BACX,+PAAC;oBAAI,WAAU;;sCACX,+PAAC;4BAAG,WAAU;sCACT,cAAc,iCAAiC;;;;;;sCAEpD,+PAAC;4BAAO,SAAS;4BAAS,WAAU;sCAChC,cAAA,+PAAC,kNAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAIrB,+PAAC;oBAAK,UAAU;oBAAc,WAAU;;wBACnC,OAAO,MAAM,kBACV,+PAAC;4BAAI,WAAU;sCACV,OAAO,MAAM;;;;;;sCAKtB,+PAAC;;8CACG,+PAAC;oCAAG,WAAU;8CAA2C;;;;;;8CACzD,+PAAC;oCAAI,WAAU;;sDACX,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,OAAO,SAAS,YAAY,IAAI;4CAChC,UAAU;4CACV,aAAY;4CACZ,OAAO,OAAO,YAAY;4CAC1B,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,OAAO,SAAS,aAAa,IAAI;4CACjC,UAAU;4CACV,aAAY;4CACZ,OAAO,OAAO,aAAa;4CAC3B,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,SAAS,YAAY,IAAI;4CAChC,UAAU;4CACV,SAAS,wJAAmB,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;oDAAE,OAAO;oDAAG,OAAO;gDAAE,CAAC;4CAC7D,OAAO,OAAO,YAAY;4CAC1B,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,SAAS,WAAW,IAAI;4CAC/B,UAAU;4CACV,aAAY;;;;;;sDAEhB,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,SAAS,cAAc,IAAI;4CAClC,UAAU;4CACV,OAAO,OAAO,cAAc;4CAC5B,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,IAAA,mJAAkB,EAAC,SAAS,WAAW;4CAC9C,UAAU;4CACV,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,SAAS,WAAW,IAAI;4CAC/B,UAAU;4CACV,aAAY;;;;;;;;;;;;;;;;;;sCAMxB,+PAAC;;8CACG,+PAAC;oCAAG,WAAU;8CAA2C;;;;;;8CACzD,+PAAC;oCAAI,WAAU;8CACX,cAAA,+PAAC,8JAAU;wCACP,OAAM;wCACN,MAAK;wCACL,QAAO;wCACP,kBAAkB;wCAClB,cAAc,SAAS,WAAW,IAAI,SAAS,WAAW,CAAC,MAAM,GAAG,IAAI;4CAAE,KAAK,SAAS,WAAW,CAAC,EAAE;4CAAE,MAAM;wCAAkB,IAAI;;;;;;;;;;;;;;;;;sCAKhJ,+PAAC;4BAAI,WAAU;;8CACX,+PAAC;oCACG,MAAK;oCACL,SAAS;oCACT,WAAU;oCACV,UAAU;8CACb;;;;;;8CAGD,+PAAC;oCACG,MAAK;oCACL,WAAU;oCACV,UAAU;8CAET,wBACG;;0DACI,+PAAC,6OAAO;gDAAC,WAAU;;;;;;4CAA8B;;qEAIrD;;0DACI,+PAAC,2NAAI;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUrE"}},
    {"offset": {"line": 1837, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/forms/CommercialPolicyForm.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { X, Save, Loader2 } from 'lucide-react';\nimport { CommercialPolicy, CommercialPolicyFormData } from '@/types';\nimport FormInput from './FormInput';\nimport FileUpload from './FileUpload';\nimport { addCommercialPolicy, updateCommercialPolicy } from '@/lib/db';\nimport { INSURANCE_COMPANIES } from '@/lib/constants';\nimport { formatDateForInput } from '@/lib/utils';\nimport {\n    validatePolicyNumber,\n    validatePremiumAmount,\n    validateDateRange\n} from '@/lib/validation';\n\ninterface CommercialPolicyFormProps {\n    userId: string;\n    initialData?: CommercialPolicy;\n    onClose: () => void;\n    onSuccess: () => void;\n}\n\nexport default function CommercialPolicyForm({ userId, initialData, onClose, onSuccess }: CommercialPolicyFormProps) {\n    const [loading, setLoading] = useState(false);\n    const [errors, setErrors] = useState<Record<string, string>>({});\n\n    const [formData, setFormData] = useState<CommercialPolicyFormData>({\n        lob_type: initialData?.lob_type || 'GPA',\n        company_name: initialData?.company_name || '',\n        policy_holder_name: initialData?.policy_holder_name || '',\n        policy_number: initialData?.policy_number || '',\n        insurer_name: initialData?.insurer_name || '',\n        premium_amount: initialData?.premium_amount || 0,\n        sum_insured: initialData?.sum_insured || 0,\n        expiry_date: initialData?.expiry_date ? new Date(initialData.expiry_date) : new Date(new Date().setFullYear(new Date().getFullYear() + 1)),\n        policy_docs: initialData?.policy_docs || [],\n    });\n\n    // Auto-calculate expiry date when it's a new policy (1 year from today - 1 day)\n    useEffect(() => {\n        if (!initialData) {\n            const today = new Date();\n            const expiryDate = new Date(today);\n            expiryDate.setFullYear(expiryDate.getFullYear() + 1);\n            expiryDate.setDate(expiryDate.getDate() - 1); // 1 day before\n            setFormData(prev => ({\n                ...prev,\n                expiry_date: expiryDate\n            }));\n        }\n    }, [initialData]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n        const { name, value, type } = e.target;\n\n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'number' ? Number(value) : value\n        }));\n\n        if (errors[name]) {\n            setErrors(prev => {\n                const newErrors = { ...prev };\n                delete newErrors[name];\n                return newErrors;\n            });\n        }\n    };\n\n    const handleDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: new Date(value)\n        }));\n    };\n\n    const validateForm = (): boolean => {\n        const newErrors: Record<string, string> = {};\n\n        if (!validatePolicyNumber(formData.policy_number || '')) {\n            newErrors.policy_number = 'Policy number is required';\n        }\n\n        if (!validatePremiumAmount(formData.premium_amount || 0)) {\n            newErrors.premium_amount = 'Invalid premium amount';\n        }\n\n        if (!formData.insurer_name) newErrors.insurer_name = 'Insurer name is required';\n        if (!formData.lob_type) newErrors.lob_type = 'LOB Type is required';\n\n        setErrors(newErrors);\n        return Object.keys(newErrors).length === 0;\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n\n        if (!validateForm()) return;\n\n        setLoading(true);\n        try {\n            const policyData = {\n                ...formData,\n                user_id: userId,\n                expiry_date: new Date(formData.expiry_date!),\n                policy_number: formData.policy_number || '',\n                insurer_name: formData.insurer_name || '',\n                premium_amount: formData.premium_amount || 0,\n                lob_type: formData.lob_type || 'GPA',\n                policy_docs: formData.policy_docs || [],\n            };\n\n            if (initialData?.id) {\n                await updateCommercialPolicy(initialData.id, policyData);\n            } else {\n                await addCommercialPolicy(policyData);\n            }\n\n            onSuccess();\n            onClose();\n        } catch (error) {\n            console.error('Error saving policy:', error);\n            setErrors(prev => ({ ...prev, submit: 'Failed to save policy. Please try again.' }));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleFileUpload = (url: string) => {\n        setFormData(prev => ({\n            ...prev,\n            policy_docs: [...(prev.policy_docs || []), url]\n        }));\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto\">\n            <div className=\"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n                <div className=\"flex items-center justify-between p-6 border-b sticky top-0 bg-white z-10\">\n                    <h2 className=\"text-xl font-bold text-gray-900\">\n                        {initialData ? 'Edit Commercial Policy' : 'Add New Commercial Policy'}\n                    </h2>\n                    <button onClick={onClose} className=\"text-gray-500 hover:text-gray-700\">\n                        <X className=\"w-6 h-6\" />\n                    </button>\n                </div>\n\n                <form onSubmit={handleSubmit} className=\"p-6 space-y-8\">\n                    {errors.submit && (\n                        <div className=\"bg-red-50 text-red-600 p-4 rounded-lg text-sm\">\n                            {errors.submit}\n                        </div>\n                    )}\n\n                    {/* Policy Details */}\n                    <section>\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Policy Details</h3>\n                        <div className=\"grid md:grid-cols-3 gap-6\">\n                            <FormInput\n                                label=\"LOB Type\"\n                                name=\"lob_type\"\n                                type=\"select\"\n                                value={formData.lob_type || 'GPA'}\n                                onChange={handleChange}\n                                options={[\n                                    { value: 'GPA', label: 'GPA' },\n                                    { value: 'Fire', label: 'Fire' },\n                                    { value: 'Other', label: 'Other' }\n                                ]}\n                                required\n                            />\n                            <FormInput\n                                label=\"Company Name\"\n                                name=\"company_name\"\n                                value={formData.company_name || ''}\n                                onChange={handleChange}\n                                placeholder=\"e.g. Acme Corp\"\n                            />\n                            <FormInput\n                                label=\"Policy Holder Name\"\n                                name=\"policy_holder_name\"\n                                value={formData.policy_holder_name || ''}\n                                onChange={handleChange}\n                                placeholder=\"e.g. John Doe\"\n                            />\n                            <FormInput\n                                label=\"Policy Number\"\n                                name=\"policy_number\"\n                                value={formData.policy_number || ''}\n                                onChange={handleChange}\n                                placeholder=\"Enter policy number\"\n                                error={errors.policy_number}\n                                required\n                            />\n                            <FormInput\n                                label=\"Insurer Name\"\n                                name=\"insurer_name\"\n                                type=\"select\"\n                                value={formData.insurer_name || ''}\n                                onChange={handleChange}\n                                options={INSURANCE_COMPANIES.map(c => ({ value: c, label: c }))}\n                                error={errors.insurer_name}\n                                required\n                            />\n                            <FormInput\n                                label=\"Sum Insured (â‚¹)\"\n                                name=\"sum_insured\"\n                                type=\"number\"\n                                value={formData.sum_insured || ''}\n                                onChange={handleChange}\n                                placeholder=\"e.g. 500000\"\n                            />\n                            <FormInput\n                                label=\"Premium Amount (â‚¹)\"\n                                name=\"premium_amount\"\n                                type=\"number\"\n                                value={formData.premium_amount || ''}\n                                onChange={handleChange}\n                                error={errors.premium_amount}\n                                required\n                            />\n                            <FormInput\n                                label=\"Expiry Date\"\n                                name=\"expiry_date\"\n                                type=\"date\"\n                                value={formatDateForInput(formData.expiry_date)}\n                                onChange={handleDateChange as any}\n                                required\n                            />\n                        </div>\n                    </section>\n\n                    {/* Documents */}\n                    <section>\n                        <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Documents</h3>\n                        <div className=\"grid md:grid-cols-3 gap-6\">\n                            <FileUpload\n                                label=\"Policy Document\"\n                                name=\"policy_docs\"\n                                bucket=\"policy-documents\"\n                                onUploadComplete={handleFileUpload}\n                                existingFile={formData.policy_docs && formData.policy_docs.length > 0 ? { url: formData.policy_docs[0], name: 'Policy Document' } : undefined}\n                            />\n                        </div>\n                    </section>\n\n                    <div className=\"flex justify-end space-x-4 pt-6 border-t\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50\"\n                            disabled={loading}\n                        >\n                            Cancel\n                        </button>\n                        <button\n                            type=\"submit\"\n                            className=\"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center\"\n                            disabled={loading}\n                        >\n                            {loading ? (\n                                <>\n                                    <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                                    Saving...\n                                </>\n                            ) : (\n                                <>\n                                    <Save className=\"w-4 h-4 mr-2\" />\n                                    Save Policy\n                                </>\n                            )}\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAVA;;;;;;;;;;AAuBe,SAAS,qBAAqB,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,SAAS,EAA6B;IAC/G,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kOAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,kOAAQ,EAAyB,CAAC;IAE9D,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,kOAAQ,EAA2B;QAC/D,UAAU,aAAa,YAAY;QACnC,cAAc,aAAa,gBAAgB;QAC3C,oBAAoB,aAAa,sBAAsB;QACvD,eAAe,aAAa,iBAAiB;QAC7C,cAAc,aAAa,gBAAgB;QAC3C,gBAAgB,aAAa,kBAAkB;QAC/C,aAAa,aAAa,eAAe;QACzC,aAAa,aAAa,cAAc,IAAI,KAAK,YAAY,WAAW,IAAI,IAAI,KAAK,IAAI,OAAO,WAAW,CAAC,IAAI,OAAO,WAAW,KAAK;QACvI,aAAa,aAAa,eAAe,EAAE;IAC/C;IAEA,gFAAgF;IAChF,IAAA,mOAAS,EAAC;QACN,IAAI,CAAC,aAAa;YACd,MAAM,QAAQ,IAAI;YAClB,MAAM,aAAa,IAAI,KAAK;YAC5B,WAAW,WAAW,CAAC,WAAW,WAAW,KAAK;YAClD,WAAW,OAAO,CAAC,WAAW,OAAO,KAAK,IAAI,eAAe;YAC7D,YAAY,CAAA,OAAQ,CAAC;oBACjB,GAAG,IAAI;oBACP,aAAa;gBACjB,CAAC;QACL;IACJ,GAAG;QAAC;KAAY;IAEhB,MAAM,eAAe,CAAC;QAClB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,MAAM;QAEtC,YAAY,CAAA,OAAQ,CAAC;gBACjB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE,SAAS,WAAW,OAAO,SAAS;YAChD,CAAC;QAED,IAAI,MAAM,CAAC,KAAK,EAAE;YACd,UAAU,CAAA;gBACN,MAAM,YAAY;oBAAE,GAAG,IAAI;gBAAC;gBAC5B,OAAO,SAAS,CAAC,KAAK;gBACtB,OAAO;YACX;QACJ;IACJ;IAEA,MAAM,mBAAmB,CAAC;QACtB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAA,OAAQ,CAAC;gBACjB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE,IAAI,KAAK;YACrB,CAAC;IACL;IAEA,MAAM,eAAe;QACjB,MAAM,YAAoC,CAAC;QAE3C,IAAI,CAAC,IAAA,0JAAoB,EAAC,SAAS,aAAa,IAAI,KAAK;YACrD,UAAU,aAAa,GAAG;QAC9B;QAEA,IAAI,CAAC,IAAA,2JAAqB,EAAC,SAAS,cAAc,IAAI,IAAI;YACtD,UAAU,cAAc,GAAG;QAC/B;QAEA,IAAI,CAAC,SAAS,YAAY,EAAE,UAAU,YAAY,GAAG;QACrD,IAAI,CAAC,SAAS,QAAQ,EAAE,UAAU,QAAQ,GAAG;QAE7C,UAAU;QACV,OAAO,OAAO,IAAI,CAAC,WAAW,MAAM,KAAK;IAC7C;IAEA,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAEhB,IAAI,CAAC,gBAAgB;QAErB,WAAW;QACX,IAAI;YACA,MAAM,aAAa;gBACf,GAAG,QAAQ;gBACX,SAAS;gBACT,aAAa,IAAI,KAAK,SAAS,WAAW;gBAC1C,eAAe,SAAS,aAAa,IAAI;gBACzC,cAAc,SAAS,YAAY,IAAI;gBACvC,gBAAgB,SAAS,cAAc,IAAI;gBAC3C,UAAU,SAAS,QAAQ,IAAI;gBAC/B,aAAa,SAAS,WAAW,IAAI,EAAE;YAC3C;YAEA,IAAI,aAAa,IAAI;gBACjB,MAAM,IAAA,oJAAsB,EAAC,YAAY,EAAE,EAAE;YACjD,OAAO;gBACH,MAAM,IAAA,iJAAmB,EAAC;YAC9B;YAEA;YACA;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,wBAAwB;YACtC,UAAU,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,QAAQ;gBAA2C,CAAC;QACtF,SAAU;YACN,WAAW;QACf;IACJ;IAEA,MAAM,mBAAmB,CAAC;QACtB,YAAY,CAAA,OAAQ,CAAC;gBACjB,GAAG,IAAI;gBACP,aAAa;uBAAK,KAAK,WAAW,IAAI,EAAE;oBAAG;iBAAI;YACnD,CAAC;IACL;IAEA,qBACI,+PAAC;QAAI,WAAU;kBACX,cAAA,+PAAC;YAAI,WAAU;;8BACX,+PAAC;oBAAI,WAAU;;sCACX,+PAAC;4BAAG,WAAU;sCACT,cAAc,2BAA2B;;;;;;sCAE9C,+PAAC;4BAAO,SAAS;4BAAS,WAAU;sCAChC,cAAA,+PAAC,kNAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAIrB,+PAAC;oBAAK,UAAU;oBAAc,WAAU;;wBACnC,OAAO,MAAM,kBACV,+PAAC;4BAAI,WAAU;sCACV,OAAO,MAAM;;;;;;sCAKtB,+PAAC;;8CACG,+PAAC;oCAAG,WAAU;8CAA2C;;;;;;8CACzD,+PAAC;oCAAI,WAAU;;sDACX,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,SAAS,QAAQ,IAAI;4CAC5B,UAAU;4CACV,SAAS;gDACL;oDAAE,OAAO;oDAAO,OAAO;gDAAM;gDAC7B;oDAAE,OAAO;oDAAQ,OAAO;gDAAO;gDAC/B;oDAAE,OAAO;oDAAS,OAAO;gDAAQ;6CACpC;4CACD,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,OAAO,SAAS,YAAY,IAAI;4CAChC,UAAU;4CACV,aAAY;;;;;;sDAEhB,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,OAAO,SAAS,kBAAkB,IAAI;4CACtC,UAAU;4CACV,aAAY;;;;;;sDAEhB,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,OAAO,SAAS,aAAa,IAAI;4CACjC,UAAU;4CACV,aAAY;4CACZ,OAAO,OAAO,aAAa;4CAC3B,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,SAAS,YAAY,IAAI;4CAChC,UAAU;4CACV,SAAS,wJAAmB,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;oDAAE,OAAO;oDAAG,OAAO;gDAAE,CAAC;4CAC7D,OAAO,OAAO,YAAY;4CAC1B,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,SAAS,WAAW,IAAI;4CAC/B,UAAU;4CACV,aAAY;;;;;;sDAEhB,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,SAAS,cAAc,IAAI;4CAClC,UAAU;4CACV,OAAO,OAAO,cAAc;4CAC5B,QAAQ;;;;;;sDAEZ,+PAAC,6JAAS;4CACN,OAAM;4CACN,MAAK;4CACL,MAAK;4CACL,OAAO,IAAA,mJAAkB,EAAC,SAAS,WAAW;4CAC9C,UAAU;4CACV,QAAQ;;;;;;;;;;;;;;;;;;sCAMpB,+PAAC;;8CACG,+PAAC;oCAAG,WAAU;8CAA2C;;;;;;8CACzD,+PAAC;oCAAI,WAAU;8CACX,cAAA,+PAAC,8JAAU;wCACP,OAAM;wCACN,MAAK;wCACL,QAAO;wCACP,kBAAkB;wCAClB,cAAc,SAAS,WAAW,IAAI,SAAS,WAAW,CAAC,MAAM,GAAG,IAAI;4CAAE,KAAK,SAAS,WAAW,CAAC,EAAE;4CAAE,MAAM;wCAAkB,IAAI;;;;;;;;;;;;;;;;;sCAKhJ,+PAAC;4BAAI,WAAU;;8CACX,+PAAC;oCACG,MAAK;oCACL,SAAS;oCACT,WAAU;oCACV,UAAU;8CACb;;;;;;8CAGD,+PAAC;oCACG,MAAK;oCACL,WAAU;oCACV,UAAU;8CAET,wBACG;;0DACI,+PAAC,6OAAO;gDAAC,WAAU;;;;;;4CAA8B;;qEAIrD;;0DACI,+PAAC,2NAAI;gDAAC,WAAU;;;;;;4CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUrE"}},
    {"offset": {"line": 2268, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/forms/LifePolicyForm.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { X, Save, Loader2 } from 'lucide-react';\nimport FormInput from './FormInput';\nimport FileUpload from './FileUpload';\nimport { addLifePolicy } from '@/lib/db';\nimport { INSURANCE_COMPANIES } from '@/lib/constants';\n\ninterface LifePolicyFormProps {\n    userId: string;\n    initialData?: any;\n    onClose: () => void;\n    onSuccess: () => void;\n}\n\nexport default function LifePolicyForm({ userId, initialData, onClose, onSuccess }: LifePolicyFormProps) {\n    const [loading, setLoading] = useState(false);\n    const [errors, setErrors] = useState<Record<string, string>>({});\n    const [formData, setFormData] = useState({\n        policy_number: initialData?.policy_number || '',\n        insurer_name: initialData?.insurer_name || '',\n        premium_amount: initialData?.premium_amount || 0,\n        sum_assured: initialData?.sum_assured || 0,\n        nominee_name: initialData?.nominee_name || '',\n        policy_start_date: initialData?.policy_start_date ? new Date(initialData.policy_start_date) : new Date(),\n        policy_end_date: initialData?.policy_end_date ? new Date(initialData.policy_end_date) : new Date(new Date().setFullYear(new Date().getFullYear() + 20)),\n        document_url: initialData?.document_url || '',\n    });\n\n    // Auto-calculate end date when start date changes (1 day before same date next year)\n    useEffect(() => {\n        if (formData.policy_start_date && !initialData) {\n            const startDate = new Date(formData.policy_start_date);\n            const endDate = new Date(startDate);\n            endDate.setFullYear(endDate.getFullYear() + 1);\n            endDate.setDate(endDate.getDate() - 1); // 1 day before\n            setFormData(prev => ({\n                ...prev,\n                policy_end_date: endDate\n            }));\n        }\n    }, [formData.policy_start_date, initialData]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n        const { name, value, type } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'number' ? Number(value) : value\n        }));\n    };\n\n    const handleDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({ ...prev, [name]: new Date(value) }));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        try {\n            await addLifePolicy({\n                ...formData,\n                user_id: userId,\n                status: 'Active'\n            });\n            onSuccess();\n        } catch (error) {\n            console.error('Error saving life policy:', error);\n            setErrors({ submit: 'Failed to save policy' });\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">Life Insurance Details</h3>\n\n            <div className=\"grid md:grid-cols-2 gap-6\">\n                <FormInput label=\"Policy Number\" name=\"policy_number\" value={formData.policy_number} onChange={handleChange} required />\n                <FormInput label=\"Policy Number\" name=\"policy_number\" value={formData.policy_number} onChange={handleChange} required />\n                <FormInput\n                    label=\"Insurer Name\"\n                    name=\"insurer_name\"\n                    type=\"select\"\n                    value={formData.insurer_name}\n                    onChange={handleChange}\n                    options={INSURANCE_COMPANIES.map(c => ({ value: c, label: c }))}\n                    required\n                />\n                <FormInput label=\"Premium Amount (â‚¹)\" name=\"premium_amount\" type=\"number\" value={formData.premium_amount} onChange={handleChange} required />\n                <FormInput label=\"Sum Assured (â‚¹)\" name=\"sum_assured\" type=\"number\" value={formData.sum_assured} onChange={handleChange} required />\n                <FormInput label=\"Nominee Name\" name=\"nominee_name\" value={formData.nominee_name} onChange={handleChange} required />\n                <FormInput label=\"Start Date\" name=\"policy_start_date\" type=\"date\" value={formData.policy_start_date.toISOString().split('T')[0]} onChange={handleDateChange as any} required />\n                <FormInput label=\"End Date\" name=\"policy_end_date\" type=\"date\" value={formData.policy_end_date.toISOString().split('T')[0]} onChange={handleDateChange as any} required />\n            </div>\n\n            <FileUpload\n                label=\"Policy Document\"\n                name=\"document_url\"\n                bucket=\"policy-documents\"\n                onUploadComplete={(url) => setFormData(prev => ({ ...prev, document_url: url }))}\n            />\n\n            <div className=\"flex justify-end space-x-4 pt-4 border-t\">\n                <button type=\"button\" onClick={onClose} className=\"px-4 py-2 border rounded-lg hover:bg-gray-50\">Cancel</button>\n                <button type=\"submit\" disabled={loading} className=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center\">\n                    {loading ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Save className=\"w-4 h-4 mr-2\" />}\n                    Save Policy\n                </button>\n            </div>\n        </form>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AAgBe,SAAS,eAAe,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,SAAS,EAAuB;IACnG,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kOAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,kOAAQ,EAAyB,CAAC;IAC9D,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,kOAAQ,EAAC;QACrC,eAAe,aAAa,iBAAiB;QAC7C,cAAc,aAAa,gBAAgB;QAC3C,gBAAgB,aAAa,kBAAkB;QAC/C,aAAa,aAAa,eAAe;QACzC,cAAc,aAAa,gBAAgB;QAC3C,mBAAmB,aAAa,oBAAoB,IAAI,KAAK,YAAY,iBAAiB,IAAI,IAAI;QAClG,iBAAiB,aAAa,kBAAkB,IAAI,KAAK,YAAY,eAAe,IAAI,IAAI,KAAK,IAAI,OAAO,WAAW,CAAC,IAAI,OAAO,WAAW,KAAK;QACnJ,cAAc,aAAa,gBAAgB;IAC/C;IAEA,qFAAqF;IACrF,IAAA,mOAAS,EAAC;QACN,IAAI,SAAS,iBAAiB,IAAI,CAAC,aAAa;YAC5C,MAAM,YAAY,IAAI,KAAK,SAAS,iBAAiB;YACrD,MAAM,UAAU,IAAI,KAAK;YACzB,QAAQ,WAAW,CAAC,QAAQ,WAAW,KAAK;YAC5C,QAAQ,OAAO,CAAC,QAAQ,OAAO,KAAK,IAAI,eAAe;YACvD,YAAY,CAAA,OAAQ,CAAC;oBACjB,GAAG,IAAI;oBACP,iBAAiB;gBACrB,CAAC;QACL;IACJ,GAAG;QAAC,SAAS,iBAAiB;QAAE;KAAY;IAE5C,MAAM,eAAe,CAAC;QAClB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,MAAM;QACtC,YAAY,CAAA,OAAQ,CAAC;gBACjB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE,SAAS,WAAW,OAAO,SAAS;YAChD,CAAC;IACL;IAEA,MAAM,mBAAmB,CAAC;QACtB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,KAAK,EAAE,IAAI,KAAK;YAAO,CAAC;IAC7D;IAEA,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,WAAW;QACX,IAAI;YACA,MAAM,IAAA,2IAAa,EAAC;gBAChB,GAAG,QAAQ;gBACX,SAAS;gBACT,QAAQ;YACZ;YACA;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,UAAU;gBAAE,QAAQ;YAAwB;QAChD,SAAU;YACN,WAAW;QACf;IACJ;IAEA,qBACI,+PAAC;QAAK,UAAU;QAAc,WAAU;;0BACpC,+PAAC;gBAAG,WAAU;0BAAsC;;;;;;0BAEpD,+PAAC;gBAAI,WAAU;;kCACX,+PAAC,6JAAS;wBAAC,OAAM;wBAAgB,MAAK;wBAAgB,OAAO,SAAS,aAAa;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCACrH,+PAAC,6JAAS;wBAAC,OAAM;wBAAgB,MAAK;wBAAgB,OAAO,SAAS,aAAa;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCACrH,+PAAC,6JAAS;wBACN,OAAM;wBACN,MAAK;wBACL,MAAK;wBACL,OAAO,SAAS,YAAY;wBAC5B,UAAU;wBACV,SAAS,wJAAmB,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;gCAAE,OAAO;gCAAG,OAAO;4BAAE,CAAC;wBAC7D,QAAQ;;;;;;kCAEZ,+PAAC,6JAAS;wBAAC,OAAM;wBAAqB,MAAK;wBAAiB,MAAK;wBAAS,OAAO,SAAS,cAAc;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCAC1I,+PAAC,6JAAS;wBAAC,OAAM;wBAAkB,MAAK;wBAAc,MAAK;wBAAS,OAAO,SAAS,WAAW;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCACjI,+PAAC,6JAAS;wBAAC,OAAM;wBAAe,MAAK;wBAAe,OAAO,SAAS,YAAY;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCAClH,+PAAC,6JAAS;wBAAC,OAAM;wBAAa,MAAK;wBAAoB,MAAK;wBAAO,OAAO,SAAS,iBAAiB,CAAC,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;wBAAE,UAAU;wBAAyB,QAAQ;;;;;;kCAC7K,+PAAC,6JAAS;wBAAC,OAAM;wBAAW,MAAK;wBAAkB,MAAK;wBAAO,OAAO,SAAS,eAAe,CAAC,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;wBAAE,UAAU;wBAAyB,QAAQ;;;;;;;;;;;;0BAG3K,+PAAC,8JAAU;gBACP,OAAM;gBACN,MAAK;gBACL,QAAO;gBACP,kBAAkB,CAAC,MAAQ,YAAY,CAAA,OAAQ,CAAC;4BAAE,GAAG,IAAI;4BAAE,cAAc;wBAAI,CAAC;;;;;;0BAGlF,+PAAC;gBAAI,WAAU;;kCACX,+PAAC;wBAAO,MAAK;wBAAS,SAAS;wBAAS,WAAU;kCAA+C;;;;;;kCACjG,+PAAC;wBAAO,MAAK;wBAAS,UAAU;wBAAS,WAAU;;4BAC9C,wBAAU,+PAAC,6OAAO;gCAAC,WAAU;;;;;qDAAiC,+PAAC,2NAAI;gCAAC,WAAU;;;;;;4BAAkB;;;;;;;;;;;;;;;;;;;AAMrH"}},
    {"offset": {"line": 2536, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/forms/TravelPolicyForm.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { X, Save, Loader2 } from 'lucide-react';\nimport FormInput from './FormInput';\nimport FileUpload from './FileUpload';\nimport { addTravelPolicy } from '@/lib/db';\nimport { INSURANCE_COMPANIES } from '@/lib/constants';\n\ninterface TravelPolicyFormProps {\n    userId: string;\n    initialData?: any;\n    onClose: () => void;\n    onSuccess: () => void;\n}\n\nexport default function TravelPolicyForm({ userId, initialData, onClose, onSuccess }: TravelPolicyFormProps) {\n    const [loading, setLoading] = useState(false);\n    const [errors, setErrors] = useState<Record<string, string>>({});\n    const [formData, setFormData] = useState({\n        policy_number: initialData?.policy_number || '',\n        insurer_name: initialData?.insurer_name || '',\n        premium_amount: initialData?.premium_amount || 0,\n        destination: initialData?.destination || '',\n        trip_type: initialData?.trip_type || 'Single Trip',\n        policy_start_date: initialData?.policy_start_date ? new Date(initialData.policy_start_date) : new Date(),\n        policy_end_date: initialData?.policy_end_date ? new Date(initialData.policy_end_date) : new Date(new Date().setDate(new Date().getDate() + 7)),\n        document_url: initialData?.document_url || '',\n    });\n\n    // Auto-calculate end date when start date changes (1 day before same date next year)\n    useEffect(() => {\n        if (formData.policy_start_date && !initialData) {\n            const startDate = new Date(formData.policy_start_date);\n            const endDate = new Date(startDate);\n            endDate.setFullYear(endDate.getFullYear() + 1);\n            endDate.setDate(endDate.getDate() - 1); // 1 day before\n            setFormData(prev => ({\n                ...prev,\n                policy_end_date: endDate\n            }));\n        }\n    }, [formData.policy_start_date, initialData]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n        const { name, value, type } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'number' ? Number(value) : value\n        }));\n    };\n\n    const handleDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({ ...prev, [name]: new Date(value) }));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        try {\n            await addTravelPolicy({\n                ...formData,\n                user_id: userId,\n                status: 'Active'\n            });\n            onSuccess();\n        } catch (error) {\n            console.error('Error saving travel policy:', error);\n            setErrors({ submit: 'Failed to save policy' });\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">Travel Insurance Details</h3>\n\n            <div className=\"grid md:grid-cols-2 gap-6\">\n                <FormInput label=\"Policy Number\" name=\"policy_number\" value={formData.policy_number} onChange={handleChange} required />\n                <FormInput\n                    label=\"Insurer Name\"\n                    name=\"insurer_name\"\n                    type=\"select\"\n                    value={formData.insurer_name}\n                    onChange={handleChange}\n                    options={INSURANCE_COMPANIES.map(c => ({ value: c, label: c }))}\n                    required\n                />\n                <FormInput label=\"Premium Amount (â‚¹)\" name=\"premium_amount\" type=\"number\" value={formData.premium_amount} onChange={handleChange} required />\n                <FormInput label=\"Destination\" name=\"destination\" value={formData.destination} onChange={handleChange} required />\n                <FormInput\n                    label=\"Trip Type\"\n                    name=\"trip_type\"\n                    type=\"select\"\n                    value={formData.trip_type}\n                    onChange={handleChange}\n                    options={[{ value: 'Single Trip', label: 'Single Trip' }, { value: 'Multi Trip', label: 'Multi Trip' }]}\n                    required\n                />\n                <FormInput label=\"Start Date\" name=\"policy_start_date\" type=\"date\" value={formData.policy_start_date.toISOString().split('T')[0]} onChange={handleDateChange as any} required />\n                <FormInput label=\"End Date\" name=\"policy_end_date\" type=\"date\" value={formData.policy_end_date.toISOString().split('T')[0]} onChange={handleDateChange as any} required />\n            </div>\n\n            <FileUpload\n                label=\"Policy Document\"\n                name=\"document_url\"\n                bucket=\"policy-documents\"\n                onUploadComplete={(url) => setFormData(prev => ({ ...prev, document_url: url }))}\n            />\n\n            <div className=\"flex justify-end space-x-4 pt-4 border-t\">\n                <button type=\"button\" onClick={onClose} className=\"px-4 py-2 border rounded-lg hover:bg-gray-50\">Cancel</button>\n                <button type=\"submit\" disabled={loading} className=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center\">\n                    {loading ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Save className=\"w-4 h-4 mr-2\" />}\n                    Save Policy\n                </button>\n            </div>\n        </form>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2803, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/forms/CyberPolicyForm.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { X, Save, Loader2 } from 'lucide-react';\nimport FormInput from './FormInput';\nimport FileUpload from './FileUpload';\nimport { addCyberPolicy } from '@/lib/db';\nimport { INSURANCE_COMPANIES } from '@/lib/constants';\n\ninterface CyberPolicyFormProps {\n    userId: string;\n    initialData?: any;\n    onClose: () => void;\n    onSuccess: () => void;\n}\n\nexport default function CyberPolicyForm({ userId, initialData, onClose, onSuccess }: CyberPolicyFormProps) {\n    const [loading, setLoading] = useState(false);\n    const [errors, setErrors] = useState<Record<string, string>>({});\n    const [formData, setFormData] = useState({\n        policy_number: initialData?.policy_number || '',\n        insurer_name: initialData?.insurer_name || '',\n        premium_amount: initialData?.premium_amount || 0,\n        sum_insured: initialData?.sum_insured || 0,\n        cyber_risk_type: initialData?.cyber_risk_type || 'Personal',\n        policy_start_date: initialData?.policy_start_date ? new Date(initialData.policy_start_date) : new Date(),\n        policy_end_date: initialData?.policy_end_date ? new Date(initialData.policy_end_date) : new Date(new Date().setFullYear(new Date().getFullYear() + 1)),\n        document_url: initialData?.document_url || '',\n    });\n\n    // Auto-calculate end date when start date changes (1 day before same date next year)\n    useEffect(() => {\n        if (formData.policy_start_date && !initialData) {\n            const startDate = new Date(formData.policy_start_date);\n            const endDate = new Date(startDate);\n            endDate.setFullYear(endDate.getFullYear() + 1);\n            endDate.setDate(endDate.getDate() - 1); // 1 day before\n            setFormData(prev => ({\n                ...prev,\n                policy_end_date: endDate\n            }));\n        }\n    }, [formData.policy_start_date, initialData]);\n\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement>) => {\n        const { name, value, type } = e.target;\n        setFormData(prev => ({\n            ...prev,\n            [name]: type === 'number' ? Number(value) : value\n        }));\n    };\n\n    const handleDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const { name, value } = e.target;\n        setFormData(prev => ({ ...prev, [name]: new Date(value) }));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setLoading(true);\n        try {\n            await addCyberPolicy({\n                ...formData,\n                user_id: userId,\n                status: 'Active'\n            });\n            onSuccess();\n        } catch (error) {\n            console.error('Error saving cyber policy:', error);\n            setErrors({ submit: 'Failed to save policy' });\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">Cyber Insurance Details</h3>\n\n            <div className=\"grid md:grid-cols-2 gap-6\">\n                <FormInput label=\"Policy Number\" name=\"policy_number\" value={formData.policy_number} onChange={handleChange} required />\n                <FormInput label=\"Policy Number\" name=\"policy_number\" value={formData.policy_number} onChange={handleChange} required />\n                <FormInput\n                    label=\"Insurer Name\"\n                    name=\"insurer_name\"\n                    type=\"select\"\n                    value={formData.insurer_name}\n                    onChange={handleChange}\n                    options={INSURANCE_COMPANIES.map(c => ({ value: c, label: c }))}\n                    required\n                />\n                <FormInput label=\"Premium Amount (â‚¹)\" name=\"premium_amount\" type=\"number\" value={formData.premium_amount} onChange={handleChange} required />\n                <FormInput label=\"Sum Insured (â‚¹)\" name=\"sum_insured\" type=\"number\" value={formData.sum_insured} onChange={handleChange} required />\n                <FormInput\n                    label=\"Risk Type\"\n                    name=\"cyber_risk_type\"\n                    type=\"select\"\n                    value={formData.cyber_risk_type}\n                    onChange={handleChange}\n                    options={[{ value: 'Personal', label: 'Personal' }, { value: 'Business', label: 'Business' }]}\n                    required\n                />\n                <FormInput label=\"Start Date\" name=\"policy_start_date\" type=\"date\" value={formData.policy_start_date.toISOString().split('T')[0]} onChange={handleDateChange as any} required />\n                <FormInput label=\"End Date\" name=\"policy_end_date\" type=\"date\" value={formData.policy_end_date.toISOString().split('T')[0]} onChange={handleDateChange as any} required />\n            </div>\n\n            <FileUpload\n                label=\"Policy Document\"\n                name=\"document_url\"\n                bucket=\"policy-documents\"\n                onUploadComplete={(url) => setFormData(prev => ({ ...prev, document_url: url }))}\n            />\n\n            <div className=\"flex justify-end space-x-4 pt-4 border-t\">\n                <button type=\"button\" onClick={onClose} className=\"px-4 py-2 border rounded-lg hover:bg-gray-50\">Cancel</button>\n                <button type=\"submit\" disabled={loading} className=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center\">\n                    {loading ? <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" /> : <Save className=\"w-4 h-4 mr-2\" />}\n                    Save Policy\n                </button>\n            </div>\n        </form>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AAPA;;;;;;;;AAgBe,SAAS,gBAAgB,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,EAAE,SAAS,EAAwB;IACrG,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kOAAQ,EAAC;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,kOAAQ,EAAyB,CAAC;IAC9D,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,kOAAQ,EAAC;QACrC,eAAe,aAAa,iBAAiB;QAC7C,cAAc,aAAa,gBAAgB;QAC3C,gBAAgB,aAAa,kBAAkB;QAC/C,aAAa,aAAa,eAAe;QACzC,iBAAiB,aAAa,mBAAmB;QACjD,mBAAmB,aAAa,oBAAoB,IAAI,KAAK,YAAY,iBAAiB,IAAI,IAAI;QAClG,iBAAiB,aAAa,kBAAkB,IAAI,KAAK,YAAY,eAAe,IAAI,IAAI,KAAK,IAAI,OAAO,WAAW,CAAC,IAAI,OAAO,WAAW,KAAK;QACnJ,cAAc,aAAa,gBAAgB;IAC/C;IAEA,qFAAqF;IACrF,IAAA,mOAAS,EAAC;QACN,IAAI,SAAS,iBAAiB,IAAI,CAAC,aAAa;YAC5C,MAAM,YAAY,IAAI,KAAK,SAAS,iBAAiB;YACrD,MAAM,UAAU,IAAI,KAAK;YACzB,QAAQ,WAAW,CAAC,QAAQ,WAAW,KAAK;YAC5C,QAAQ,OAAO,CAAC,QAAQ,OAAO,KAAK,IAAI,eAAe;YACvD,YAAY,CAAA,OAAQ,CAAC;oBACjB,GAAG,IAAI;oBACP,iBAAiB;gBACrB,CAAC;QACL;IACJ,GAAG;QAAC,SAAS,iBAAiB;QAAE;KAAY;IAE5C,MAAM,eAAe,CAAC;QAClB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,MAAM;QACtC,YAAY,CAAA,OAAQ,CAAC;gBACjB,GAAG,IAAI;gBACP,CAAC,KAAK,EAAE,SAAS,WAAW,OAAO,SAAS;YAChD,CAAC;IACL;IAEA,MAAM,mBAAmB,CAAC;QACtB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM;QAChC,YAAY,CAAA,OAAQ,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,KAAK,EAAE,IAAI,KAAK;YAAO,CAAC;IAC7D;IAEA,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,WAAW;QACX,IAAI;YACA,MAAM,IAAA,4IAAc,EAAC;gBACjB,GAAG,QAAQ;gBACX,SAAS;gBACT,QAAQ;YACZ;YACA;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,UAAU;gBAAE,QAAQ;YAAwB;QAChD,SAAU;YACN,WAAW;QACf;IACJ;IAEA,qBACI,+PAAC;QAAK,UAAU;QAAc,WAAU;;0BACpC,+PAAC;gBAAG,WAAU;0BAAsC;;;;;;0BAEpD,+PAAC;gBAAI,WAAU;;kCACX,+PAAC,6JAAS;wBAAC,OAAM;wBAAgB,MAAK;wBAAgB,OAAO,SAAS,aAAa;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCACrH,+PAAC,6JAAS;wBAAC,OAAM;wBAAgB,MAAK;wBAAgB,OAAO,SAAS,aAAa;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCACrH,+PAAC,6JAAS;wBACN,OAAM;wBACN,MAAK;wBACL,MAAK;wBACL,OAAO,SAAS,YAAY;wBAC5B,UAAU;wBACV,SAAS,wJAAmB,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;gCAAE,OAAO;gCAAG,OAAO;4BAAE,CAAC;wBAC7D,QAAQ;;;;;;kCAEZ,+PAAC,6JAAS;wBAAC,OAAM;wBAAqB,MAAK;wBAAiB,MAAK;wBAAS,OAAO,SAAS,cAAc;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCAC1I,+PAAC,6JAAS;wBAAC,OAAM;wBAAkB,MAAK;wBAAc,MAAK;wBAAS,OAAO,SAAS,WAAW;wBAAE,UAAU;wBAAc,QAAQ;;;;;;kCACjI,+PAAC,6JAAS;wBACN,OAAM;wBACN,MAAK;wBACL,MAAK;wBACL,OAAO,SAAS,eAAe;wBAC/B,UAAU;wBACV,SAAS;4BAAC;gCAAE,OAAO;gCAAY,OAAO;4BAAW;4BAAG;gCAAE,OAAO;gCAAY,OAAO;4BAAW;yBAAE;wBAC7F,QAAQ;;;;;;kCAEZ,+PAAC,6JAAS;wBAAC,OAAM;wBAAa,MAAK;wBAAoB,MAAK;wBAAO,OAAO,SAAS,iBAAiB,CAAC,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;wBAAE,UAAU;wBAAyB,QAAQ;;;;;;kCAC7K,+PAAC,6JAAS;wBAAC,OAAM;wBAAW,MAAK;wBAAkB,MAAK;wBAAO,OAAO,SAAS,eAAe,CAAC,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;wBAAE,UAAU;wBAAyB,QAAQ;;;;;;;;;;;;0BAG3K,+PAAC,8JAAU;gBACP,OAAM;gBACN,MAAK;gBACL,QAAO;gBACP,kBAAkB,CAAC,MAAQ,YAAY,CAAA,OAAQ,CAAC;4BAAE,GAAG,IAAI;4BAAE,cAAc;wBAAI,CAAC;;;;;;0BAGlF,+PAAC;gBAAI,WAAU;;kCACX,+PAAC;wBAAO,MAAK;wBAAS,SAAS;wBAAS,WAAU;kCAA+C;;;;;;kCACjG,+PAAC;wBAAO,MAAK;wBAAS,UAAU;wBAAS,WAAU;;4BAC9C,wBAAU,+PAAC,6OAAO;gCAAC,WAAU;;;;;qDAAiC,+PAAC,2NAAI;gCAAC,WAAU;;;;;;4BAAkB;;;;;;;;;;;;;;;;;;;AAMrH"}},
    {"offset": {"line": 3082, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/policies/AddPolicyModal.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState } from 'react';\nimport { X, Car, Heart, Briefcase, ChevronRight } from 'lucide-react';\nimport MotorPolicyForm from '@/components/forms/MotorPolicyForm';\nimport HealthPolicyForm from '@/components/forms/HealthPolicyForm';\nimport CommercialPolicyForm from '@/components/forms/CommercialPolicyForm';\n\nimport LifePolicyForm from '@/components/forms/LifePolicyForm';\nimport TravelPolicyForm from '@/components/forms/TravelPolicyForm';\nimport CyberPolicyForm from '@/components/forms/CyberPolicyForm';\n\ninterface AddPolicyModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    userId: string;\n    onSuccess: () => void;\n    initialType?: PolicyType;\n}\n\nexport type PolicyType = 'Motor' | 'Health' | 'Commercial' | 'Life' | 'Travel' | 'Cyber';\n\nexport default function AddPolicyModal({ isOpen, onClose, userId, onSuccess, initialType = undefined }: AddPolicyModalProps) {\n    const [selectedType, setSelectedType] = useState<PolicyType | undefined>(initialType);\n\n    // Reset selected type when modal opens/closes or initialType changes\n    React.useEffect(() => {\n        if (isOpen) {\n            setSelectedType(initialType);\n        }\n    }, [isOpen, initialType]);\n\n    if (!isOpen) return null;\n\n    const handleSuccess = () => {\n        onSuccess();\n        onClose();\n        setSelectedType(undefined);\n    };\n\n    const renderForm = () => {\n        switch (selectedType) {\n            case 'Motor':\n                return <MotorPolicyForm userId={userId} onClose={onClose} onSuccess={handleSuccess} />;\n            case 'Health':\n                return <HealthPolicyForm userId={userId} onClose={onClose} onSuccess={handleSuccess} />;\n            case 'Commercial':\n                return <CommercialPolicyForm userId={userId} onClose={onClose} onSuccess={handleSuccess} />;\n            case 'Life':\n                return <LifePolicyForm userId={userId} onClose={onClose} onSuccess={handleSuccess} />;\n            case 'Travel':\n                return <TravelPolicyForm userId={userId} onClose={onClose} onSuccess={handleSuccess} />;\n            case 'Cyber':\n                return <CyberPolicyForm userId={userId} onClose={onClose} onSuccess={handleSuccess} />;\n            default:\n                return null;\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm\">\n            <div className=\"bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n                {selectedType ? (\n                    <div>\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-100\">\n                            <div className=\"flex items-center gap-2\">\n                                <button\n                                    onClick={() => setSelectedType(undefined)}\n                                    className=\"text-sm text-gray-500 hover:text-gray-900\"\n                                >\n                                    Select Type\n                                </button>\n                                <ChevronRight className=\"w-4 h-4 text-gray-400\" />\n                                <h3 className=\"text-lg font-bold text-gray-900\">Add {selectedType} Policy</h3>\n                            </div>\n                            <button onClick={onClose} className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\">\n                                <X className=\"w-5 h-5 text-gray-500\" />\n                            </button>\n                        </div>\n                        <div className=\"p-6\">\n                            {renderForm()}\n                        </div>\n                    </div>\n                ) : (\n                    <div className=\"p-8\">\n                        <div className=\"flex items-center justify-between mb-8\">\n                            <div>\n                                <h2 className=\"text-2xl font-bold text-gray-900\">Add New Policy</h2>\n                                <p className=\"text-gray-500 mt-1\">Select the type of policy you want to add</p>\n                            </div>\n                            <button onClick={onClose} className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\">\n                                <X className=\"w-5 h-5 text-gray-500\" />\n                            </button>\n                        </div>\n\n                        <div className=\"grid gap-4\">\n                            <button\n                                onClick={() => setSelectedType('Motor')}\n                                className=\"flex items-center p-4 border border-gray-200 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-all group text-left\"\n                            >\n                                <div className=\"p-3 bg-blue-100 text-blue-600 rounded-lg group-hover:bg-blue-200 transition-colors\">\n                                    <Car className=\"w-6 h-6\" />\n                                </div>\n                                <div className=\"ml-4\">\n                                    <h3 className=\"font-semibold text-gray-900 group-hover:text-blue-700\">Motor Insurance</h3>\n                                    <p className=\"text-sm text-gray-500\">Car, Bike, and other vehicle policies</p>\n                                </div>\n                                <ChevronRight className=\"w-5 h-5 text-gray-300 ml-auto group-hover:text-blue-500\" />\n                            </button>\n\n                            <button\n                                onClick={() => setSelectedType('Health')}\n                                className=\"flex items-center p-4 border border-gray-200 rounded-xl hover:border-pink-500 hover:bg-pink-50 transition-all group text-left\"\n                            >\n                                <div className=\"p-3 bg-pink-100 text-pink-600 rounded-lg group-hover:bg-pink-200 transition-colors\">\n                                    <Heart className=\"w-6 h-6\" />\n                                </div>\n                                <div className=\"ml-4\">\n                                    <h3 className=\"font-semibold text-gray-900 group-hover:text-pink-700\">Health Insurance</h3>\n                                    <p className=\"text-sm text-gray-500\">Individual and Family Floater plans</p>\n                                </div>\n                                <ChevronRight className=\"w-5 h-5 text-gray-300 ml-auto group-hover:text-pink-500\" />\n                            </button>\n\n                            <button\n                                onClick={() => setSelectedType('Commercial')}\n                                className=\"flex items-center p-4 border border-gray-200 rounded-xl hover:border-purple-500 hover:bg-purple-50 transition-all group text-left\"\n                            >\n                                <div className=\"p-3 bg-purple-100 text-purple-600 rounded-lg group-hover:bg-purple-200 transition-colors\">\n                                    <Briefcase className=\"w-6 h-6\" />\n                                </div>\n                                <div className=\"ml-4\">\n                                    <h3 className=\"font-semibold text-gray-900 group-hover:text-purple-700\">Commercial Insurance</h3>\n                                    <p className=\"text-sm text-gray-500\">Fire, Marine, and Liability policies</p>\n                                </div>\n                                <ChevronRight className=\"w-5 h-5 text-gray-300 ml-auto group-hover:text-purple-500\" />\n                            </button>\n\n                            <button\n                                onClick={() => setSelectedType('Life')}\n                                className=\"flex items-center p-4 border border-gray-200 rounded-xl hover:border-pink-500 hover:bg-pink-50 transition-all group text-left\"\n                            >\n                                <div className=\"p-3 bg-pink-100 text-pink-600 rounded-lg group-hover:bg-pink-200 transition-colors\">\n                                    <Heart className=\"w-6 h-6\" />\n                                </div>\n                                <div className=\"ml-4\">\n                                    <h3 className=\"font-semibold text-gray-900 group-hover:text-pink-700\">Life Insurance</h3>\n                                    <p className=\"text-sm text-gray-500\">Term life and endowment plans</p>\n                                </div>\n                                <ChevronRight className=\"w-5 h-5 text-gray-300 ml-auto group-hover:text-pink-500\" />\n                            </button>\n\n                            <button\n                                onClick={() => setSelectedType('Travel')}\n                                className=\"flex items-center p-4 border border-gray-200 rounded-xl hover:border-orange-500 hover:bg-orange-50 transition-all group text-left\"\n                            >\n                                <div className=\"p-3 bg-orange-100 text-orange-600 rounded-lg group-hover:bg-orange-200 transition-colors\">\n                                    <Briefcase className=\"w-6 h-6\" />\n                                </div>\n                                <div className=\"ml-4\">\n                                    <h3 className=\"font-semibold text-gray-900 group-hover:text-orange-700\">Travel Insurance</h3>\n                                    <p className=\"text-sm text-gray-500\">Domestic and International travel</p>\n                                </div>\n                                <ChevronRight className=\"w-5 h-5 text-gray-300 ml-auto group-hover:text-orange-500\" />\n                            </button>\n\n                            <button\n                                onClick={() => setSelectedType('Cyber')}\n                                className=\"flex items-center p-4 border border-gray-200 rounded-xl hover:border-indigo-500 hover:bg-indigo-50 transition-all group text-left\"\n                            >\n                                <div className=\"p-3 bg-indigo-100 text-indigo-600 rounded-lg group-hover:bg-indigo-200 transition-colors\">\n                                    <Briefcase className=\"w-6 h-6\" />\n                                </div>\n                                <div className=\"ml-4\">\n                                    <h3 className=\"font-semibold text-gray-900 group-hover:text-indigo-700\">Cyber Insurance</h3>\n                                    <p className=\"text-sm text-gray-500\">Protection against digital threats</p>\n                                </div>\n                                <ChevronRight className=\"w-5 h-5 text-gray-300 ml-auto group-hover:text-indigo-500\" />\n                            </button>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3689, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/components/policies/EditPolicyModal.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { X } from 'lucide-react';\nimport MotorPolicyForm from '../forms/MotorPolicyForm';\nimport HealthPolicyForm from '../forms/HealthPolicyForm';\nimport CommercialPolicyForm from '../forms/CommercialPolicyForm';\nimport TravelPolicyForm from '../forms/TravelPolicyForm';\nimport LifePolicyForm from '../forms/LifePolicyForm';\nimport CyberPolicyForm from '../forms/CyberPolicyForm';\n\ninterface EditPolicyModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    policy: any;\n    onSuccess?: () => void;\n}\n\nexport default function EditPolicyModal({ isOpen, onClose, policy, onSuccess }: EditPolicyModalProps) {\n    const [saving, setSaving] = useState(false);\n\n    if (!isOpen || !policy) return null;\n\n    const policyType = policy.type || 'Motor';\n\n    const handleSuccess = () => {\n        if (onSuccess) onSuccess();\n        onClose();\n    };\n\n    return (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col\">\n                {/* Header */}\n                <div className=\"flex items-center justify-between px-6 py-4 border-b border-gray-100\">\n                    <h2 className=\"text-xl font-bold text-gray-900\">Edit {policyType} Policy</h2>\n                    <button\n                        onClick={onClose}\n                        className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n                        disabled={saving}\n                    >\n                        <X className=\"w-5 h-5 text-gray-500\" />\n                    </button>\n                </div>\n\n                {/* Form Content */}\n                <div className=\"flex-1 overflow-y-auto px-6 py-4\">\n                    {policyType === 'Motor' && (\n                        <MotorPolicyForm\n                            userId={policy.user_id}\n                            onSuccess={handleSuccess}\n                            onClose={onClose}\n                            initialData={policy}\n                        />\n                    )}\n                    {policyType === 'Health' && (\n                        <HealthPolicyForm\n                            userId={policy.user_id}\n                            onSuccess={handleSuccess}\n                            onClose={onClose}\n                            initialData={policy}\n                        />\n                    )}\n                    {policyType === 'Commercial' && (\n                        <CommercialPolicyForm\n                            userId={policy.user_id}\n                            onSuccess={handleSuccess}\n                            onClose={onClose}\n                            initialData={policy}\n                        />\n                    )}\n                    {policyType === 'Travel' && (\n                        <TravelPolicyForm\n                            userId={policy.user_id}\n                            onSuccess={handleSuccess}\n                            onClose={onClose}\n                            initialData={policy}\n                        />\n                    )}\n                    {policyType === 'Life' && (\n                        <LifePolicyForm\n                            userId={policy.user_id}\n                            onSuccess={handleSuccess}\n                            onClose={onClose}\n                            initialData={policy}\n                        />\n                    )}\n                    {policyType === 'Cyber' && (\n                        <CyberPolicyForm\n                            userId={policy.user_id}\n                            onSuccess={handleSuccess}\n                            onClose={onClose}\n                            initialData={policy}\n                        />\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;;;;;;;;;;AAkBe,SAAS,gBAAgB,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAwB;IAChG,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,kOAAQ,EAAC;IAErC,IAAI,CAAC,UAAU,CAAC,QAAQ,OAAO;IAE/B,MAAM,aAAa,OAAO,IAAI,IAAI;IAElC,MAAM,gBAAgB;QAClB,IAAI,WAAW;QACf;IACJ;IAEA,qBACI,+PAAC;QAAI,WAAU;kBACX,cAAA,+PAAC;YAAI,WAAU;;8BAEX,+PAAC;oBAAI,WAAU;;sCACX,+PAAC;4BAAG,WAAU;;gCAAkC;gCAAM;gCAAW;;;;;;;sCACjE,+PAAC;4BACG,SAAS;4BACT,WAAU;4BACV,UAAU;sCAEV,cAAA,+PAAC,kNAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAKrB,+PAAC;oBAAI,WAAU;;wBACV,eAAe,yBACZ,+PAAC,mKAAe;4BACZ,QAAQ,OAAO,OAAO;4BACtB,WAAW;4BACX,SAAS;4BACT,aAAa;;;;;;wBAGpB,eAAe,0BACZ,+PAAC,oKAAgB;4BACb,QAAQ,OAAO,OAAO;4BACtB,WAAW;4BACX,SAAS;4BACT,aAAa;;;;;;wBAGpB,eAAe,8BACZ,+PAAC,wKAAoB;4BACjB,QAAQ,OAAO,OAAO;4BACtB,WAAW;4BACX,SAAS;4BACT,aAAa;;;;;;wBAGpB,eAAe,0BACZ,+PAAC,oKAAgB;4BACb,QAAQ,OAAO,OAAO;4BACtB,WAAW;4BACX,SAAS;4BACT,aAAa;;;;;;wBAGpB,eAAe,wBACZ,+PAAC,kKAAc;4BACX,QAAQ,OAAO,OAAO;4BACtB,WAAW;4BACX,SAAS;4BACT,aAAa;;;;;;wBAGpB,eAAe,yBACZ,+PAAC,mKAAe;4BACZ,QAAQ,OAAO,OAAO;4BACtB,WAAW;4BACX,SAAS;4BACT,aAAa;;;;;;;;;;;;;;;;;;;;;;;AAOzC"}},
    {"offset": {"line": 3847, "column": 0}, "map": {"version":3,"sources":["file:///Users/apple/OneSingleView/app/%28customer%29/policies/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, Suspense } from 'react';\nimport { useSearchParams } from 'next/navigation';\nimport { useAuth } from '@/hooks/useAuth';\nimport {\n    getUserMotorPolicies,\n    getUserHealthPolicies,\n    getUserCommercialPolicies,\n} from '@/lib/db';\nimport { User, MotorPolicy, HealthPolicy, CommercialPolicy } from '@/types';\nimport { calculatePolicyStatus, formatCurrency } from '@/lib/utils';\nimport { Car, Heart, Briefcase, Search, Filter, Plus, Pencil } from 'lucide-react';\nimport Link from 'next/link';\nimport AddPolicyModal from '@/components/policies/AddPolicyModal';\nimport EditPolicyModal from '@/components/policies/EditPolicyModal';\n\nfunction PoliciesContent() {\n    const searchParams = useSearchParams();\n    const initialQuery = searchParams.get('search') || '';\n    const { user } = useAuth();\n\n    const [loading, setLoading] = useState(true);\n    const [searchQuery, setSearchQuery] = useState(initialQuery);\n    const [allPolicies, setAllPolicies] = useState<(MotorPolicy | HealthPolicy | CommercialPolicy)[]>([]);\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [selectedPolicy, setSelectedPolicy] = useState<any>(null);\n\n    const refreshData = async () => {\n        if (!user) return;\n        setLoading(true);\n        try {\n            const [motor, gmc, commercial] = await Promise.all([\n                getUserMotorPolicies(user.id),\n                getUserHealthPolicies(user.id),\n                getUserCommercialPolicies(user.id),\n            ]);\n\n            // Add type identifier to each policy\n            const motorTyped = motor.map(p => ({ ...p, type: 'Motor' }));\n            const gmcTyped = gmc.map(p => ({ ...p, type: 'Health' }));\n            const commercialTyped = commercial.map(p => ({ ...p, type: 'Commercial' }));\n\n            setAllPolicies([...motorTyped, ...gmcTyped, ...commercialTyped]);\n        } catch (error) {\n            console.error('Error reloading policies:', error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    useEffect(() => {\n        if (user) {\n            refreshData();\n        }\n    }, [user]);\n\n    // Filter logic\n    const filteredPolicies = allPolicies.filter(policy => {\n        const matchesSearch = searchQuery === '' ||\n            policy.policy_number.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            policy.insurer_name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            ('vehicle_number' in policy && (policy as MotorPolicy).vehicle_number.toLowerCase().includes(searchQuery.toLowerCase()));\n\n        return matchesSearch;\n    });\n\n    if (loading) {\n        return (\n            <div className=\"flex items-center justify-center h-64\">\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600\"></div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                <div>\n                    <h1 className=\"text-2xl font-bold text-gray-900\">All Policies</h1>\n                    <p className=\"text-gray-500\">Manage and view all your insurance policies</p>\n                </div>\n\n                <div className=\"flex items-center gap-3\">\n                    <div className=\"relative\">\n                        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n                        <input\n                            type=\"text\"\n                            placeholder=\"Search policies...\"\n                            value={searchQuery}\n                            onChange={(e) => setSearchQuery(e.target.value)}\n                            className=\"pl-9 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-primary-500 focus:border-primary-500\"\n                        />\n                    </div>\n                    <button\n                        onClick={() => setIsModalOpen(true)}\n                        className=\"btn btn-primary flex items-center gap-2\"\n                    >\n                        <Plus className=\"w-4 h-4\" />\n                        Add Policy\n                    </button>\n                </div>\n            </div>\n\n            {filteredPolicies.length === 0 ? (\n                <div className=\"text-center py-12 bg-white rounded-xl border border-gray-200 border-dashed\">\n                    <div className=\"w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-3\">\n                        <Search className=\"w-6 h-6 text-gray-400\" />\n                    </div>\n                    <h3 className=\"text-lg font-medium text-gray-900\">No policies found</h3>\n                    <p className=\"text-gray-500 mt-1\">Try adjusting your search or add a new policy</p>\n                </div>\n            ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                    {filteredPolicies.map((policy: any) => {\n                        const isMotor = policy.type === 'Motor';\n                        const isHealth = policy.type === 'Health';\n                        const Icon = isMotor ? Car : isHealth ? Heart : Briefcase;\n                        const colorClass = isMotor ? 'text-blue-600 bg-blue-50' : isHealth ? 'text-green-600 bg-green-50' : 'text-purple-600 bg-purple-50';\n                        const expiryDate = new Date(isHealth || policy.type === 'Commercial' ? policy.expiry_date : policy.policy_end_date);\n                        const status = calculatePolicyStatus(expiryDate);\n\n                        return (\n                            <div\n                                key={policy.id}\n                                className=\"bg-white rounded-xl border border-gray-200 hover:border-primary-300 hover:shadow-md transition-all p-5 relative\"\n                            >\n                                {/* Edit Button */}\n                                <button\n                                    onClick={(e) => {\n                                        e.stopPropagation();\n                                        setSelectedPolicy(policy);\n                                        setIsEditModalOpen(true);\n                                    }}\n                                    className=\"absolute top-4 right-4 p-2 text-gray-400 hover:text-primary-600 hover:bg-primary-50 rounded-lg transition-colors z-10\"\n                                    title=\"Edit Policy\"\n                                >\n                                    <Pencil className=\"w-4 h-4\" />\n                                </button>\n\n                                {/* Clickable area for viewing */}\n                                <Link\n                                    href={`/policies/${isMotor ? 'motor' : isHealth ? 'health' : 'commercial'}/${policy.id}`}\n                                    className=\"block\"\n                                >\n                                    <div className=\"flex justify-between items-start mb-4 pr-8\">\n                                        <div className={`p-2 rounded-lg ${colorClass}`}>\n                                            <Icon className=\"w-6 h-6\" />\n                                        </div>\n                                        <span className={`px-2.5 py-0.5 rounded-full text-xs font-medium ${status === 'Active' ? 'bg-green-100 text-green-800' :\n                                            status === 'Expiring Soon' ? 'bg-yellow-100 text-yellow-800' :\n                                                'bg-red-100 text-red-800'\n                                            }`}>\n                                            {status}\n                                        </span>\n                                    </div>\n\n                                    <h3 className=\"font-bold text-gray-900 mb-1\">{policy.insurer_name}</h3>\n                                    <p className=\"text-sm text-gray-500 mb-1\">{policy.policy_number}</p>\n                                    <p className=\"text-xs font-medium text-gray-600 mb-3\">{policy.type} Insurance</p>\n\n                                    <div className=\"space-y-2 text-sm\">\n                                        <div className=\"flex justify-between\">\n                                            <span className=\"text-gray-500\">Premium</span>\n                                            <span className=\"font-medium\">{formatCurrency(policy.premium_amount)}</span>\n                                        </div>\n                                        <div className=\"flex justify-between\">\n                                            <span className=\"text-gray-500\">Valid Till</span>\n                                            <span className=\"font-medium\">{expiryDate.toLocaleDateString()}</span>\n                                        </div>\n                                        {isMotor && (\n                                            <div className=\"flex justify-between\">\n                                                <span className=\"text-gray-500\">Vehicle</span>\n                                                <span className=\"font-medium\">{(policy as MotorPolicy).vehicle_number}</span>\n                                            </div>\n                                        )}\n                                    </div>\n                                </Link>\n                            </div>\n                        );\n                    })}\n                </div>\n            )}\n\n            <AddPolicyModal\n                isOpen={isModalOpen}\n                onClose={() => setIsModalOpen(false)}\n                userId={user?.id || ''}\n                onSuccess={refreshData}\n            />\n\n            <EditPolicyModal\n                isOpen={isEditModalOpen}\n                onClose={() => {\n                    setIsEditModalOpen(false);\n                    setSelectedPolicy(null);\n                }}\n                policy={selectedPolicy}\n                onSuccess={refreshData}\n            />\n        </div>\n    );\n}\n\nexport default function PoliciesPage() {\n    return (\n        <Suspense fallback={<div className=\"p-8 text-center\">Loading...</div>}>\n            <PoliciesContent />\n        </Suspense>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAMA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAfA;;;;;;;;;;;AAiBA,SAAS;IACL,MAAM,eAAe,IAAA,sKAAe;IACpC,MAAM,eAAe,aAAa,GAAG,CAAC,aAAa;IACnD,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,4IAAO;IAExB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,kOAAQ,EAAC;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,kOAAQ,EAAC;IAC/C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,kOAAQ,EAAoD,EAAE;IACpG,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,kOAAQ,EAAC;IAC/C,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,kOAAQ,EAAC;IACvD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,kOAAQ,EAAM;IAE1D,MAAM,cAAc;QAChB,IAAI,CAAC,MAAM;QACX,WAAW;QACX,IAAI;YACA,MAAM,CAAC,OAAO,KAAK,WAAW,GAAG,MAAM,QAAQ,GAAG,CAAC;gBAC/C,IAAA,kJAAoB,EAAC,KAAK,EAAE;gBAC5B,IAAA,mJAAqB,EAAC,KAAK,EAAE;gBAC7B,IAAA,uJAAyB,EAAC,KAAK,EAAE;aACpC;YAED,qCAAqC;YACrC,MAAM,aAAa,MAAM,GAAG,CAAC,CAAA,IAAK,CAAC;oBAAE,GAAG,CAAC;oBAAE,MAAM;gBAAQ,CAAC;YAC1D,MAAM,WAAW,IAAI,GAAG,CAAC,CAAA,IAAK,CAAC;oBAAE,GAAG,CAAC;oBAAE,MAAM;gBAAS,CAAC;YACvD,MAAM,kBAAkB,WAAW,GAAG,CAAC,CAAA,IAAK,CAAC;oBAAE,GAAG,CAAC;oBAAE,MAAM;gBAAa,CAAC;YAEzE,eAAe;mBAAI;mBAAe;mBAAa;aAAgB;QACnE,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC/C,SAAU;YACN,WAAW;QACf;IACJ;IAEA,IAAA,mOAAS,EAAC;QACN,IAAI,MAAM;YACN;QACJ;IACJ,GAAG;QAAC;KAAK;IAET,eAAe;IACf,MAAM,mBAAmB,YAAY,MAAM,CAAC,CAAA;QACxC,MAAM,gBAAgB,gBAAgB,MAClC,OAAO,aAAa,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW,OACnE,OAAO,YAAY,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW,OACjE,oBAAoB,UAAU,AAAC,OAAuB,cAAc,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW;QAExH,OAAO;IACX;IAEA,IAAI,SAAS;QACT,qBACI,+PAAC;YAAI,WAAU;sBACX,cAAA,+PAAC;gBAAI,WAAU;;;;;;;;;;;IAG3B;IAEA,qBACI,+PAAC;QAAI,WAAU;;0BACX,+PAAC;gBAAI,WAAU;;kCACX,+PAAC;;0CACG,+PAAC;gCAAG,WAAU;0CAAmC;;;;;;0CACjD,+PAAC;gCAAE,WAAU;0CAAgB;;;;;;;;;;;;kCAGjC,+PAAC;wBAAI,WAAU;;0CACX,+PAAC;gCAAI,WAAU;;kDACX,+PAAC,iOAAM;wCAAC,WAAU;;;;;;kDAClB,+PAAC;wCACG,MAAK;wCACL,aAAY;wCACZ,OAAO;wCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;wCAC9C,WAAU;;;;;;;;;;;;0CAGlB,+PAAC;gCACG,SAAS,IAAM,eAAe;gCAC9B,WAAU;;kDAEV,+PAAC,2NAAI;wCAAC,WAAU;;;;;;oCAAY;;;;;;;;;;;;;;;;;;;YAMvC,iBAAiB,MAAM,KAAK,kBACzB,+PAAC;gBAAI,WAAU;;kCACX,+PAAC;wBAAI,WAAU;kCACX,cAAA,+PAAC,iOAAM;4BAAC,WAAU;;;;;;;;;;;kCAEtB,+PAAC;wBAAG,WAAU;kCAAoC;;;;;;kCAClD,+PAAC;wBAAE,WAAU;kCAAqB;;;;;;;;;;;qCAGtC,+PAAC;gBAAI,WAAU;0BACV,iBAAiB,GAAG,CAAC,CAAC;oBACnB,MAAM,UAAU,OAAO,IAAI,KAAK;oBAChC,MAAM,WAAW,OAAO,IAAI,KAAK;oBACjC,MAAM,OAAO,UAAU,wNAAG,GAAG,WAAW,8NAAK,GAAG,0OAAS;oBACzD,MAAM,aAAa,UAAU,6BAA6B,WAAW,+BAA+B;oBACpG,MAAM,aAAa,IAAI,KAAK,YAAY,OAAO,IAAI,KAAK,eAAe,OAAO,WAAW,GAAG,OAAO,eAAe;oBAClH,MAAM,SAAS,IAAA,sJAAqB,EAAC;oBAErC,qBACI,+PAAC;wBAEG,WAAU;;0CAGV,+PAAC;gCACG,SAAS,CAAC;oCACN,EAAE,eAAe;oCACjB,kBAAkB;oCAClB,mBAAmB;gCACvB;gCACA,WAAU;gCACV,OAAM;0CAEN,cAAA,+PAAC,iOAAM;oCAAC,WAAU;;;;;;;;;;;0CAItB,+PAAC,wLAAI;gCACD,MAAM,CAAC,UAAU,EAAE,UAAU,UAAU,WAAW,WAAW,aAAa,CAAC,EAAE,OAAO,EAAE,EAAE;gCACxF,WAAU;;kDAEV,+PAAC;wCAAI,WAAU;;0DACX,+PAAC;gDAAI,WAAW,CAAC,eAAe,EAAE,YAAY;0DAC1C,cAAA,+PAAC;oDAAK,WAAU;;;;;;;;;;;0DAEpB,+PAAC;gDAAK,WAAW,CAAC,+CAA+C,EAAE,WAAW,WAAW,gCACrF,WAAW,kBAAkB,kCACzB,2BACF;0DACD;;;;;;;;;;;;kDAIT,+PAAC;wCAAG,WAAU;kDAAgC,OAAO,YAAY;;;;;;kDACjE,+PAAC;wCAAE,WAAU;kDAA8B,OAAO,aAAa;;;;;;kDAC/D,+PAAC;wCAAE,WAAU;;4CAA0C,OAAO,IAAI;4CAAC;;;;;;;kDAEnE,+PAAC;wCAAI,WAAU;;0DACX,+PAAC;gDAAI,WAAU;;kEACX,+PAAC;wDAAK,WAAU;kEAAgB;;;;;;kEAChC,+PAAC;wDAAK,WAAU;kEAAe,IAAA,+IAAc,EAAC,OAAO,cAAc;;;;;;;;;;;;0DAEvE,+PAAC;gDAAI,WAAU;;kEACX,+PAAC;wDAAK,WAAU;kEAAgB;;;;;;kEAChC,+PAAC;wDAAK,WAAU;kEAAe,WAAW,kBAAkB;;;;;;;;;;;;4CAE/D,yBACG,+PAAC;gDAAI,WAAU;;kEACX,+PAAC;wDAAK,WAAU;kEAAgB;;;;;;kEAChC,+PAAC;wDAAK,WAAU;kEAAe,AAAC,OAAuB,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;uBAjDhF,OAAO,EAAE;;;;;gBAwD1B;;;;;;0BAIR,+PAAC,qKAAc;gBACX,QAAQ;gBACR,SAAS,IAAM,eAAe;gBAC9B,QAAQ,MAAM,MAAM;gBACpB,WAAW;;;;;;0BAGf,+PAAC,sKAAe;gBACZ,QAAQ;gBACR,SAAS;oBACL,mBAAmB;oBACnB,kBAAkB;gBACtB;gBACA,QAAQ;gBACR,WAAW;;;;;;;;;;;;AAI3B;AAEe,SAAS;IACpB,qBACI,+PAAC,kOAAQ;QAAC,wBAAU,+PAAC;YAAI,WAAU;sBAAkB;;;;;;kBACjD,cAAA,+PAAC;;;;;;;;;;AAGb"}}]
}