{"version":3,"sources":["../../../../../OneSingleView/node_modules/lucide-react/src/icons/arrow-right.ts","../../../../../OneSingleView/app/%28customer%29/history/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowRight\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJtMTIgNSA3IDctNyA3IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/arrow-right\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowRight = createLucideIcon('ArrowRight', [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'm12 5 7 7-7 7', key: 'xquz4c' }],\n]);\n\nexport default ArrowRight;\n","'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport { History, Calendar, AlertTriangle, ArrowRight } from 'lucide-react';\nimport { getCurrentUser } from '@/lib/auth';\nimport { getUserMotorPolicies, getUserHealthPolicies, getUserCommercialPolicies } from '@/lib/db';\nimport { MotorPolicy, HealthPolicy, CommercialPolicy, User } from '@/types';\n\ntype AnyPolicy = (MotorPolicy | HealthPolicy | CommercialPolicy) & { type: 'Motor' | 'Health' | 'Commercial' };\n\nexport default function HistoryPage() {\n    const [user, setUser] = useState<User | null>(null);\n    const [expiredPolicies, setExpiredPolicies] = useState<AnyPolicy[]>([]);\n    const [loading, setLoading] = useState(true);\n\n    useEffect(() => {\n        const fetchUserAndHistory = async () => {\n            setLoading(true);\n            try {\n                const currentUser = await getCurrentUser();\n                if (!currentUser) {\n                    setLoading(false);\n                    return;\n                }\n                setUser(currentUser);\n\n                const [motor, gmc, commercial] = await Promise.all([\n                    getUserMotorPolicies(currentUser.id),\n                    getUserHealthPolicies(currentUser.id),\n                    getUserCommercialPolicies(currentUser.id)\n                ]);\n\n                const now = new Date();\n                const allPolicies: AnyPolicy[] = [\n                    ...motor.map(p => ({ ...p, type: 'Motor' as const })),\n                    ...gmc.map(p => ({ ...p, type: 'Health' as const })),\n                    ...commercial.map(p => ({ ...p, type: 'Commercial' as const }))\n                ];\n\n                // Filter for expired policies (end date < now)\n                const expired = allPolicies.filter(p => {\n                    const endDate = 'policy_end_date' in p ? p.policy_end_date : p.expiry_date;\n                    return new Date(endDate) < now;\n                });\n\n                setExpiredPolicies(expired.sort((a, b) => {\n                    const dateA = 'policy_end_date' in a ? a.policy_end_date : a.expiry_date;\n                    const dateB = 'policy_end_date' in b ? b.policy_end_date : b.expiry_date;\n                    return new Date(dateB).getTime() - new Date(dateA).getTime();\n                }));\n\n            } catch (error) {\n                console.error('Error fetching history:', error);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchUserAndHistory();\n    }, []);\n\n    const getPolicyTitle = (policy: AnyPolicy) => {\n        if (policy.type === 'Motor') return `${(policy as MotorPolicy).vehicle_number} - ${(policy as MotorPolicy).model}`;\n        if (policy.type === 'Health') return `${(policy as HealthPolicy).company_name} Health`;\n        return `${(policy as CommercialPolicy).lob_type} Policy`;\n    };\n\n    const getPolicyEndDate = (policy: AnyPolicy) => {\n        return 'policy_end_date' in policy ? policy.policy_end_date : policy.expiry_date;\n    };\n\n    return (\n        <div className=\"space-y-6\">\n            <div>\n                <h1 className=\"text-2xl font-bold text-gray-900\">Policy History</h1>\n                <p className=\"text-gray-500\">View your expired and past insurance policies</p>\n            </div>\n\n            {loading ? (\n                <div className=\"flex justify-center py-12\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"></div>\n                </div>\n            ) : expiredPolicies.length === 0 ? (\n                <div className=\"text-center py-12 bg-white rounded-xl border border-dashed border-gray-300\">\n                    <div className=\"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4\">\n                        <History className=\"w-8 h-8 text-gray-400\" />\n                    </div>\n                    <h3 className=\"text-lg font-medium text-gray-900 mb-1\">No History Found</h3>\n                    <p className=\"text-gray-500\">You don't have any expired policies yet.</p>\n                </div>\n            ) : (\n                <div className=\"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden\">\n                    <div className=\"overflow-x-auto\">\n                        <table className=\"w-full text-left\">\n                            <thead className=\"bg-gray-50 border-b border-gray-100\">\n                                <tr>\n                                    <th className=\"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider\">Policy Details</th>\n                                    <th className=\"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider\">Type</th>\n                                    <th className=\"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider\">Insurer</th>\n                                    <th className=\"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider\">Expired On</th>\n                                    <th className=\"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider\">Status</th>\n                                    <th className=\"px-6 py-4 text-xs font-semibold text-gray-500 uppercase tracking-wider\">Action</th>\n                                </tr>\n                            </thead>\n                            <tbody className=\"divide-y divide-gray-100\">\n                                {expiredPolicies.map((policy) => (\n                                    <tr key={policy.id} className=\"hover:bg-gray-50 transition-colors\">\n                                        <td className=\"px-6 py-4\">\n                                            <div className=\"font-medium text-gray-900\">{getPolicyTitle(policy)}</div>\n                                            <div className=\"text-xs text-gray-500\">{policy.policy_number}</div>\n                                        </td>\n                                        <td className=\"px-6 py-4\">\n                                            <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800\">\n                                                {policy.type}\n                                            </span>\n                                        </td>\n                                        <td className=\"px-6 py-4 text-sm text-gray-600\">\n                                            {policy.insurer_name}\n                                        </td>\n                                        <td className=\"px-6 py-4 text-sm text-gray-600\">\n                                            {new Date(getPolicyEndDate(policy)).toLocaleDateString()}\n                                        </td>\n                                        <td className=\"px-6 py-4\">\n                                            <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800\">\n                                                Expired\n                                            </span>\n                                        </td>\n                                        <td className=\"px-6 py-4\">\n                                            <button className=\"text-primary-600 hover:text-primary-700 font-medium text-sm flex items-center\">\n                                                Renew <ArrowRight className=\"w-4 h-4 ml-1\" />\n                                            </button>\n                                        </td>\n                                    </tr>\n                                ))}\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}