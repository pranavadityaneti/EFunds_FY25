module.exports=[90497,a=>{"use strict";var b=a.i(93022);function c(a){let b={...a};return Object.keys(b).forEach(a=>{if(b[a]&&"string"==typeof b[a]){let c=new Date(b[a]);(!isNaN(c.getTime())&&a.includes("date")||a.includes("_at"))&&(b[a]=c)}}),b}async function d(a,c,d){let{data:e,error:f}=await b.supabase.from(a).select("id").eq("user_id",c).eq("policy_number",d).maybeSingle();if(e)throw Error("This policy number already exists in your account")}async function e(a){try{let{data:d,error:e}=await b.supabase.from("motor_policies").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(e)throw e;return(d||[]).map(a=>({...c(a),id:a.id,user_id:a.user_id}))}catch(a){return console.error("Error fetching motor policies:",a.message,a.details,a.hint),[]}}async function f(a){try{let{data:d,error:e}=await b.supabase.from("health_policies").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(e)throw e;return(d||[]).map(a=>c(a))}catch(a){return console.error("Error fetching health policies:",a.message,a.details,a.hint),[]}}async function g(a,d){try{let e=b.supabase.from("commercial_policies").select("*").eq("user_id",a);d&&(e=e.eq("lob_type",d));let{data:f,error:g}=await e.order("created_at",{ascending:!1});if(g)throw g;return(f||[]).map(a=>c(a))}catch(a){return console.error("Error fetching commercial policies:",a.message,a.details,a.hint),[]}}async function h(a){try{let{data:d,error:e}=await b.supabase.from("claims").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(e)throw e;return(d||[]).map(a=>c(a))}catch(a){return console.error("Error fetching claims:",a.message,a.details,a.hint),[]}}async function i(a){try{let{data:d,error:e}=await b.supabase.from("quote_requests").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(e)throw e;return(d||[]).map(a=>c(a))}catch(a){return console.error("Error fetching quote requests:",a),[]}}async function j(a){try{await d("motor_policies",a.user_id,a.policy_number);let{data:c,error:e}=await b.supabase.from("motor_policies").insert({user_id:a.user_id,policy_number:a.policy_number,vehicle_number:a.vehicle_number,vehicle_type:a.vehicle_type,manufacturer:a.manufacturer,model:a.model,fuel_type:a.fuel_type,manufacturing_year:a.manufacturing_year,number_plate_type:a.number_plate_type,insurer_name:a.insurer_name,premium_amount:a.premium_amount,policy_start_date:a.policy_start_date,policy_end_date:a.policy_end_date,rc_docs:a.rc_docs||[],previous_policy_docs:a.previous_policy_docs||[],dl_docs:a.dl_docs||[]}).select().single();if(e)throw e;return c.id}catch(a){throw console.error("Error adding motor policy:",a),Error(a.message||"Failed to add motor policy")}}async function k(a){try{await d("health_policies",a.user_id,a.policy_number);let{data:c,error:e}=await b.supabase.from("health_policies").insert({user_id:a.user_id,company_name:a.company_name,policy_number:a.policy_number,insurer_name:a.insurer_name,sum_insured:a.sum_insured,premium_amount:a.premium_amount,expiry_date:a.expiry_date,policy_docs:a.policy_docs||[],no_of_lives:a.no_of_lives}).select().single();if(e)throw e;return c.id}catch(a){throw console.error("Error adding health policy:",a),Error(a.message||"Failed to add health policy")}}async function l(a){try{await d("commercial_policies",a.user_id,a.policy_number);let{data:c,error:e}=await b.supabase.from("commercial_policies").insert({user_id:a.user_id,lob_type:a.lob_type,company_name:a.company_name,policy_holder_name:a.policy_holder_name,policy_number:a.policy_number,insurer_name:a.insurer_name,premium_amount:a.premium_amount,sum_insured:a.sum_insured,expiry_date:a.expiry_date,policy_docs:a.policy_docs||[]}).select().single();if(e)throw e;return c.id}catch(a){throw console.error("Error adding commercial policy:",a),Error(a.message||"Failed to add commercial policy")}}async function m(a,c){try{let{error:d}=await b.supabase.from("motor_policies").update(c).eq("id",a);if(d)throw d}catch(a){throw console.error("Error updating motor policy:",a),Error(a.message||"Failed to update motor policy")}}async function n(a){try{let{error:c}=await b.supabase.from("motor_policies").delete().eq("id",a);if(c)throw c}catch(a){throw console.error("Error deleting motor policy:",a),Error(a.message||"Failed to delete motor policy")}}async function o(a,c){try{let{error:d}=await b.supabase.from("health_policies").update(c).eq("id",a);if(d)throw d}catch(a){throw console.error("Error updating health policy:",a),Error(a.message||"Failed to update health policy")}}async function p(a){try{let{error:c}=await b.supabase.from("health_policies").delete().eq("id",a);if(c)throw c}catch(a){throw console.error("Error deleting health policy:",a),Error(a.message||"Failed to delete health policy")}}async function q(a,c){try{let{error:d}=await b.supabase.from("commercial_policies").update(c).eq("id",a);if(d)throw d}catch(a){throw console.error("Error updating commercial policy:",a),Error(a.message||"Failed to update commercial policy")}}async function r(a){try{let{error:c}=await b.supabase.from("commercial_policies").delete().eq("id",a);if(c)throw c}catch(a){throw console.error("Error deleting commercial policy:",a),Error(a.message||"Failed to delete commercial policy")}}async function s(a){try{let{data:c,error:d}=await b.supabase.from("claims").insert({user_id:a.user_id,policy_id:a.policy_id,lob_type:a.lob_type,claim_type:a.claim_type,incident_date:a.incident_date,description:a.description,supporting_docs:a.supporting_docs||[],status:a.status}).select().single();if(d)throw d;return c.id}catch(a){throw console.error("Error adding claim:",a),Error(a.message||"Failed to add claim")}}async function t(a,c){try{let{error:d}=await b.supabase.from("claims").update(c).eq("id",a);if(d)throw d}catch(a){throw console.error("Error updating claim:",a),Error(a.message||"Failed to update claim")}}async function u(a){try{let{data:c,error:d}=await b.supabase.from("quote_requests").insert({user_id:a.user_id,lob_type:a.lob_type,details:a.details,uploaded_quote:a.uploaded_quote,has_better_quote:a.has_better_quote,status:a.status}).select().single();if(d)throw d;return c.id}catch(a){throw console.error("Error adding quote request:",a),Error(a.message||"Failed to add quote request")}}async function v(a,c){try{let{error:d}=await b.supabase.from("quote_requests").update(c).eq("id",a);if(d)throw d}catch(a){throw console.error("Error updating quote request:",a),Error(a.message||"Failed to update quote request")}}async function w(a){try{let{data:d,error:e}=await b.supabase.from("referrals").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(e)throw e;return(d||[]).map(a=>c(a))}catch(a){return console.error("Error fetching referrals:",a.message,a.details,a.hint),[]}}async function x(a){try{let{data:c,error:d}=await b.supabase.from("referrals").insert({user_id:a.user_id,friend_name:a.friend_name,friend_mobile:a.friend_mobile,friend_email:a.friend_email,notes:a.notes}).select().single();if(d)throw d;return c.id}catch(a){throw console.error("Error adding referral:",a),Error(a.message||"Failed to add referral")}}async function y(a,c,d,e){try{let{error:f}=await b.supabase.from("user_audit_log").insert({user_id:a,field_changed:c,old_value:d,new_value:e});if(f)throw f}catch(a){console.error("Error logging user change:",a)}}async function z(){try{let{data:a,error:d}=await b.supabase.from("users").select("*").order("created_at",{ascending:!1});if(d)throw d;return(a||[]).map(a=>c(a))}catch(a){return console.error("Error fetching all users:",a),[]}}async function A(a){try{let{data:d,error:e}=await b.supabase.from("users").select("*").eq("id",a).single();if(e)throw e;return c(d)}catch(a){return console.error("Error fetching user details:",a),null}}async function B(a,b){try{console.log(`Updating user ${a} status to ${b}`)}catch(a){throw console.error("Error updating user status:",a),a}}async function C(a){try{let{data:d,error:e}=await b.supabase.from("user_audit_log").select("*").eq("user_id",a).order("created_at",{ascending:!1});if(e)throw e;return(d||[]).map(a=>c(a))}catch(a){return console.error("Error fetching audit logs:",a.message||a),[]}}async function D(){try{let{data:a,error:d}=await b.supabase.from("motor_policies").select("*, users(name, email)").order("created_at",{ascending:!1});if(d)throw d;return(a||[]).map(a=>({...c(a),user_name:a.users?.name,user_email:a.users?.email}))}catch(a){return console.error("Error fetching all motor policies:",a),[]}}async function E(){try{let{data:a,error:d}=await b.supabase.from("health_policies").select("*, users(name, email)").order("created_at",{ascending:!1});if(d)throw d;return(a||[]).map(a=>({...c(a),user_name:a.users?.name,user_email:a.users?.email}))}catch(a){return console.error("Error fetching all health policies:",a),[]}}async function F(){try{let{data:a,error:d}=await b.supabase.from("commercial_policies").select("*, users(name, email)").order("created_at",{ascending:!1});if(d)throw d;return(a||[]).map(a=>({...c(a),user_name:a.users?.name,user_email:a.users?.email}))}catch(a){return console.error("Error fetching all commercial policies:",a),[]}}async function G(){try{let{data:a,error:d}=await b.supabase.from("claims").select("*, users(name, email)").order("created_at",{ascending:!1});if(d)throw d;return(a||[]).map(a=>({...c(a),user_name:a.users?.name,user_email:a.users?.email}))}catch(a){return console.error("Error fetching all claims:",a),[]}}async function H(){try{let{data:a,error:d}=await b.supabase.from("quote_requests").select("*, users(name, email)").order("created_at",{ascending:!1});if(d)throw d;return(a||[]).map(a=>({...c(a),user_name:a.users?.name,user_email:a.users?.email}))}catch(a){return console.error("Error fetching all quote requests:",a),[]}}async function I(){try{let{data:a,error:d}=await b.supabase.from("app_settings").select("*").order("key");if(d)throw d;return(a||[]).map(a=>c(a))}catch(a){return console.error("Error fetching app settings:",a),[]}}async function J(a,c){try{let{error:d}=await b.supabase.from("app_settings").upsert({key:a,value:c,updated_at:new Date});if(d)throw d}catch(a){throw console.error("Error updating app setting:",a),a}}async function K(){try{let{data:a,error:d}=await b.supabase.from("banners").select("*").order("display_order");if(d)throw d;return(a||[]).map(a=>c(a))}catch(a){return console.error("Error fetching banners:",a),[]}}async function L(a){try{let{error:c}=await b.supabase.from("banners").insert(a);if(c)throw c}catch(a){throw console.error("Error adding banner:",a),a}}async function M(a){try{let{error:c}=await b.supabase.from("banners").delete().eq("id",a);if(c)throw c}catch(a){throw console.error("Error deleting banner:",a),a}}async function N(){try{let{data:a,error:d}=await b.supabase.from("garages").select("*").order("name");if(d)throw d;return(a||[]).map(a=>c(a))}catch(a){return console.error("Error fetching garages:",a),[]}}async function O(a){try{let{error:c}=await b.supabase.from("garages").insert(a);if(c)throw c}catch(a){throw console.error("Error adding garage:",a),a}}async function P(a){try{let{error:c}=await b.supabase.from("garages").delete().eq("id",a);if(c)throw c}catch(a){throw console.error("Error deleting garage:",a),a}}async function Q(a,d){try{let{data:e,error:f}=await b.supabase.from("users").update(d).eq("id",a).select().single();if(f)throw f;return c(e)}catch(a){throw console.error("Error updating user profile:",a),a}}async function R(a){try{let{data:c,error:d}=await b.supabase.from("users").select("rm_id").eq("id",a).single();if(d)return console.log("Error fetching user for RM, returning default:",d),{name:"Amit Sharma",email:"amit.sharma@onesingleview.com",mobile:"+91 98765 43210"};if(!c?.rm_id)return{name:"Amit Sharma",email:"amit.sharma@onesingleview.com",mobile:"+91 98765 43210"};let{data:e,error:f}=await b.supabase.from("users").select("name, email, mobile").eq("id",c.rm_id).single();if(f)throw f;return e}catch(a){return console.error("Error fetching user RM:",a),{name:"Amit Sharma",email:"amit.sharma@onesingleview.com",mobile:"+91 98765 43210"}}}async function S(a){try{let{data:d,error:e}=await b.supabase.from("user_preferences").select("*").eq("user_id",a).single();if(e&&"PGRST116"===e.code)return await T(a);if(e)throw e;return c(d)}catch(a){throw console.error("Error fetching user preferences:",a),a}}async function T(a){try{let{data:d,error:e}=await b.supabase.from("user_preferences").insert({user_id:a,email_notifications:!0,sms_notifications:!1,policy_expiry_alerts:!0,claim_updates:!0}).select().single();if(e)throw e;return c(d)}catch(a){throw console.error("Error creating default preferences:",a),a}}async function U(a,d){try{let{data:e,error:f}=await b.supabase.from("user_preferences").upsert({user_id:a,...d,updated_at:new Date().toISOString()}).select().single();if(f)throw f;return c(e)}catch(a){throw console.error("Error updating user preferences:",a),a}}async function V(a){let{data:d,error:e}=await b.supabase.from("life_policies").select("*").eq("user_id",a).order("policy_end_date",{ascending:!0});if(e)throw e;return(d||[]).map(a=>c(a))}async function W(a){await d("life_policies",a.user_id,a.policy_number);let{data:c,error:e}=await b.supabase.from("life_policies").insert([a]).select().single();if(e)throw e;return c}async function X(a){let{data:d,error:e}=await b.supabase.from("travel_policies").select("*").eq("user_id",a).order("policy_end_date",{ascending:!0});if(e)throw e;return(d||[]).map(a=>c(a))}async function Y(a){await d("travel_policies",a.user_id,a.policy_number);let{data:c,error:e}=await b.supabase.from("travel_policies").insert([a]).select().single();if(e)throw e;return c}async function Z(a){let{data:d,error:e}=await b.supabase.from("health_policies").select("*").eq("company_name",a).maybeSingle();if(e)throw e;return d?c(d):null}async function $(a){let{data:d,error:e}=await b.supabase.from("cyber_policies").select("*").eq("user_id",a).order("policy_end_date",{ascending:!0});if(e)throw e;return(d||[]).map(a=>c(a))}async function _(a){await d("cyber_policies",a.user_id,a.policy_number);let{data:c,error:e}=await b.supabase.from("cyber_policies").insert([a]).select().single();if(e)throw e;return c}async function aa(a){let{data:d,error:e}=await b.supabase.from("notifications").select("*").eq("user_id",a).order("created_at",{ascending:!1}).limit(20);if(e)throw e;return(d||[]).map(a=>c(a))}async function ab(a){let{error:c}=await b.supabase.from("notifications").update({is_read:!0}).eq("id",a);if(c)throw c}async function ac(a){let{error:c}=await b.supabase.from("notifications").update({is_read:!0}).eq("user_id",a).eq("is_read",!1);if(c)throw c}async function ad(a,c){try{let d=c.name.split(".").pop(),e=`${a}-${Math.random()}.${d}`,f=`${e}`,{error:g}=await b.supabase.storage.from("avatars").upload(f,c);if(g)throw g;let{data:h}=b.supabase.storage.from("avatars").getPublicUrl(f),{error:i}=await b.supabase.from("users").update({avatar_url:h.publicUrl}).eq("id",a);if(i)throw i;return h.publicUrl}catch(a){return console.error("Error uploading avatar:",a.message),null}}a.s(["addBanner",()=>L,"addClaim",()=>s,"addCommercialPolicy",()=>l,"addCyberPolicy",()=>_,"addGarage",()=>O,"addHealthPolicy",()=>k,"addLifePolicy",()=>W,"addMotorPolicy",()=>j,"addQuoteRequest",()=>u,"addReferral",()=>x,"addTravelPolicy",()=>Y,"deleteBanner",()=>M,"deleteCommercialPolicy",()=>r,"deleteGarage",()=>P,"deleteHealthPolicy",()=>p,"deleteMotorPolicy",()=>n,"getAllBanners",()=>K,"getAllClaims",()=>G,"getAllCommercialPolicies",()=>F,"getAllGarages",()=>N,"getAllHealthPolicies",()=>E,"getAllMotorPolicies",()=>D,"getAllQuoteRequests",()=>H,"getAllUsers",()=>z,"getAppSettings",()=>I,"getCompanyGMCPolicy",()=>Z,"getUserAuditLogs",()=>C,"getUserById",()=>A,"getUserClaims",()=>h,"getUserCommercialPolicies",()=>g,"getUserCyberPolicies",()=>$,"getUserHealthPolicies",()=>f,"getUserLifePolicies",()=>V,"getUserMotorPolicies",()=>e,"getUserNotifications",()=>aa,"getUserPreferences",()=>S,"getUserQuoteRequests",()=>i,"getUserRM",()=>R,"getUserReferrals",()=>w,"getUserTravelPolicies",()=>X,"logUserChange",()=>y,"markAllNotificationsAsRead",()=>ac,"markNotificationAsRead",()=>ab,"updateAppSetting",()=>J,"updateClaim",()=>t,"updateCommercialPolicy",()=>q,"updateHealthPolicy",()=>o,"updateMotorPolicy",()=>m,"updateQuoteRequest",()=>v,"updateUserPreferences",()=>U,"updateUserProfile",()=>Q,"updateUserStatus",()=>B,"uploadAvatar",()=>ad])}];

//# sourceMappingURL=OneSingleView_lib_db_ts_195f60cc._.js.map