module.exports=[30328,a=>{"use strict";let b=(0,a.i(42077).default)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],30328)},74210,a=>{"use strict";let b=(0,a.i(42077).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],74210)},33413,a=>{"use strict";let b=(0,a.i(42077).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],33413)},14505,a=>{"use strict";let b=(0,a.i(42077).default)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>b],14505)},59204,1181,a=>{"use strict";let b=(0,a.i(42077).default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);a.s(["X",()=>b],59204);var c=a.i(72440);function d({label:a,name:b,type:d="text",value:e,onChange:f,onBlur:g,error:h,placeholder:i,required:j=!1,disabled:k=!1,min:l,max:m,step:n,options:o=[],rows:p=4,className:q=""}){let r=`
    w-full px-4 py-2 border rounded-lg
    focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent
    disabled:bg-gray-100 disabled:cursor-not-allowed
    transition-colors
    ${h?"border-red-500 focus:ring-red-500":"border-gray-300"}
    ${q}
  `;return(0,c.jsxs)("div",{className:"space-y-1",children:[(0,c.jsxs)("label",{htmlFor:b,className:"block text-sm font-medium text-gray-700",children:[a,j&&(0,c.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),"select"===d?(0,c.jsxs)("select",{id:b,name:b,value:e,onChange:f,onBlur:g,disabled:k,required:j,className:r,children:[(0,c.jsxs)("option",{value:"",children:["Select ",a]}),o.map(a=>(0,c.jsx)("option",{value:a.value,children:a.label},a.value))]}):"textarea"===d?(0,c.jsx)("textarea",{id:b,name:b,value:e,onChange:f,onBlur:g,placeholder:i,disabled:k,required:j,rows:p,className:r}):(0,c.jsx)("input",{id:b,name:b,type:d,value:e,onChange:f,onBlur:g,placeholder:i,disabled:k,required:j,min:l,max:m,step:n,className:r}),h&&(0,c.jsxs)("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,c.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,c.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),h]})]})}a.s(["default",()=>d],1181)},20219,a=>{"use strict";var b=a.i(72440),c=a.i(29916),d=a.i(42077);let e=(0,d.default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var f=a.i(59204);let g=(0,d.default)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);var h=a.i(30328),i=a.i(93022);async function j(a,b){try{let c=Date.now(),d=Math.random().toString(36).substring(2,8),e=a.name.split(".").pop(),f=`${c}_${d}.${e}`,{data:g,error:h}=await i.supabase.storage.from(b).upload(f,a,{cacheControl:"3600",upsert:!0});if(h)throw h;let{data:{publicUrl:j}}=i.supabase.storage.from(b).getPublicUrl(g.path);return j}catch(a){throw console.error("Error uploading file:",a),Error(a.message||"Failed to upload file")}}function k({label:a,name:d,accept:i=".pdf,.jpg,.jpeg,.png",bucket:k,onUploadComplete:l,existingFile:m,required:n=!1,maxSizeMB:o=5}){let[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(m?.url||null),[t,u]=(0,c.useState)(m?.name||""),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(0),[z,A]=(0,c.useState)(""),B=(0,c.useRef)(null),C=async a=>{if(A(""),a.size>1024*o*1024)return void A(`File size must be less than ${o}MB`);if(q(a),u(a.name),a.type.startsWith("image/")){let b=new FileReader;b.onload=a=>{s(a.target?.result)},b.readAsDataURL(a)}else s(null);await D(a)},D=async a=>{w(!0),y(0);try{let b=setInterval(()=>{y(a=>Math.min(a+10,90))},200),c=await j(a,k);clearInterval(b),y(100),w(!1),l(c,a.name)}catch(a){console.error("Upload error:",a),A("Failed to upload file. Please try again."),w(!1),q(null),s(null)}};return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:[a,n&&(0,b.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),p||m?(0,b.jsx)("div",{className:"border border-gray-300 rounded-lg p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3 flex-1",children:[r?(0,b.jsx)("img",{src:r,alt:"Preview",className:"w-16 h-16 object-cover rounded"}):(0,b.jsx)(g,{className:"w-8 h-8 text-gray-400"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:t}),v&&(0,b.jsxs)("div",{className:"mt-2",children:[(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-primary-600 h-2 rounded-full transition-all",style:{width:`${x}%`}})}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Uploading... ",x,"%"]})]}),!v&&100===x&&(0,b.jsxs)("p",{className:"text-xs text-green-600 flex items-center gap-1 mt-1",children:[(0,b.jsx)(h.CheckCircle,{className:"w-3 h-3"}),"Uploaded successfully"]})]})]}),!v&&(0,b.jsx)("button",{type:"button",onClick:()=>{q(null),s(null),u(""),y(0),A(""),B.current&&(B.current.value="")},className:"text-red-600 hover:text-red-800 p-1 ml-4 hover:bg-red-50 rounded-full transition-colors",children:(0,b.jsx)(f.X,{className:"w-5 h-5"})})]})}):(0,b.jsxs)("div",{onDrop:a=>{a.preventDefault();let b=a.dataTransfer.files[0];b&&C(b)},onDragOver:a=>{a.preventDefault()},onClick:()=>B.current?.click(),className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center cursor-pointer hover:border-primary-500 transition-colors",children:[(0,b.jsx)(e,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Click to upload or drag and drop"}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:[i.toUpperCase()," (Max ",o,"MB)"]}),(0,b.jsx)("input",{ref:B,type:"file",accept:i,onChange:a=>a.target.files?.[0]&&C(a.target.files[0]),className:"hidden"})]}),z&&(0,b.jsxs)("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),z]})]})}a.s(["default",()=>k],20219)},69820,42109,a=>{"use strict";a.s(["CAR_MANUFACTURERS",0,["Maruti Suzuki","Hyundai","Tata","Honda","Toyota","Mahindra","Kia","Volkswagen","Renault","Nissan","Ford","Skoda","MG","Jeep","BMW","Mercedes-Benz","Audi","Volvo","Others"],"INSURANCE_COMPANIES",0,["HDFC ERGO","GO DIGIT","ICICI LOMBARD","TATA AIG","SHRIRAM GIC","ACKO GIC","CHOLA MS","INDUSIND GIC","BAJAJ GIC","IFFCO GIC","liberty gic","Royal sundaram","magma","kotak gic","sbi gic","national insurance","oriental","united India gic","new india gic","OTHERS"]],69820),a.s(["validateDateRange",0,(a,b)=>a<b,"validatePolicyNumber",0,a=>a.trim().length>=5,"validatePremiumAmount",0,(a,b=0,c=1e7)=>a>=b&&a<=c&&!isNaN(a),"validateVehicleNumber",0,a=>/^[A-Z]{2}[0-9]{1,2}[A-Z]{1,2}[0-9]{4}$/.test(a.replace(/\s+/g,""))],42109)},21356,a=>{"use strict";var b=a.i(72440),c=a.i(29916),d=a.i(59204),e=a.i(14505),f=a.i(74210),g=a.i(1181),h=a.i(20219),i=a.i(90497),j=a.i(69820),k=a.i(42109);function l({userId:a,initialData:l,onClose:m,onSuccess:n}){let[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)({}),[s,t]=(0,c.useState)({company_name:l?.company_name||"",policy_number:l?.policy_number||"",insurer_name:l?.insurer_name||"",sum_insured:l?.sum_insured||0,premium_amount:l?.premium_amount||0,expiry_date:new Date(l?.expiry_date?l.expiry_date:new Date().setFullYear(new Date().getFullYear()+1)),policy_docs:l?.policy_docs||[],no_of_lives:l?.no_of_lives||0});(0,c.useEffect)(()=>{if(!l){let a=new Date(new Date);a.setFullYear(a.getFullYear()+1),a.setDate(a.getDate()-1),t(b=>({...b,expiry_date:a}))}},[l]);let u=a=>{let{name:b,value:c,type:d}=a.target;t(a=>({...a,[b]:"number"===d?Number(c):c})),q[b]&&r(a=>{let c={...a};return delete c[b],c})},v=async b=>{let c;if(b.preventDefault(),c={},(0,k.validatePolicyNumber)(s.policy_number||"")||(c.policy_number="Policy number is required"),(0,k.validatePremiumAmount)(s.premium_amount||0)||(c.premium_amount="Invalid premium amount"),s.insurer_name||(c.insurer_name="Insurer name is required"),s.company_name||(c.company_name="Company name is required"),r(c),0===Object.keys(c).length){p(!0);try{let b={...s,user_id:a,expiry_date:new Date(s.expiry_date),policy_number:s.policy_number||"",insurer_name:s.insurer_name||"",premium_amount:s.premium_amount||0,policy_docs:s.policy_docs||[]};l?.id?await (0,i.updateHealthPolicy)(l.id,b):await (0,i.addHealthPolicy)(b),n(),m()}catch(a){console.error("Error saving policy:",a),r(a=>({...a,submit:"Failed to save policy. Please try again."}))}finally{p(!1)}}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-6 border-b sticky top-0 bg-white z-10",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:l?"Edit Health Insurance Policy":"Add New Health Insurance Policy"}),(0,b.jsx)("button",{onClick:m,className:"text-gray-500 hover:text-gray-700",children:(0,b.jsx)(d.X,{className:"w-6 h-6"})})]}),(0,b.jsxs)("form",{onSubmit:v,className:"p-6 space-y-8",children:[q.submit&&(0,b.jsx)("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg text-sm",children:q.submit}),(0,b.jsxs)("section",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Policy Details"}),(0,b.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,b.jsx)(g.default,{label:"Company Name",name:"company_name",value:s.company_name||"",onChange:u,placeholder:"e.g. Acme Corp",error:q.company_name,required:!0}),(0,b.jsx)(g.default,{label:"Policy Number",name:"policy_number",value:s.policy_number||"",onChange:u,placeholder:"Enter policy number",error:q.policy_number,required:!0}),(0,b.jsx)(g.default,{label:"Insurer Name",name:"insurer_name",type:"select",value:s.insurer_name||"",onChange:u,options:j.INSURANCE_COMPANIES.map(a=>({value:a,label:a})),error:q.insurer_name,required:!0}),(0,b.jsx)(g.default,{label:"Sum Insured (₹)",name:"sum_insured",type:"number",value:s.sum_insured||"",onChange:u,placeholder:"e.g. 500000"}),(0,b.jsx)(g.default,{label:"Premium Amount (₹)",name:"premium_amount",type:"number",value:s.premium_amount||"",onChange:u,error:q.premium_amount,required:!0}),(0,b.jsx)(g.default,{label:"Expiry Date",name:"expiry_date",type:"date",value:s.expiry_date?new Date(s.expiry_date).toISOString().split("T")[0]:"",onChange:a=>{let{name:b,value:c}=a.target;t(a=>({...a,[b]:new Date(c)}))},required:!0}),(0,b.jsx)(g.default,{label:"Number of Lives",name:"no_of_lives",type:"number",value:s.no_of_lives||"",onChange:u,placeholder:"e.g. 50"})]})]}),(0,b.jsxs)("section",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Documents"}),(0,b.jsx)("div",{className:"grid md:grid-cols-3 gap-6",children:(0,b.jsx)(h.default,{label:"Policy Document",name:"policy_docs",bucket:"policy-documents",onUploadComplete:a=>{t(b=>({...b,policy_docs:[...b.policy_docs||[],a]}))},existingFile:s.policy_docs&&s.policy_docs.length>0?{url:s.policy_docs[0],name:"Policy Document"}:void 0})})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[(0,b.jsx)("button",{type:"button",onClick:m,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",disabled:o,children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center",disabled:o,children:o?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Save,{className:"w-4 h-4 mr-2"}),"Save Policy"]})})]})]})]})})}a.s(["default",()=>l])}];

//# sourceMappingURL=OneSingleView_3f15ae10._.js.map