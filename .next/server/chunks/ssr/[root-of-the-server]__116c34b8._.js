module.exports=[89589,(a,b,c)=>{"use strict";b.exports=a.r(96853).vendored.contexts.HooksClientContext},15294,(a,b,c)=>{"use strict";b.exports=a.r(96853).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},96853,(a,b,c)=>{"use strict";b.exports=a.r(18622)},72440,(a,b,c)=>{"use strict";b.exports=a.r(96853).vendored["react-ssr"].ReactJsxRuntime},29916,(a,b,c)=>{"use strict";b.exports=a.r(96853).vendored["react-ssr"].React},16918,(a,b,c)=>{"use strict";b.exports=a.r(96853).vendored.contexts.AppRouterContext},64129,(a,b,c)=>{"use strict";b.exports=a.r(96853).vendored["react-ssr"].ReactServerDOMTurbopackClient},42077,a=>{"use strict";var b=a.i(29916);let c=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let e=(0,b.forwardRef)(({color:a="currentColor",size:e=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...d,width:e,height:e,stroke:a,strokeWidth:g?24*Number(f)/Number(e):f,className:c("lucide",h),...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),f=(a,d)=>{let f=(0,b.forwardRef)(({className:f,...g},h)=>(0,b.createElement)(e,{ref:h,iconNode:d,className:c(`lucide-${a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,f),...g}));return f.displayName=`${a}`,f};a.s(["default",()=>f],42077)},15059,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},57807,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__"},93647,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},8490,a=>{"use strict";var b=a.i(93022);async function c(a,c,d,e,f,g){try{let{data:h,error:i}=await b.supabase.auth.signUp({email:a,password:c});if(i)throw i;if(!h.user)throw Error("No user returned from signup");let j="1SV-"+Math.random().toString(36).substring(2,8).toUpperCase(),k={id:h.user.id,email:a,mobile:e,name:d,company_name:"corporate_employee"===f||"corporate_admin"===f?g:void 0,role:f,customer_id:j},l=3;for(;l>0;)try{await new Promise(a=>setTimeout(a,1e3));let{error:c}=await b.supabase.from("users").insert({id:h.user.id,email:k.email,mobile:k.mobile,name:k.name,company_name:k.company_name,role:k.role,customer_id:k.customer_id});if(c){if("23503"===c.code)throw c;if("23505"===c.code){console.log("User profile already exists, checking for orphan...");let{data:c,error:d}=await b.supabase.from("users").select("*").eq("email",a).maybeSingle();if(!d&&c){if(c.id===h.user.id)return{...c,created_at:new Date(c.created_at),updated_at:new Date(c.updated_at)};console.log("Found orphaned profile. Linking to new Auth ID...");let{error:d}=await b.supabase.from("users").update({id:h.user.id,updated_at:new Date().toISOString()}).eq("email",a);if(d)throw console.error("Failed to link orphaned profile:",d),d;return{...c,id:h.user.id,created_at:new Date(c.created_at),updated_at:new Date}}}throw c}break}catch(a){if(l--,0===l)throw console.error("Failed to create user profile after retries:",a),Error("Failed to create user profile. Please try again.");console.log(`Retrying user profile creation... (${l} attempts left)`)}return{...k,created_at:new Date,updated_at:new Date}}catch(a){throw console.error("Signup error:",a),Error(a.message||"Failed to sign up")}}async function d(a){try{let{error:c}=await b.supabase.auth.resetPasswordForEmail(a,{redirectTo:"http://localhost:3000/update-password"});if(c)throw c}catch(a){throw console.error("Reset password error:",a),Error(a.message||"Failed to send reset password email")}}async function e(a,c){try{let{data:d,error:e}=await b.supabase.auth.signInWithPassword({email:a,password:c});if(e)throw e;if(!d.user)throw Error("No user returned from sign in");let{data:f,error:g}=await b.supabase.from("users").select("*").eq("id",d.user.id).maybeSingle();if(g)throw g;if(!f)throw Error("User profile not found. Please contact support.");return{id:f.id,email:f.email,mobile:f.mobile,name:f.name,company_name:f.company_name,role:f.role,created_at:new Date(f.created_at),updated_at:new Date(f.updated_at),rm_id:f.rm_id,customer_id:f.customer_id}}catch(a){throw console.error("Sign in error:",a),Error(a.message||"Failed to sign in")}}async function f(){try{let{error:a}=await b.supabase.auth.signOut();if(a)throw a}catch(a){throw console.error("Sign out error:",a),Error(a.message||"Failed to sign out")}}async function g(){try{let{data:{user:a}}=await b.supabase.auth.getUser();if(!a)return null;let{data:c,error:d}=await b.supabase.from("users").select("*").eq("id",a.id).maybeSingle();if(d)return console.error("Error fetching user data:",d),null;if(!c)return console.warn("User authenticated but no profile found"),null;return{id:c.id,email:c.email,mobile:c.mobile,name:c.name,company_name:c.company_name,role:c.role,created_at:new Date(c.created_at),updated_at:new Date(c.updated_at),rm_id:c.rm_id,customer_id:c.customer_id}}catch(a){return console.error("Error getting current user:",a),null}}function h(a){return b.supabase.auth.onAuthStateChange(async(b,c)=>{c?.user?a(await g()):a(null)})}a.s(["getCurrentUser",()=>g,"onAuthStateChange",()=>h,"resetPassword",()=>d,"signIn",()=>e,"signOut",()=>f,"signUp",()=>c])},81258,a=>{"use strict";let b=(0,a.i(42077).default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);a.s(["Shield",()=>b],81258)},59322,a=>{"use strict";let b=(0,a.i(42077).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);a.s(["Mail",()=>b],59322)},48678,a=>{"use strict";let b=(0,a.i(42077).default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);a.s(["Lock",()=>b],48678)},92975,a=>{"use strict";var b=a.i(72440),c=a.i(29916),d=a.i(96968),e=a.i(29920),f=a.i(81258),g=a.i(59322),h=a.i(48678),i=a.i(8490);function j(){let a=(0,d.useRouter)(),j=(0,d.useSearchParams)().get("type")||"individual",[k,l]=(0,c.useState)({email:"",password:""}),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),q=async b=>{b.preventDefault(),n(""),p(!0);try{let b=await (0,i.signIn)(k.email,k.password);console.log("ðŸ” Login Debug - User role:",b.role),console.log("ðŸ” Login Debug - Full user:",b),"admin"===b.role?(console.log("ðŸ” Redirecting to /admin/dashboard"),a.push("/admin/dashboard")):(console.log("ðŸ” Redirecting to /dashboard"),a.push("/dashboard"))}catch(a){n(a.message||"Failed to sign in. Please check your credentials.")}finally{p(!1)}};return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-secondary-50 flex items-center justify-center py-12 px-4",children:(0,b.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)(e.default,{href:"/",className:"inline-flex items-center space-x-2 mb-6",children:[(0,b.jsx)(f.Shield,{className:"w-10 h-10 text-primary-600"}),(0,b.jsx)("span",{className:"text-2xl font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent",children:"One Single View"})]}),(0,b.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"corporate"===j?"Corporate Login":"Individual Login"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Access your insurance dashboard"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.default,{href:"/login?type=individual",className:`flex-1 py-2 px-4 text-center rounded-lg font-medium transition-all ${"individual"===j?"bg-primary-600 text-white shadow-sm":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:"Individual"}),(0,b.jsx)(e.default,{href:"/login?type=corporate",className:`flex-1 py-2 px-4 text-center rounded-lg font-medium transition-all ${"corporate"===j?"bg-secondary-600 text-white shadow-sm":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:"Corporate"})]}),(0,b.jsxs)("div",{className:"card",children:[(0,b.jsxs)("form",{onSubmit:q,className:"space-y-6",children:[m&&(0,b.jsx)("div",{className:"alert-error",children:m}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"label",children:[(0,b.jsx)(g.Mail,{className:"w-4 h-4 inline mr-2"}),"Email address"]}),(0,b.jsx)("input",{type:"email",required:!0,className:"input",placeholder:"you@example.com",value:k.email,onChange:a=>l({...k,email:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"label",children:[(0,b.jsx)(h.Lock,{className:"w-4 h-4 inline mr-2"}),"Password"]}),(0,b.jsx)("input",{type:"password",required:!0,className:"input",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",value:k.password,onChange:a=>l({...k,password:a.target.value})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-primary-600 mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Remember me"})]}),(0,b.jsx)(e.default,{href:"/forgot-password",className:"text-sm text-primary-600 hover:text-primary-700",children:"Forgot password?"})]}),(0,b.jsx)("button",{type:"submit",disabled:o,className:"btn-primary w-full",children:o?"Signing in...":"Sign In"})]}),(0,b.jsx)("div",{className:"mt-6 text-center",children:(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",(0,b.jsx)(e.default,{href:`/signup?type=${j}`,className:"text-primary-600 font-medium hover:text-primary-700",children:"Sign up"})]})})]})]})})}function k(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:(0,b.jsx)(j,{})})}a.s(["default",()=>k])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__116c34b8._.js.map